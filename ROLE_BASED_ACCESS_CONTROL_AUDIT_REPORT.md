# –û—Ç—á–µ—Ç –∞—É–¥–∏—Ç–∞ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–∞
*–î–∞—Ç–∞: 10 –∞–≤–≥—É—Å—Ç–∞ 2025*

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ
–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 4 –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **super_admin** - –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å –ø–æ–ª–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º
2. **advertiser** - –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–≤–æ–∏–º –æ—Ñ—Ñ–µ—Ä–∞–º –∏ –¥–∞–Ω–Ω—ã–º
3. **affiliate** - –ü–∞—Ä—Ç–Ω–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –æ—Ñ—Ñ–µ—Ä–∞–º –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ  
4. **staff** - –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

### –ò–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–ª–µ–π
- **super_admin**: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Å–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π
- **advertiser**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ—Ñ—Ñ–µ—Ä–∞–º–∏, –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏, –∫–æ–º–∞–Ω–¥–æ–π
- **affiliate**: –î–æ—Å—Ç—É–ø –∫ –æ—Ñ—Ñ–µ—Ä–∞–º, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫, –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **staff**: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ä–æ–ª—å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ middleware

### ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (authMiddleware)
**–§–∞–π–ª:** `server/middleware/auth.ts`

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–≤—è–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∑–∞–ø—Ä–æ—Å—É (`req.user`)

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ (401)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º (requireRole)
**–§—É–Ω–∫—Ü–∏—è:** `requireRole(roles: string[])`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏
- –í–æ–∑–≤—Ä–∞—Ç 403 –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –ø—Ä–∞–≤–∞—Ö

## –ê–Ω–∞–ª–∏–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### üîí –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (super_admin)
```
/api/admin/users - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
/api/admin/offers - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –æ—Ñ—Ñ–µ—Ä–∞–º–∏  
/api/admin/roles - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
/api/admin/analytics - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
/api/admin/fraud-rules - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω—Ç–∏—Ñ—Ä–æ–¥–∞
/api/admin/finances - –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
/api/admin/audit-logs - –õ–æ–≥–∏ –∞—É–¥–∏—Ç–∞
/api/admin/system-settings - –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

### üè¢ –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (advertiser)
```
/api/advertiser/offers - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ—Ñ—Ñ–µ—Ä–∞–º–∏
/api/advertiser/team - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π
/api/advertiser/profile - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
/api/advertiser/statistics - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è
/api/advertiser/access-requests - –ó–∞—è–≤–∫–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
/api/advertiser/domains - –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–æ–º–µ–Ω—ã
/api/advertiser/postbacks - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å—Ç–±–µ–∫–æ–≤
```

### üë• –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (affiliate)
```
/api/partner/offers - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤
/api/partner/statistics - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
/api/partner/access-requests - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
/api/access-requests - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –Ω–∞ –¥–æ—Å—Ç—É–ø
/api/analytics/partner/live-statistics - –ñ–∏–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### ‚úÖ –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å (advertiser)
- –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –æ—Ñ—Ñ–µ—Ä—ã (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `advertiserId`)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–æ–π (`ownerId`)
- –î–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—é

### ‚úÖ –ü–∞—Ä—Ç–Ω–µ—Ä (affiliate) 
- –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –æ—Ñ—Ñ–µ—Ä—ã
- –î–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —Ç–æ–ª—å–∫–æ –ø–æ —Å–≤–æ–∏–º –∫–ª–∏–∫–∞–º
- –ù–µ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è –ø–æ `partnerId` –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

### ‚úÖ –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω (super_admin)
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º
- –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞—É–¥–∏—Ç–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
   - –í `routes.ts` –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `authenticateToken`
   - –í `middleware/auth.ts` –µ—Å—Ç—å `authMiddleware`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π middleware

2. **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π**
   - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–æ—É—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç inline –ø—Ä–æ–≤–µ—Ä–∫–∏ (`if (user.role !== 'advertiser')`)
   - –î—Ä—É–≥–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `requireRole` middleware
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `requireRole`

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ middleware –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–æ—É—Ç–∞—Ö**
   - –ö–æ–º–∞–Ω–¥–∞ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è (`/api/advertiser/team/*`) –Ω–µ –∏–º–µ–µ—Ç middleware
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –Ω–∞ –≤—Å–µ —Ä–æ—É—Ç—ã

### ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
   - –ü–∞—Ä—Ç–Ω–µ—Ä—ã –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
   - –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
   - –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø

2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   - 401 –¥–ª—è –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
   - 403 –¥–ª—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –ø—Ä–∞–≤
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–æ–≤**
   - JWT —Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–æ–≤
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
1. ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401
2. ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º ‚Üí 403  
3. ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º ‚Üí 403
4. ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ‚Üí 403

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `test_affiliate`
- –†–æ–ª—å: `affiliate` 
- –°—Ç–∞—Ç—É—Å: ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ
- JWT —Ç–æ–∫–µ–Ω: ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚úÖ –£–î–û–í–õ–ï–¢–í–û–†–ò–¢–ï–õ–¨–ù–û

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ä–æ–ª—è–º–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

**–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö middleware –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–æ—É—Ç—ã
- –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É:**
1. **–í—ã—Å–æ–∫–∏–π:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ authMiddleware
2. **–°—Ä–µ–¥–Ω–∏–π:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å requireRole –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ä–æ—É—Ç–∞—Ö  
3. **–ù–∏–∑–∫–∏–π:** –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∞—Ñ—Ñ–∏–ª–∏–∞—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.