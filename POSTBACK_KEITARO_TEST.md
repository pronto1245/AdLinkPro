# Тестирование постбека Keitaro

## Входящий постбек URL
```
http://92.42.99.112/d443e20/postback?subid={client_id}&status={status}&payout={payout}
```

## Поддерживаемые макросы системой
- `{client_id}` - Берется из sub_id_1 клика (SubID партнера)
- `{status}` - Статус события (click, lead, deposit, conversion, etc.)
- `{payout}` - Сумма выплаты партнеру
- `{revenue}` - Доход рекламодателя
- `{clickid}` - Уникальный ID клика
- `{partner_id}` - ID партнера
- `{offer_id}` - ID оффера
- `{country}` - Страна клика
- `{device}` - Тип устройства
- `{ip}` - IP адрес
- `{timestamp}` - Время события

## Пример работы
1. Партнер переходит по ссылке с sub_id_1=keitaro_test_001
2. Происходит конверсия на $25.50
3. Система автоматически отправляет постбек:
   ```
   http://92.42.99.112/d443e20/postback?subid=keitaro_test_001&status=conversion&payout=25.50
   ```

## Настройка в интерфейсе
1. Партнер заходит в раздел "Постбеки" 
2. Добавляет новый постбек с URL: `http://92.42.99.112/d443e20/postback?subid={client_id}&status={status}&payout={payout}`
3. Выбирает события: lead, deposit, conversion
4. Активирует постбек

## Логирование
Все отправленные постбеки логируются в системе с информацией:
- URL отправки
- Статус ответа (200, 404, 500, etc.)
- Время отправки
- Данные макросов
- Количество попыток при ошибках

## Retry логика
При ошибках система автоматически повторяет отправку:
- 1-я попытка: сразу
- 2-я попытка: через 1 минуту  
- 3-я попытка: через 5 минут
- 4-я попытка: через 15 минут
- 5-я попытка: через 30 минут

После 5 неудачных попыток постбек помечается как "failed".