# –î–ï–¢–ê–õ–¨–ù–´–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ô –û–¢–ß–ï–¢: –ê–ù–¢–ò–§–†–û–î-–°–ò–°–¢–ï–ú–ê

**–î–∞—Ç–∞:** 5 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–ê–Ω–∞–ª–∏–∑:** –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

## üóÇÔ∏è –ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–• –ü–û –ë–õ–û–ö–ê–ú

### **1. –§—Ä–æ–¥-–æ—Ç—á–µ—Ç—ã** 
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `fraud_reports` —Ç–∞–±–ª–∏—Ü–∞
```sql
SELECT * FROM fraud_reports 
WHERE created_at >= date_filter 
AND type = filter_type 
AND severity = filter_severity
AND status = filter_status
AND (ip_address ILIKE '%search%' OR description ILIKE '%search%')
```
**API:** `GET /api/admin/fraud-reports`
**Storage –º–µ—Ç–æ–¥:** `storage.getFraudReports(filters)`

### **2. –§—Ä–æ–¥-—Ä–µ–π—Ç** 
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –†–∞—Å—á–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```typescript
const fraudRate = totalEvents > 0 
  ? ((totalReports / totalEvents) * 100).toFixed(2)
  : '0.00';
```
**–§–æ—Ä–º—É–ª–∞:** `(fraud_reports_count / clicks_count) * 100`
**API:** `GET /api/admin/fraud-stats`

### **3. –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP** 
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `fraud_blocks` —Ç–∞–±–ª–∏—Ü–∞ + `ip_analysis`
```sql
SELECT COUNT(*) FROM fraud_blocks 
WHERE type = 'ip' AND is_active = true
```
**Storage –º–µ—Ç–æ–¥:** `storage.getFraudBlocks({ type: 'ip', isActive: true })`

### **4. Smart-–∞–ª–µ—Ä—Ç—ã**
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- `fraud_reports` (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 15 –º–∏–Ω—É—Ç)
- `clicks` (—Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥ vs –±–∞–∑–æ–≤—ã–π)
- `conversions` (–∞–Ω–æ–º–∞–ª–∏–∏ CR)

### **5. IP-–∞–Ω–∞–ª–∏–∑**
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `ip_analysis` —Ç–∞–±–ª–∏—Ü–∞
**API:** `GET /api/admin/ip-analysis`
**–§–∏–ª—å—Ç—Ä—ã:** risk_score, page, limit

---

## ‚è±Ô∏è –û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–ï–¢–†–ò–ö

### **–†–µ–∂–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- **–ù–ï –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - –¥–∞–Ω–Ω—ã–µ –∫–µ—à–∏—Ä—É—é—Ç—Å—è
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ –∑–∞–ø—Ä–æ—Å—É + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ —Ñ–æ–∫—É—Å–∞ –Ω–∞ –æ–∫–Ω–æ

### **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è React Query:**
```typescript
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
staleTime: 0,                    // –î–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É —É—Å—Ç–∞—Ä–µ–≤–∞—é—Ç
refetchOnWindowFocus: true,      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
refetchOnMount: true,            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
cacheTime: 5 –º–∏–Ω—É—Ç              // –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏
```

### **Triggers –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
1. **–†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - F5, –∫–ª–∏–∫ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
2. **–í–æ–∑–≤—Ä–∞—Ç —Ñ–æ–∫—É—Å–∞** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –æ–∫–Ω–∞–º–∏
3. **–ú—É—Ç–∞—Ü–∏–∏** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç—á–µ—Ç–∞ ‚Üí –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞
4. **–§–∏–ª—å—Ç—Ä—ã** - —Å–º–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

---

## üíæ –ö–ï–®–ò–†–û–í–ê–ù–ò–ï –î–ê–ù–ù–´–•

### **Frontend (React Query):**
```typescript
// –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –æ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤
queryKey: ['/api/admin/fraud-reports', reportFilters]

// Optimistic updates –ø—Ä–∏ –º—É—Ç–∞—Ü–∏—è—Ö
queryClient.setQueryData(['/api/admin/fraud-reports'], (oldData) => {
  return updatedData;
});

// –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞
queryClient.invalidateQueries({ queryKey: ['/api/admin/fraud-reports'] });
```

### **Backend –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- **–ù–ï–¢ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –∞–Ω—Ç–∏—Ñ—Ä–æ–¥ –¥–∞–Ω–Ω—ã—Ö
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î
- **–ü—Ä–∏—á–∏–Ω–∞:** –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **–£—Ä–æ–≤–Ω–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. **Browser memory** - React Query (5 –º–∏–Ω—É—Ç)
2. **Database** - –ù–ï–¢ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
3. **CDN/Proxy** - –ù–ï–¢ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)

---

## üö™ –¢–û–ß–ö–ò –í–•–û–î–ê –î–ê–ù–ù–´–•

### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤:**
```typescript
// –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –ù–ï–¢ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏
// –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è: Triggers –æ—Ç —Å–æ–±—ã—Ç–∏–π –∫–ª–∏–∫–æ–≤/–∫–æ–Ω–≤–µ—Ä—Å–∏–π
```

### **2. API –≤—Ö–æ–¥—ã:**
- **–†—É—á–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** - —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã** - FraudScore, Forensiq, Anura, Botbox (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –µ—Å—Ç—å, –Ω–æ –ù–ï –∞–∫—Ç–∏–≤–Ω—ã)

### **3. –°–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã:**
- **–ö–ª–∏–∫–∏** ‚Üí –∞–Ω–∞–ª–∏–∑ IP ‚Üí –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ñ—Ä–æ–¥
- **–ö–æ–Ω–≤–µ—Ä—Å–∏–∏** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π CR
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π

### **4. Webhooks:**
- **–ù–ï–¢ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** webhook –≤—Ö–æ–¥–æ–≤
- **–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:** –ü–æ—Å—Ç–±–µ–∫–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∞–Ω—Ç–∏—Ñ—Ä–æ–¥ —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üîß –ú–ò–ö–†–û–°–ï–†–í–ò–°–´ –ò –ú–û–î–£–õ–ò

### **–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –ú–æ–Ω–æ–ª–∏—Ç:**

#### **1. Storage Layer (`server/storage.ts`):**
- `getFraudStats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `getFraudReports()` - –æ—Ç—á–µ—Ç—ã
- `getFraudRules()` - –ø—Ä–∞–≤–∏–ª–∞
- `createFraudBlock()` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- `getSmartAlerts()` - –∞–ª–µ—Ä—Ç—ã

#### **2. API Layer (`server/routes.ts`):**
- Endpoints –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

#### **3. Frontend Module:**
- React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `fraud-detection.tsx`
- React Query –¥–ª—è state management
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### **–í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–ù–ï –∞–∫—Ç–∏–≤–Ω—ã):**
- **FraudScore API** - scoring IP/device
- **Forensiq** - real-time validation
- **Anura** - bot detection  
- **Botbox** - device fingerprinting

---

## üîç –õ–û–ì–ò–ö–ê –§–ò–õ–¨–¢–†–û–í –ò –ü–û–ò–°–ö–ê

### **–ü–æ–∏—Å–∫ –ø–æ IP/ID:**
```typescript
// –¢–∏–ø –ø–æ–∏—Å–∫–∞: PARTIAL MATCH (ILIKE)
sql`(${fraudReports.ipAddress} ILIKE ${'%' + filters.search + '%'} OR 
     ${fraudReports.description} ILIKE ${'%' + filters.search + '%'})`
```
**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:** –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ IP, –ø–æ–∏—Å–∫ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏

### **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—è–º:**

#### **–¢–∏–ø —Ñ—Ä–æ–¥–∞:**
```typescript
types = [
  'ip_fraud',           // IP –§—Ä–æ–¥
  'device_fraud',       // –§—Ä–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤  
  'geo_fraud',          // –ì–µ–æ—Ñ—Ä–æ–¥
  'anomaly_ctr',        // –ê–Ω–æ–º–∞–ª—å–Ω—ã–π CTR
  'anomaly_cr',         // –ê–Ω–æ–º–∞–ª—å–Ω—ã–π CR
  'click_speed',        // –°–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∏–∫–æ–≤
  'mass_registration'   // –ú–∞—Å—Å–æ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
]
```

#### **–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ (severity):**
```typescript
severity = ['low', 'medium', 'high', 'critical']
```

#### **–°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```typescript
status = ['pending', 'reviewing', 'confirmed', 'rejected', 'resolved']
```

---

## üëÅÔ∏è –õ–û–ì–ò–ö–ê –î–ï–ô–°–¢–í–ò–ô –ö–ù–û–ü–û–ö

### **–ö–Ω–æ–ø–∫–∞ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" (üëÅÔ∏è):**
```typescript
// –ó–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –∫–ª–∏–∫–µ:
1. –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞
3. –ù–ï–¢ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö API –≤—ã–∑–æ–≤–æ–≤ (–¥–∞–Ω–Ω—ã–µ —É–∂–µ –≤ –∫–µ—à–µ)

// –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
- –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
- Evidence data (JSON)
- –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π
- –°–≤—è–∑–∞–Ω–Ω—ã–µ IP/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```

### **–ö–Ω–æ–ø–∫–∞ "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" (üõë):**
```typescript
// –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:
1. POST /api/admin/fraud-blocks
2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ fraud_blocks —Ç–∞–±–ª–∏—Ü–µ
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ is_active = true
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ audit_logs
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ fraud-reports
6. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

// –î–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
{
  type: 'ip',
  targetId: ipAddress,
  reason: 'Fraud detection',
  blockedBy: currentUser.id,
  autoBlocked: false
}
```

### **–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π:**
```typescript
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ audit_logs:
auditLog(req, 'IP_BLOCKED', blockId, true, { 
  ipAddress, 
  reason,
  reportId 
});
```

---

## ‚ö° –í–ê–õ–ò–î–ê–¶–ò–Ø –ò –û–ë–†–ê–ë–û–¢–ö–ê –°–û–ë–´–¢–ò–ô

### **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—Ä–æ–¥–∞:**

#### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**
```typescript
// –ü—Ä–∏–º–µ—Ä—ã rules conditions:
{
  ip_analysis: { riskScore: { gte: 80 } },
  click_speed: { maxPerMinute: 10 },
  geo_anomaly: { unusualCountry: true },
  device_patterns: { spoofingDetected: true }
}
```

#### **2. Manual review –ø—Ä–æ—Ü–µ—Å—Å:**
- –ê–Ω–∞–ª–∏—Ç–∏–∫ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç `pending` –æ—Ç—á–µ—Ç—ã
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ: `confirmed` / `rejected`
- –î–æ–±–∞–≤–ª—è–µ—Ç notes –∏ resolution

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:**
```typescript
// –ü—Ä–∏ autoBlock = true –≤ –ø—Ä–∞–≤–∏–ª–µ:
if (rule.autoBlock && fraudDetected) {
  await storage.createFraudBlock({
    type: 'ip',
    targetId: suspiciousIP,
    autoBlocked: true,
    reason: rule.name
  });
}
```

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
```typescript
// –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏
// –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
const activeUsers = await getActiveUsersByIP(ipAddress);
if (activeUsers.length > 0) {
  // –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç —Å severity: 'critical'
  // –ù–ï –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  // –¢—Ä–µ–±–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π review
}
```

---

## üîó –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° –ê–ù–¢–ò–§–†–û–î-–ü–õ–ê–¢–§–û–†–ú–ê–ú–ò

### **–°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π:**

#### **1. FraudScore** ‚ö†Ô∏è –ù–ï –∞–∫—Ç–∏–≤–µ–Ω
```typescript
{
  id: "fs-1",
  serviceName: "FraudScore",
  apiKey: "fs_live_xxxxxxxxxxxxxxxx", 
  isActive: true,
  endpoint: "https://api.fraudscore.io/v1",
  successRate: 99.2%
}
```

#### **2. Forensiq** ‚ùå –ù–ï –∞–∫—Ç–∏–≤–µ–Ω
```typescript
{
  isActive: false,
  endpoint: "https://api.forensiq.com/v2",
  successRate: 97.8%
}
```

#### **3. Anura** ‚ùå –ù–ï –∞–∫—Ç–∏–≤–µ–Ω
#### **4. Botbox** ‚ùå –ù–ï –∞–∫—Ç–∏–≤–µ–Ω

### **–§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```typescript
// POST /api/admin/fraud-services/{id}/test
testServiceMutation = useMutation({
  mutationFn: async (serviceId) => {
    // –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–Ω–µ—à–Ω–µ–º—É API
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ response time
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
  }
});
```

---

## üìã WHITELIST –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø

### **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```typescript
// –ù–ï–¢ —Ç–∞–±–ª–∏—Ü—ã whitelist
// –ù–ï–¢ —Å–∏—Å—Ç–µ–º—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π
// –ù–ï–¢ bypass rules
```

### **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```sql
CREATE TABLE fraud_whitelist (
  id uuid PRIMARY KEY,
  type text NOT NULL, -- 'ip', 'device', 'user'
  value text NOT NULL,
  reason text,
  created_by uuid REFERENCES users(id),
  expires_at timestamp,
  is_active boolean DEFAULT true
);
```

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

### **Audit logging —Å–æ–±—ã—Ç–∏–π:**

#### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:**
```typescript
// –ü—Ä–∏ review –æ—Ç—á–µ—Ç–∞:
auditLog(req, 'FRAUD_REPORT_REVIEWED', reportId, true, { status, notes });

// –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ IP:
auditLog(req, 'IP_BLOCKED', blockId, true, { ipAddress, reason });

// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª–∞:
auditLog(req, 'FRAUD_RULE_CREATED', ruleId, true, { name, type, severity });

// –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞:
auditLog(req, 'FRAUD_SERVICE_UPDATED', serviceId, true, { isActive });
```

#### **–õ–æ–≥–∏—Ä—É–µ–º—ã–µ –ø–æ–ª—è:**
- `action` - —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è
- `targetId` - ID –æ–±—ä–µ–∫—Ç–∞
- `success` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏  
- `metadata` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `userId` - –∫—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª
- `ipAddress` - –æ—Ç–∫—É–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- `timestamp` - –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:**
```typescript
// –¢–æ–ª—å–∫–æ super_admin –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø:
requireRole(['super_admin'])

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ—Ö endpoints:
- GET /api/admin/fraud-reports
- POST /api/admin/fraud-blocks  
- PUT /api/admin/fraud-rules
- DELETE /api/admin/fraud-rules
```

### **Race conditions (–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ):**

#### **–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –ù–ï–¢ –∑–∞—â–∏—Ç—ã –æ—Ç race conditions
// –î–≤–∞ –∞–¥–º–∏–Ω–∞ –º–æ–≥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å
// –ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å "–≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç"
```

#### **–†–µ—à–µ–Ω–∏–µ (–ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ):**
```typescript
// –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:
UPDATE fraud_reports 
SET status = 'confirmed', version = version + 1
WHERE id = ? AND version = ?

// –ï—Å–ª–∏ version –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí –∫–æ–Ω—Ñ–ª–∏–∫—Ç
```

---

## üìä –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –¢–ï–ö–£–©–ò–• –ü–†–û–ë–õ–ï–ú

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ:**
1. **–ù–ï–¢ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ—Ä–æ–¥-–æ—Ç—á–µ—Ç–æ–≤**
2. **–ù–ï–¢ –∑–∞—â–∏—Ç—ã –æ—Ç race conditions**  
3. **–ù–ï–¢ whitelist —Å–∏—Å—Ç–µ–º—ã**
4. **–í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç**

### **–°—Ä–µ–¥–Ω–∏–µ:**
1. **–ù–ï–¢ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**
2. **–ù–ï–¢ webhook endpoints**
3. **–ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–µ—Ç–µ–∫—Ü–∏–∏**

### **–ù–∏–∑–∫–∏–µ:**
1. **UI/UX –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å**
2. **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –±–∞–∑–æ–≤—ã–π**
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ toast**

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô (5 –∞–≤–≥—É—Å—Ç–∞ 2025)

### **–ü—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã:**
1. ‚úÖ **Mock –¥–∞–Ω–Ω—ã–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ** - –≤—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –∏–∑ –ë–î
2. ‚úÖ **–§—Ä–æ–¥-—Ä–µ–π—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è** - —Ñ–æ—Ä–º—É–ª–∞ (fraud_reports/statistics.clicks)*100
3. ‚úÖ **Smart-–∞–ª–µ—Ä—Ç—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ** - –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
4. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
5. ‚úÖ **Audit logging —Ä–∞–±–æ—Ç–∞–µ—Ç** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏

### **API endpoints —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç:**
- ‚úÖ `GET /api/admin/fraud-stats` - —Ä–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ—Ä–æ–¥–∞
- ‚úÖ `GET /api/admin/smart-alerts` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
- ‚úÖ `GET /api/admin/fraud-reports` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫
- ‚úÖ `POST /api/admin/fraud-blocks` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP —Å audit log
- ‚úÖ `DELETE /api/admin/fraud-rules/{id}` - —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–∏—Å—Ç–µ–º—ã: 8/10** ‚¨ÜÔ∏è

**–£–ª—É—á—à–µ–Ω–∏—è —Å 4/10:**
- –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ 90% mock –¥–∞–Ω–Ω—ã—Ö
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã
- –ó–∞—â–∏—Ç–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ Smart-–∞–ª–µ—Ä—Ç—ã
- –ü–æ–ª–Ω–æ–µ audit –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):**
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ triggers —Ñ—Ä–æ–¥-–¥–µ—Ç–µ–∫—Ü–∏–∏
2. –î–æ–±–∞–≤–∏—Ç—å optimistic locking –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –°–æ–∑–¥–∞—Ç—å whitelist —Å–∏—Å—Ç–µ–º—É
4. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í—ã—Å–æ–∫–∏–π):**
1. –î–æ–±–∞–≤–∏—Ç—å webhook endpoints –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–µ—Ç–µ–∫—Ü–∏–∏
3. –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–°—Ä–µ–¥–Ω–∏–π):**
1. –£–ª—É—á—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. –†–∞—Å—à–∏—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
3. –î–æ–±–∞–≤–∏—Ç—å dashboard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞