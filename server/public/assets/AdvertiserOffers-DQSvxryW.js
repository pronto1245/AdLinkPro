var yu=Object.defineProperty;var Za=s=>{throw TypeError(s)};var vu=(s,e,t)=>e in s?yu(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var w=(s,e,t)=>vu(s,typeof e!="symbol"?e+"":e,t),Ji=(s,e,t)=>e.has(s)||Za("Cannot "+t);var m=(s,e,t)=>(Ji(s,e,"read from private field"),t?t.call(s):e.get(s)),T=(s,e,t)=>e.has(s)?Za("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),j=(s,e,t,n)=>(Ji(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),R=(s,e,t)=>(Ji(s,e,"access private method"),t);import{s as Rl,j as l,t as Dl,v as jl,b as Ol,W as bu,c as wu,w as Ul,d as xu,x as Cu,T as _u,y as Su,z as Ml,O as Il,B as Eu,k as hs,P as At,E as dn}from"./ui-CkQMVfNu.js";import{r as g,b as be,a as Ys,g as $n}from"./vendor-DazevGLP.js";import{u as Fu}from"./useQuery-IUx4ZSsA.js";import{c as Bn,a as xe,b as Ll,B as se,d as $l,S as Qi,G as eo,T as Jn,C as es,e as ts,f as ss,g as ns,L as V,I as Ne,h as Qn,i as Zn,j as ei,k as ti,l as Pe,m as to,X as gi,E as _r,n as so,o as Pu,p as Nu,q as Sr,r as ku,s as Tu}from"./index-Hu68kGEe.js";import{u as si}from"./useMutation-HxEtoRum.js";import{T as Au,a as Ru,b as Bl,c as ct,d as Du,e as dt}from"./table-D9zFYVHJ.js";import{B as sn}from"./badge-BPEJ7H1K.js";import{a as is}from"./queryClient-Cc5pa0C1.js";import{p as ju,g as Ou}from"./countries-dBp4lN7_.js";import{D as zl,a as Hl,b as ql,c as Vl,d as Uu}from"./dialog-CMra4o9L.js";import{T as Vs}from"./textarea-DGF4QzFC.js";import{S as Mu}from"./search-w8xkMBVR.js";import{P as no,a as io,b as ro}from"./popover-DsAhS6-B.js";import{T as Iu,a as Lu,b as rs,c as as}from"./tabs-BOkB6Db_.js";import{S as Qe}from"./switch-BurhKlWt.js";import{S as Ct}from"./separator-Bl89TN97.js";import{t as $u,d as Bu}from"./throttle-u1a0mjpu.js";import{D as ao}from"./dollar-sign-DxJ6twRP.js";import{P as Er}from"./plus-CDknCoO7.js";import{U as zu}from"./upload-DfoVTwZM.js";import{T as nn}from"./trash-2-BgkAOTI8.js";import{C as Hu}from"./clock-HOqnpwZm.js";import{P as qu}from"./play-7Q2Ehrbv.js";import{S as Vu}from"./square-pen-DvrE7Sss.js";import"./utils-B-_CankM.js";import"./smartphone-DkdSkLaU.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Bn("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=Bn("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=Bn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=Bn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Bn("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);var Gl="AlertDialog",[Ku,eb]=wu(Gl,[Rl]),gt=Rl(),Kl=s=>{const{__scopeAlertDialog:e,...t}=s,n=gt(e);return l.jsx(Dl,{...n,...t,modal:!0})};Kl.displayName=Gl;var Xu="AlertDialogTrigger",Yu=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=gt(t);return l.jsx(Eu,{...i,...n,ref:e})});Yu.displayName=Xu;var Ju="AlertDialogPortal",Xl=s=>{const{__scopeAlertDialog:e,...t}=s,n=gt(e);return l.jsx(jl,{...n,...t})};Xl.displayName=Ju;var Qu="AlertDialogOverlay",Yl=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=gt(t);return l.jsx(Il,{...i,...n,ref:e})});Yl.displayName=Qu;var ps="AlertDialogContent",[Zu,eh]=Ku(ps),th=Cu("AlertDialogContent"),Jl=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,children:n,...i}=s,r=gt(t),a=g.useRef(null),o=Ol(e,a),c=g.useRef(null);return l.jsx(bu,{contentName:ps,titleName:Ql,docsSlug:"alert-dialog",children:l.jsx(Zu,{scope:t,cancelRef:c,children:l.jsxs(Ul,{role:"alertdialog",...r,...i,ref:o,onOpenAutoFocus:xu(i.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[l.jsx(th,{children:n}),l.jsx(nh,{contentRef:a})]})})})});Jl.displayName=ps;var Ql="AlertDialogTitle",Zl=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=gt(t);return l.jsx(_u,{...i,...n,ref:e})});Zl.displayName=Ql;var ec="AlertDialogDescription",tc=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=gt(t);return l.jsx(Su,{...i,...n,ref:e})});tc.displayName=ec;var sh="AlertDialogAction",sc=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=gt(t);return l.jsx(Ml,{...i,...n,ref:e})});sc.displayName=sh;var nc="AlertDialogCancel",ic=g.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,{cancelRef:i}=eh(nc,t),r=gt(t),a=Ol(e,i);return l.jsx(Ml,{...r,...n,ref:a})});ic.displayName=nc;var nh=({contentRef:s})=>{const e=`\`${ps}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ps}\` by passing a \`${ec}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ps}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return g.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,s]),null},ih=Kl,rh=Xl,rc=Yl,ac=Jl,oc=sc,lc=ic,cc=Zl,dc=tc;const lo=ih,ah=rh,uc=g.forwardRef(({className:s,...e},t)=>l.jsx(rc,{className:xe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e,ref:t}));uc.displayName=rc.displayName;const Fr=g.forwardRef(({className:s,...e},t)=>l.jsxs(ah,{children:[l.jsx(uc,{}),l.jsx(ac,{ref:t,className:xe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...e})]}));Fr.displayName=ac.displayName;const Pr=({className:s,...e})=>l.jsx("div",{className:xe("flex flex-col space-y-2 text-center sm:text-left",s),...e});Pr.displayName="AlertDialogHeader";const Nr=({className:s,...e})=>l.jsx("div",{className:xe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...e});Nr.displayName="AlertDialogFooter";const kr=g.forwardRef(({className:s,...e},t)=>l.jsx(cc,{ref:t,className:xe("text-lg font-semibold",s),...e}));kr.displayName=cc.displayName;const Tr=g.forwardRef(({className:s,...e},t)=>l.jsx(dc,{ref:t,className:xe("text-sm text-muted-foreground",s),...e}));Tr.displayName=dc.displayName;const Ar=g.forwardRef(({className:s,...e},t)=>l.jsx(oc,{ref:t,className:xe(Ll(),s),...e}));Ar.displayName=oc.displayName;const Rr=g.forwardRef(({className:s,...e},t)=>l.jsx(lc,{ref:t,className:xe(Ll({variant:"outline"}),"mt-2 sm:mt-0",s),...e}));Rr.displayName=lc.displayName;function oh(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return g.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const qi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ms(s){const e=Object.prototype.toString.call(s);return e==="[object Window]"||e==="[object global]"}function Ca(s){return"nodeType"in s}function Ce(s){var e,t;return s?Ms(s)?s:Ca(s)&&(e=(t=s.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function _a(s){const{Document:e}=Ce(s);return s instanceof e}function zn(s){return Ms(s)?!1:s instanceof Ce(s).HTMLElement}function hc(s){return s instanceof Ce(s).SVGElement}function Is(s){return s?Ms(s)?s.document:Ca(s)?_a(s)?s:zn(s)||hc(s)?s.ownerDocument:document:document:document}const at=qi?g.useLayoutEffect:g.useEffect;function Sa(s){const e=g.useRef(s);return at(()=>{e.current=s}),g.useCallback(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function lh(){const s=g.useRef(null),e=g.useCallback((n,i)=>{s.current=setInterval(n,i)},[]),t=g.useCallback(()=>{s.current!==null&&(clearInterval(s.current),s.current=null)},[]);return[e,t]}function un(s,e){e===void 0&&(e=[s]);const t=g.useRef(s);return at(()=>{t.current!==s&&(t.current=s)},e),t}function Hn(s,e){const t=g.useRef();return g.useMemo(()=>{const n=s(t.current);return t.current=n,n},[...e])}function _i(s){const e=Sa(s),t=g.useRef(null),n=g.useCallback(i=>{i!==t.current&&e?.(i,t.current),t.current=i},[]);return[t,n]}function Dr(s){const e=g.useRef();return g.useEffect(()=>{e.current=s},[s]),e.current}let er={};function qn(s,e){return g.useMemo(()=>{if(e)return e;const t=er[s]==null?0:er[s]+1;return er[s]=t,s+"-"+t},[s,e])}function pc(s){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((r,a)=>{const o=Object.entries(a);for(const[c,d]of o){const u=r[c];u!=null&&(r[c]=u+s*d)}return r},{...e})}}const fs=pc(1),Si=pc(-1);function ch(s){return"clientX"in s&&"clientY"in s}function Ea(s){if(!s)return!1;const{KeyboardEvent:e}=Ce(s.target);return e&&s instanceof e}function dh(s){if(!s)return!1;const{TouchEvent:e}=Ce(s.target);return e&&s instanceof e}function jr(s){if(dh(s)){if(s.touches&&s.touches.length){const{clientX:e,clientY:t}=s.touches[0];return{x:e,y:t}}else if(s.changedTouches&&s.changedTouches.length){const{clientX:e,clientY:t}=s.changedTouches[0];return{x:e,y:t}}}return ch(s)?{x:s.clientX,y:s.clientY}:null}const hn=Object.freeze({Translate:{toString(s){if(!s)return;const{x:e,y:t}=s;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(s){if(!s)return;const{scaleX:e,scaleY:t}=s;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(s){if(s)return[hn.Translate.toString(s),hn.Scale.toString(s)].join(" ")}},Transition:{toString(s){let{property:e,duration:t,easing:n}=s;return e+" "+t+"ms "+n}}}),co="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function uh(s){return s.matches(co)?s:s.querySelector(co)}const hh={display:"none"};function ph(s){let{id:e,value:t}=s;return be.createElement("div",{id:e,style:hh},t)}function fh(s){let{id:e,announcement:t,ariaLiveType:n="assertive"}=s;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return be.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},t)}function mh(){const[s,e]=g.useState("");return{announce:g.useCallback(n=>{n!=null&&e(n)},[]),announcement:s}}const fc=g.createContext(null);function gh(s){const e=g.useContext(fc);g.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(s)},[s,e])}function yh(){const[s]=g.useState(()=>new Set),e=g.useCallback(n=>(s.add(n),()=>s.delete(n)),[s]);return[g.useCallback(n=>{let{type:i,event:r}=n;s.forEach(a=>{var o;return(o=a[i])==null?void 0:o.call(a,r)})},[s]),e]}const vh={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},bh={onDragStart(s){let{active:e}=s;return"Picked up draggable item "+e.id+"."},onDragOver(s){let{active:e,over:t}=s;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(s){let{active:e,over:t}=s;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(s){let{active:e}=s;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function wh(s){let{announcements:e=bh,container:t,hiddenTextDescribedById:n,screenReaderInstructions:i=vh}=s;const{announce:r,announcement:a}=mh(),o=qn("DndLiveRegion"),[c,d]=g.useState(!1);if(g.useEffect(()=>{d(!0)},[]),gh(g.useMemo(()=>({onDragStart(h){let{active:v}=h;r(e.onDragStart({active:v}))},onDragMove(h){let{active:v,over:y}=h;e.onDragMove&&r(e.onDragMove({active:v,over:y}))},onDragOver(h){let{active:v,over:y}=h;r(e.onDragOver({active:v,over:y}))},onDragEnd(h){let{active:v,over:y}=h;r(e.onDragEnd({active:v,over:y}))},onDragCancel(h){let{active:v,over:y}=h;r(e.onDragCancel({active:v,over:y}))}}),[r,e])),!c)return null;const u=be.createElement(be.Fragment,null,be.createElement(ph,{id:n,value:i.draggable}),be.createElement(fh,{id:o,announcement:a}));return t?Ys.createPortal(u,t):u}var re;(function(s){s.DragStart="dragStart",s.DragMove="dragMove",s.DragEnd="dragEnd",s.DragCancel="dragCancel",s.DragOver="dragOver",s.RegisterDroppable="registerDroppable",s.SetDroppableDisabled="setDroppableDisabled",s.UnregisterDroppable="unregisterDroppable"})(re||(re={}));function Ei(){}const Ve=Object.freeze({x:0,y:0});function xh(s,e){let{data:{value:t}}=s,{data:{value:n}}=e;return n-t}function Ch(s,e){if(!s||s.length===0)return null;const[t]=s;return t[e]}function _h(s,e){const t=Math.max(e.top,s.top),n=Math.max(e.left,s.left),i=Math.min(e.left+e.width,s.left+s.width),r=Math.min(e.top+e.height,s.top+s.height),a=i-n,o=r-t;if(n<i&&t<r){const c=e.width*e.height,d=s.width*s.height,u=a*o,h=u/(c+d-u);return Number(h.toFixed(4))}return 0}const Sh=s=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=s;const i=[];for(const r of n){const{id:a}=r,o=t.get(a);if(o){const c=_h(o,e);c>0&&i.push({id:a,data:{droppableContainer:r,value:c}})}}return i.sort(xh)};function Eh(s,e,t){return{...s,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function mc(s,e){return s&&e?{x:s.left-e.left,y:s.top-e.top}:Ve}function Fh(s){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((a,o)=>({...a,top:a.top+s*o.y,bottom:a.bottom+s*o.y,left:a.left+s*o.x,right:a.right+s*o.x}),{...t})}}const Ph=Fh(1);function Nh(s){if(s.startsWith("matrix3d(")){const e=s.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(s.startsWith("matrix(")){const e=s.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function kh(s,e,t){const n=Nh(e);if(!n)return s;const{scaleX:i,scaleY:r,x:a,y:o}=n,c=s.left-a-(1-i)*parseFloat(t),d=s.top-o-(1-r)*parseFloat(t.slice(t.indexOf(" ")+1)),u=i?s.width/i:s.width,h=r?s.height/r:s.height;return{width:u,height:h,top:d,right:c+u,bottom:d+h,left:c}}const Th={ignoreTransform:!1};function Ls(s,e){e===void 0&&(e=Th);let t=s.getBoundingClientRect();if(e.ignoreTransform){const{transform:d,transformOrigin:u}=Ce(s).getComputedStyle(s);d&&(t=kh(t,d,u))}const{top:n,left:i,width:r,height:a,bottom:o,right:c}=t;return{top:n,left:i,width:r,height:a,bottom:o,right:c}}function uo(s){return Ls(s,{ignoreTransform:!0})}function Ah(s){const e=s.innerWidth,t=s.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function Rh(s,e){return e===void 0&&(e=Ce(s).getComputedStyle(s)),e.position==="fixed"}function Dh(s,e){e===void 0&&(e=Ce(s).getComputedStyle(s));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const r=e[i];return typeof r=="string"?t.test(r):!1})}function Fa(s,e){const t=[];function n(i){if(e!=null&&t.length>=e||!i)return t;if(_a(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!zn(i)||hc(i)||t.includes(i))return t;const r=Ce(s).getComputedStyle(i);return i!==s&&Dh(i,r)&&t.push(i),Rh(i,r)?t:n(i.parentNode)}return s?n(s):t}function gc(s){const[e]=Fa(s,1);return e??null}function tr(s){return!qi||!s?null:Ms(s)?s:Ca(s)?_a(s)||s===Is(s).scrollingElement?window:zn(s)?s:null:null}function yc(s){return Ms(s)?s.scrollX:s.scrollLeft}function vc(s){return Ms(s)?s.scrollY:s.scrollTop}function Or(s){return{x:yc(s),y:vc(s)}}var ce;(function(s){s[s.Forward=1]="Forward",s[s.Backward=-1]="Backward"})(ce||(ce={}));function bc(s){return!qi||!s?!1:s===document.scrollingElement}function wc(s){const e={x:0,y:0},t=bc(s)?{height:window.innerHeight,width:window.innerWidth}:{height:s.clientHeight,width:s.clientWidth},n={x:s.scrollWidth-t.width,y:s.scrollHeight-t.height},i=s.scrollTop<=e.y,r=s.scrollLeft<=e.x,a=s.scrollTop>=n.y,o=s.scrollLeft>=n.x;return{isTop:i,isLeft:r,isBottom:a,isRight:o,maxScroll:n,minScroll:e}}const jh={x:.2,y:.2};function Oh(s,e,t,n,i){let{top:r,left:a,right:o,bottom:c}=t;n===void 0&&(n=10),i===void 0&&(i=jh);const{isTop:d,isBottom:u,isLeft:h,isRight:v}=wc(s),y={x:0,y:0},x={x:0,y:0},_={height:e.height*i.y,width:e.width*i.x};return!d&&r<=e.top+_.height?(y.y=ce.Backward,x.y=n*Math.abs((e.top+_.height-r)/_.height)):!u&&c>=e.bottom-_.height&&(y.y=ce.Forward,x.y=n*Math.abs((e.bottom-_.height-c)/_.height)),!v&&o>=e.right-_.width?(y.x=ce.Forward,x.x=n*Math.abs((e.right-_.width-o)/_.width)):!h&&a<=e.left+_.width&&(y.x=ce.Backward,x.x=n*Math.abs((e.left+_.width-a)/_.width)),{direction:y,speed:x}}function Uh(s){if(s===document.scrollingElement){const{innerWidth:r,innerHeight:a}=window;return{top:0,left:0,right:r,bottom:a,width:r,height:a}}const{top:e,left:t,right:n,bottom:i}=s.getBoundingClientRect();return{top:e,left:t,right:n,bottom:i,width:s.clientWidth,height:s.clientHeight}}function xc(s){return s.reduce((e,t)=>fs(e,Or(t)),Ve)}function Mh(s){return s.reduce((e,t)=>e+yc(t),0)}function Ih(s){return s.reduce((e,t)=>e+vc(t),0)}function Lh(s,e){if(e===void 0&&(e=Ls),!s)return;const{top:t,left:n,bottom:i,right:r}=e(s);gc(s)&&(i<=0||r<=0||t>=window.innerHeight||n>=window.innerWidth)&&s.scrollIntoView({block:"center",inline:"center"})}const $h=[["x",["left","right"],Mh],["y",["top","bottom"],Ih]];class Pa{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Fa(t),i=xc(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[r,a,o]of $h)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=o(n),u=i[r]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class rn{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...t)})},this.target=e}add(e,t,n){var i;(i=this.target)==null||i.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function Bh(s){const{EventTarget:e}=Ce(s);return s instanceof e?s:Is(s)}function sr(s,e){const t=Math.abs(s.x),n=Math.abs(s.y);return typeof e=="number"?Math.sqrt(t**2+n**2)>e:"x"in e&&"y"in e?t>e.x&&n>e.y:"x"in e?t>e.x:"y"in e?n>e.y:!1}var Ae;(function(s){s.Click="click",s.DragStart="dragstart",s.Keydown="keydown",s.ContextMenu="contextmenu",s.Resize="resize",s.SelectionChange="selectionchange",s.VisibilityChange="visibilitychange"})(Ae||(Ae={}));function ho(s){s.preventDefault()}function zh(s){s.stopPropagation()}var K;(function(s){s.Space="Space",s.Down="ArrowDown",s.Right="ArrowRight",s.Left="ArrowLeft",s.Up="ArrowUp",s.Esc="Escape",s.Enter="Enter",s.Tab="Tab"})(K||(K={}));const Cc={start:[K.Space,K.Enter],cancel:[K.Esc],end:[K.Space,K.Enter,K.Tab]},Hh=(s,e)=>{let{currentCoordinates:t}=e;switch(s.code){case K.Right:return{...t,x:t.x+25};case K.Left:return{...t,x:t.x-25};case K.Down:return{...t,y:t.y+25};case K.Up:return{...t,y:t.y-25}}};class _c{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new rn(Is(t)),this.windowListeners=new rn(Ce(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ae.Resize,this.handleCancel),this.windowListeners.add(Ae.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ae.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&Lh(n),t(Ve)}handleKeyDown(e){if(Ea(e)){const{active:t,context:n,options:i}=this.props,{keyboardCodes:r=Cc,coordinateGetter:a=Hh,scrollBehavior:o="smooth"}=i,{code:c}=e;if(r.end.includes(c)){this.handleEnd(e);return}if(r.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:d}=n.current,u=d?{x:d.left,y:d.top}:Ve;this.referenceCoordinates||(this.referenceCoordinates=u);const h=a(e,{active:t,context:n.current,currentCoordinates:u});if(h){const v=Si(h,u),y={x:0,y:0},{scrollableAncestors:x}=n.current;for(const _ of x){const C=e.code,{isTop:N,isRight:f,isLeft:b,isBottom:S,maxScroll:A,minScroll:k}=wc(_),P=Uh(_),D={x:Math.min(C===K.Right?P.right-P.width/2:P.right,Math.max(C===K.Right?P.left:P.left+P.width/2,h.x)),y:Math.min(C===K.Down?P.bottom-P.height/2:P.bottom,Math.max(C===K.Down?P.top:P.top+P.height/2,h.y))},U=C===K.Right&&!f||C===K.Left&&!b,H=C===K.Down&&!S||C===K.Up&&!N;if(U&&D.x!==h.x){const I=_.scrollLeft+v.x,X=C===K.Right&&I<=A.x||C===K.Left&&I>=k.x;if(X&&!v.y){_.scrollTo({left:I,behavior:o});return}X?y.x=_.scrollLeft-I:y.x=C===K.Right?_.scrollLeft-A.x:_.scrollLeft-k.x,y.x&&_.scrollBy({left:-y.x,behavior:o});break}else if(H&&D.y!==h.y){const I=_.scrollTop+v.y,X=C===K.Down&&I<=A.y||C===K.Up&&I>=k.y;if(X&&!v.x){_.scrollTo({top:I,behavior:o});return}X?y.y=_.scrollTop-I:y.y=C===K.Down?_.scrollTop-A.y:_.scrollTop-k.y,y.y&&_.scrollBy({top:-y.y,behavior:o});break}}this.handleMove(e,fs(Si(h,this.referenceCoordinates),y))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}_c.activators=[{eventName:"onKeyDown",handler:(s,e,t)=>{let{keyboardCodes:n=Cc,onActivation:i}=e,{active:r}=t;const{code:a}=s.nativeEvent;if(n.start.includes(a)){const o=r.activatorNode.current;return o&&s.target!==o?!1:(s.preventDefault(),i?.({event:s.nativeEvent}),!0)}return!1}}];function po(s){return!!(s&&"distance"in s)}function fo(s){return!!(s&&"delay"in s)}class Na{constructor(e,t,n){var i;n===void 0&&(n=Bh(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:a}=r;this.props=e,this.events=t,this.document=Is(a),this.documentListeners=new rn(this.document),this.listeners=new rn(n),this.windowListeners=new rn(Ce(a)),this.initialCoordinates=(i=jr(r))!=null?i:Ve,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Ae.Resize,this.handleCancel),this.windowListeners.add(Ae.DragStart,ho),this.windowListeners.add(Ae.VisibilityChange,this.handleCancel),this.windowListeners.add(Ae.ContextMenu,ho),this.documentListeners.add(Ae.Keydown,this.handleKeydown),t){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(fo(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(po(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Ae.Click,zh,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ae.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:i,props:r}=this,{onMove:a,options:{activationConstraint:o}}=r;if(!i)return;const c=(t=jr(e))!=null?t:Ve,d=Si(i,c);if(!n&&o){if(po(o)){if(o.tolerance!=null&&sr(d,o.tolerance))return this.handleCancel();if(sr(d,o.distance))return this.handleStart()}if(fo(o)&&sr(d,o.tolerance))return this.handleCancel();this.handlePending(o,d);return}e.cancelable&&e.preventDefault(),a(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===K.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const qh={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Sc extends Na{constructor(e){const{event:t}=e,n=Is(t.target);super(e,qh,n)}}Sc.activators=[{eventName:"onPointerDown",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;return!t.isPrimary||t.button!==0?!1:(n?.({event:t}),!0)}}];const Vh={move:{name:"mousemove"},end:{name:"mouseup"}};var Ur;(function(s){s[s.RightClick=2]="RightClick"})(Ur||(Ur={}));class Wh extends Na{constructor(e){super(e,Vh,Is(e.event.target))}}Wh.activators=[{eventName:"onMouseDown",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;return t.button===Ur.RightClick?!1:(n?.({event:t}),!0)}}];const nr={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Gh extends Na{constructor(e){super(e,nr)}static setup(){return window.addEventListener(nr.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(nr.move.name,e)};function e(){}}}Gh.activators=[{eventName:"onTouchStart",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;const{touches:i}=t;return i.length>1?!1:(n?.({event:t}),!0)}}];var an;(function(s){s[s.Pointer=0]="Pointer",s[s.DraggableRect=1]="DraggableRect"})(an||(an={}));var Fi;(function(s){s[s.TreeOrder=0]="TreeOrder",s[s.ReversedTreeOrder=1]="ReversedTreeOrder"})(Fi||(Fi={}));function Kh(s){let{acceleration:e,activator:t=an.Pointer,canScroll:n,draggingRect:i,enabled:r,interval:a=5,order:o=Fi.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:h,threshold:v}=s;const y=Yh({delta:h,disabled:!r}),[x,_]=lh(),C=g.useRef({x:0,y:0}),N=g.useRef({x:0,y:0}),f=g.useMemo(()=>{switch(t){case an.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case an.DraggableRect:return i}},[t,i,c]),b=g.useRef(null),S=g.useCallback(()=>{const k=b.current;if(!k)return;const P=C.current.x*N.current.x,D=C.current.y*N.current.y;k.scrollBy(P,D)},[]),A=g.useMemo(()=>o===Fi.TreeOrder?[...d].reverse():d,[o,d]);g.useEffect(()=>{if(!r||!d.length||!f){_();return}for(const k of A){if(n?.(k)===!1)continue;const P=d.indexOf(k),D=u[P];if(!D)continue;const{direction:U,speed:H}=Oh(k,D,f,e,v);for(const I of["x","y"])y[I][U[I]]||(H[I]=0,U[I]=0);if(H.x>0||H.y>0){_(),b.current=k,x(S,a),C.current=H,N.current=U;return}}C.current={x:0,y:0},N.current={x:0,y:0},_()},[e,S,n,_,r,a,JSON.stringify(f),JSON.stringify(y),x,d,A,u,JSON.stringify(v)])}const Xh={x:{[ce.Backward]:!1,[ce.Forward]:!1},y:{[ce.Backward]:!1,[ce.Forward]:!1}};function Yh(s){let{delta:e,disabled:t}=s;const n=Dr(e);return Hn(i=>{if(t||!n||!i)return Xh;const r={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[ce.Backward]:i.x[ce.Backward]||r.x===-1,[ce.Forward]:i.x[ce.Forward]||r.x===1},y:{[ce.Backward]:i.y[ce.Backward]||r.y===-1,[ce.Forward]:i.y[ce.Forward]||r.y===1}}},[t,e,n])}function Jh(s,e){const t=e!=null?s.get(e):void 0,n=t?t.node.current:null;return Hn(i=>{var r;return e==null?null:(r=n??i)!=null?r:null},[n,e])}function Qh(s,e){return g.useMemo(()=>s.reduce((t,n)=>{const{sensor:i}=n,r=i.activators.map(a=>({eventName:a.eventName,handler:e(a.handler,n)}));return[...t,...r]},[]),[s,e])}var pn;(function(s){s[s.Always=0]="Always",s[s.BeforeDragging=1]="BeforeDragging",s[s.WhileDragging=2]="WhileDragging"})(pn||(pn={}));var Mr;(function(s){s.Optimized="optimized"})(Mr||(Mr={}));const mo=new Map;function Zh(s,e){let{dragging:t,dependencies:n,config:i}=e;const[r,a]=g.useState(null),{frequency:o,measure:c,strategy:d}=i,u=g.useRef(s),h=C(),v=un(h),y=g.useCallback(function(N){N===void 0&&(N=[]),!v.current&&a(f=>f===null?N:f.concat(N.filter(b=>!f.includes(b))))},[v]),x=g.useRef(null),_=Hn(N=>{if(h&&!t)return mo;if(!N||N===mo||u.current!==s||r!=null){const f=new Map;for(let b of s){if(!b)continue;if(r&&r.length>0&&!r.includes(b.id)&&b.rect.current){f.set(b.id,b.rect.current);continue}const S=b.node.current,A=S?new Pa(c(S),S):null;b.rect.current=A,A&&f.set(b.id,A)}return f}return N},[s,r,t,h,c]);return g.useEffect(()=>{u.current=s},[s]),g.useEffect(()=>{h||y()},[t,h]),g.useEffect(()=>{r&&r.length>0&&a(null)},[JSON.stringify(r)]),g.useEffect(()=>{h||typeof o!="number"||x.current!==null||(x.current=setTimeout(()=>{y(),x.current=null},o))},[o,h,y,...n]),{droppableRects:_,measureDroppableContainers:y,measuringScheduled:r!=null};function C(){switch(d){case pn.Always:return!1;case pn.BeforeDragging:return t;default:return!t}}}function Ec(s,e){return Hn(t=>s?t||(typeof e=="function"?e(s):s):null,[e,s])}function ep(s,e){return Ec(s,e)}function tp(s){let{callback:e,disabled:t}=s;const n=Sa(e),i=g.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:r}=window;return new r(n)},[n,t]);return g.useEffect(()=>()=>i?.disconnect(),[i]),i}function Vi(s){let{callback:e,disabled:t}=s;const n=Sa(e),i=g.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:r}=window;return new r(n)},[t]);return g.useEffect(()=>()=>i?.disconnect(),[i]),i}function sp(s){return new Pa(Ls(s),s)}function go(s,e,t){e===void 0&&(e=sp);const[n,i]=g.useState(null);function r(){i(c=>{if(!s)return null;if(s.isConnected===!1){var d;return(d=c??t)!=null?d:null}const u=e(s);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=tp({callback(c){if(s)for(const d of c){const{type:u,target:h}=d;if(u==="childList"&&h instanceof HTMLElement&&h.contains(s)){r();break}}}}),o=Vi({callback:r});return at(()=>{r(),s?(o?.observe(s),a?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),a?.disconnect())},[s]),n}function np(s){const e=Ec(s);return mc(s,e)}const yo=[];function ip(s){const e=g.useRef(s),t=Hn(n=>s?n&&n!==yo&&s&&e.current&&s.parentNode===e.current.parentNode?n:Fa(s):yo,[s]);return g.useEffect(()=>{e.current=s},[s]),t}function rp(s){const[e,t]=g.useState(null),n=g.useRef(s),i=g.useCallback(r=>{const a=tr(r.target);a&&t(o=>o?(o.set(a,Or(a)),new Map(o)):null)},[]);return g.useEffect(()=>{const r=n.current;if(s!==r){a(r);const o=s.map(c=>{const d=tr(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,Or(d)]):null}).filter(c=>c!=null);t(o.length?new Map(o):null),n.current=s}return()=>{a(s),a(r)};function a(o){o.forEach(c=>{const d=tr(c);d?.removeEventListener("scroll",i)})}},[i,s]),g.useMemo(()=>s.length?e?Array.from(e.values()).reduce((r,a)=>fs(r,a),Ve):xc(s):Ve,[s,e])}function vo(s,e){e===void 0&&(e=[]);const t=g.useRef(null);return g.useEffect(()=>{t.current=null},e),g.useEffect(()=>{const n=s!==Ve;n&&!t.current&&(t.current=s),!n&&t.current&&(t.current=null)},[s]),t.current?Si(s,t.current):Ve}function ap(s){g.useEffect(()=>{if(!qi)return;const e=s.map(t=>{let{sensor:n}=t;return n.setup==null?void 0:n.setup()});return()=>{for(const t of e)t?.()}},s.map(e=>{let{sensor:t}=e;return t}))}function op(s,e){return g.useMemo(()=>s.reduce((t,n)=>{let{eventName:i,handler:r}=n;return t[i]=a=>{r(a,e)},t},{}),[s,e])}function Fc(s){return g.useMemo(()=>s?Ah(s):null,[s])}const bo=[];function lp(s,e){e===void 0&&(e=Ls);const[t]=s,n=Fc(t?Ce(t):null),[i,r]=g.useState(bo);function a(){r(()=>s.length?s.map(c=>bc(c)?n:new Pa(e(c),c)):bo)}const o=Vi({callback:a});return at(()=>{o?.disconnect(),a(),s.forEach(c=>o?.observe(c))},[s]),i}function cp(s){if(!s)return null;if(s.children.length>1)return s;const e=s.children[0];return zn(e)?e:s}function dp(s){let{measure:e}=s;const[t,n]=g.useState(null),i=g.useCallback(d=>{for(const{target:u}of d)if(zn(u)){n(h=>{const v=e(u);return h?{...h,width:v.width,height:v.height}:v});break}},[e]),r=Vi({callback:i}),a=g.useCallback(d=>{const u=cp(d);r?.disconnect(),u&&r?.observe(u),n(u?e(u):null)},[e,r]),[o,c]=_i(a);return g.useMemo(()=>({nodeRef:o,rect:t,setRef:c}),[t,o,c])}const up=[{sensor:Sc,options:{}},{sensor:_c,options:{}}],hp={current:{}},yi={draggable:{measure:uo},droppable:{measure:uo,strategy:pn.WhileDragging,frequency:Mr.Optimized},dragOverlay:{measure:Ls}};class on extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return(t=(n=this.get(e))==null?void 0:n.node.current)!=null?t:void 0}}const pp={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new on,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ei},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:yi,measureDroppableContainers:Ei,windowRect:null,measuringScheduled:!1},fp={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ei,draggableNodes:new Map,over:null,measureDroppableContainers:Ei},Wi=g.createContext(fp),Pc=g.createContext(pp);function mp(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new on}}}function gp(s,e){switch(e.type){case re.DragStart:return{...s,draggable:{...s.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case re.DragMove:return s.draggable.active==null?s:{...s,draggable:{...s.draggable,translate:{x:e.coordinates.x-s.draggable.initialCoordinates.x,y:e.coordinates.y-s.draggable.initialCoordinates.y}}};case re.DragEnd:case re.DragCancel:return{...s,draggable:{...s.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case re.RegisterDroppable:{const{element:t}=e,{id:n}=t,i=new on(s.droppable.containers);return i.set(n,t),{...s,droppable:{...s.droppable,containers:i}}}case re.SetDroppableDisabled:{const{id:t,key:n,disabled:i}=e,r=s.droppable.containers.get(t);if(!r||n!==r.key)return s;const a=new on(s.droppable.containers);return a.set(t,{...r,disabled:i}),{...s,droppable:{...s.droppable,containers:a}}}case re.UnregisterDroppable:{const{id:t,key:n}=e,i=s.droppable.containers.get(t);if(!i||n!==i.key)return s;const r=new on(s.droppable.containers);return r.delete(t),{...s,droppable:{...s.droppable,containers:r}}}default:return s}}function yp(s){let{disabled:e}=s;const{active:t,activatorEvent:n,draggableNodes:i}=g.useContext(Wi),r=Dr(n),a=Dr(t?.id);return g.useEffect(()=>{if(!e&&!n&&r&&a!=null){if(!Ea(r)||document.activeElement===r.target)return;const o=i.get(a);if(!o)return;const{activatorNode:c,node:d}=o;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const h=uh(u);if(h){h.focus();break}}})}},[n,e,i,a,r]),null}function vp(s,e){let{transform:t,...n}=e;return s!=null&&s.length?s.reduce((i,r)=>r({transform:i,...n}),t):t}function bp(s){return g.useMemo(()=>({draggable:{...yi.draggable,...s?.draggable},droppable:{...yi.droppable,...s?.droppable},dragOverlay:{...yi.dragOverlay,...s?.dragOverlay}}),[s?.draggable,s?.droppable,s?.dragOverlay])}function wp(s){let{activeNode:e,measure:t,initialRect:n,config:i=!0}=s;const r=g.useRef(!1),{x:a,y:o}=typeof i=="boolean"?{x:i,y:i}:i;at(()=>{if(!a&&!o||!e){r.current=!1;return}if(r.current||!n)return;const d=e?.node.current;if(!d||d.isConnected===!1)return;const u=t(d),h=mc(u,n);if(a||(h.x=0),o||(h.y=0),r.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const v=gc(d);v&&v.scrollBy({top:h.y,left:h.x})}},[e,a,o,n,t])}const Nc=g.createContext({...Ve,scaleX:1,scaleY:1});var St;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Initializing=1]="Initializing",s[s.Initialized=2]="Initialized"})(St||(St={}));const xp=g.memo(function(e){var t,n,i,r;let{id:a,accessibility:o,autoScroll:c=!0,children:d,sensors:u=up,collisionDetection:h=Sh,measuring:v,modifiers:y,...x}=e;const _=g.useReducer(gp,void 0,mp),[C,N]=_,[f,b]=yh(),[S,A]=g.useState(St.Uninitialized),k=S===St.Initialized,{draggable:{active:P,nodes:D,translate:U},droppable:{containers:H}}=C,I=P!=null?D.get(P):null,X=g.useRef({initial:null,translated:null}),E=g.useMemo(()=>{var fe;return P!=null?{id:P,data:(fe=I?.data)!=null?fe:hp,rect:X}:null},[P,I]),q=g.useRef(null),[W,te]=g.useState(null),[Z,he]=g.useState(null),oe=un(x,Object.values(x)),De=qn("DndDescribedBy",a),Ke=g.useMemo(()=>H.getEnabled(),[H]),F=bp(v),{droppableRects:L,measureDroppableContainers:$,measuringScheduled:O}=Zh(Ke,{dragging:k,dependencies:[U.x,U.y],config:F.droppable}),B=Jh(D,P),J=g.useMemo(()=>Z?jr(Z):null,[Z]),Q=gu(),ee=ep(B,F.draggable.measure);wp({activeNode:P!=null?D.get(P):null,config:Q.layoutShiftCompensation,initialRect:ee,measure:F.draggable.measure});const G=go(B,F.draggable.measure,ee),$s=go(B?B.parentElement:null),Xe=g.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:L,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:H,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Kt=H.getNodeFor((t=Xe.current.over)==null?void 0:t.id),ot=dp({measure:F.dragOverlay.measure}),Xt=(n=ot.nodeRef.current)!=null?n:B,Yt=k?(i=ot.rect)!=null?i:G:null,Va=!!(ot.nodeRef.current&&ot.rect),Wa=np(Va?null:G),Ki=Fc(Xt?Ce(Xt):null),yt=ip(k?Kt??B:null),Xn=lp(yt),Yn=vp(y,{transform:{x:U.x-Wa.x,y:U.y-Wa.y,scaleX:1,scaleY:1},activatorEvent:Z,active:E,activeNodeRect:G,containerNodeRect:$s,draggingNodeRect:Yt,over:Xe.current.over,overlayNodeRect:ot.rect,scrollableAncestors:yt,scrollableAncestorRects:Xn,windowRect:Ki}),Ga=J?fs(J,U):null,Ka=rp(yt),cu=vo(Ka),du=vo(Ka,[G]),Jt=fs(Yn,cu),Qt=Yt?Ph(Yt,Yn):null,Bs=E&&Qt?h({active:E,collisionRect:Qt,droppableRects:L,droppableContainers:Ke,pointerCoordinates:Ga}):null,Xa=Ch(Bs,"id"),[vt,Ya]=g.useState(null),uu=Va?Yn:fs(Yn,du),hu=Eh(uu,(r=vt?.rect)!=null?r:null,G),Xi=g.useRef(null),Ja=g.useCallback((fe,Se)=>{let{sensor:Ee,options:bt}=Se;if(q.current==null)return;const ke=D.get(q.current);if(!ke)return;const Fe=fe.nativeEvent,Ye=new Ee({active:q.current,activeNode:ke,event:Fe,options:bt,context:Xe,onAbort(pe){if(!D.get(pe))return;const{onDragAbort:Je}=oe.current,lt={id:pe};Je?.(lt),f({type:"onDragAbort",event:lt})},onPending(pe,wt,Je,lt){if(!D.get(pe))return;const{onDragPending:Hs}=oe.current,xt={id:pe,constraint:wt,initialCoordinates:Je,offset:lt};Hs?.(xt),f({type:"onDragPending",event:xt})},onStart(pe){const wt=q.current;if(wt==null)return;const Je=D.get(wt);if(!Je)return;const{onDragStart:lt}=oe.current,zs={activatorEvent:Fe,active:{id:wt,data:Je.data,rect:X}};Ys.unstable_batchedUpdates(()=>{lt?.(zs),A(St.Initializing),N({type:re.DragStart,initialCoordinates:pe,active:wt}),f({type:"onDragStart",event:zs}),te(Xi.current),he(Fe)})},onMove(pe){N({type:re.DragMove,coordinates:pe})},onEnd:Zt(re.DragEnd),onCancel:Zt(re.DragCancel)});Xi.current=Ye;function Zt(pe){return async function(){const{active:Je,collisions:lt,over:zs,scrollAdjustedTranslate:Hs}=Xe.current;let xt=null;if(Je&&Hs){const{cancelDrop:qs}=oe.current;xt={activatorEvent:Fe,active:Je,collisions:lt,delta:Hs,over:zs},pe===re.DragEnd&&typeof qs=="function"&&await Promise.resolve(qs(xt))&&(pe=re.DragCancel)}q.current=null,Ys.unstable_batchedUpdates(()=>{N({type:pe}),A(St.Uninitialized),Ya(null),te(null),he(null),Xi.current=null;const qs=pe===re.DragEnd?"onDragEnd":"onDragCancel";if(xt){const Yi=oe.current[qs];Yi?.(xt),f({type:qs,event:xt})}})}}},[D]),pu=g.useCallback((fe,Se)=>(Ee,bt)=>{const ke=Ee.nativeEvent,Fe=D.get(bt);if(q.current!==null||!Fe||ke.dndKit||ke.defaultPrevented)return;const Ye={active:Fe};fe(Ee,Se.options,Ye)===!0&&(ke.dndKit={capturedBy:Se.sensor},q.current=bt,Ja(Ee,Se))},[D,Ja]),Qa=Qh(u,pu);ap(u),at(()=>{G&&S===St.Initializing&&A(St.Initialized)},[G,S]),g.useEffect(()=>{const{onDragMove:fe}=oe.current,{active:Se,activatorEvent:Ee,collisions:bt,over:ke}=Xe.current;if(!Se||!Ee)return;const Fe={active:Se,activatorEvent:Ee,collisions:bt,delta:{x:Jt.x,y:Jt.y},over:ke};Ys.unstable_batchedUpdates(()=>{fe?.(Fe),f({type:"onDragMove",event:Fe})})},[Jt.x,Jt.y]),g.useEffect(()=>{const{active:fe,activatorEvent:Se,collisions:Ee,droppableContainers:bt,scrollAdjustedTranslate:ke}=Xe.current;if(!fe||q.current==null||!Se||!ke)return;const{onDragOver:Fe}=oe.current,Ye=bt.get(Xa),Zt=Ye&&Ye.rect.current?{id:Ye.id,rect:Ye.rect.current,data:Ye.data,disabled:Ye.disabled}:null,pe={active:fe,activatorEvent:Se,collisions:Ee,delta:{x:ke.x,y:ke.y},over:Zt};Ys.unstable_batchedUpdates(()=>{Ya(Zt),Fe?.(pe),f({type:"onDragOver",event:pe})})},[Xa]),at(()=>{Xe.current={activatorEvent:Z,active:E,activeNode:B,collisionRect:Qt,collisions:Bs,droppableRects:L,draggableNodes:D,draggingNode:Xt,draggingNodeRect:Yt,droppableContainers:H,over:vt,scrollableAncestors:yt,scrollAdjustedTranslate:Jt},X.current={initial:Yt,translated:Qt}},[E,B,Bs,Qt,D,Xt,Yt,L,H,vt,yt,Jt]),Kh({...Q,delta:U,draggingRect:Qt,pointerCoordinates:Ga,scrollableAncestors:yt,scrollableAncestorRects:Xn});const fu=g.useMemo(()=>({active:E,activeNode:B,activeNodeRect:G,activatorEvent:Z,collisions:Bs,containerNodeRect:$s,dragOverlay:ot,draggableNodes:D,droppableContainers:H,droppableRects:L,over:vt,measureDroppableContainers:$,scrollableAncestors:yt,scrollableAncestorRects:Xn,measuringConfiguration:F,measuringScheduled:O,windowRect:Ki}),[E,B,G,Z,Bs,$s,ot,D,H,L,vt,$,yt,Xn,F,O,Ki]),mu=g.useMemo(()=>({activatorEvent:Z,activators:Qa,active:E,activeNodeRect:G,ariaDescribedById:{draggable:De},dispatch:N,draggableNodes:D,over:vt,measureDroppableContainers:$}),[Z,Qa,E,G,N,De,D,vt,$]);return be.createElement(fc.Provider,{value:b},be.createElement(Wi.Provider,{value:mu},be.createElement(Pc.Provider,{value:fu},be.createElement(Nc.Provider,{value:hu},d)),be.createElement(yp,{disabled:o?.restoreFocus===!1})),be.createElement(wh,{...o,hiddenTextDescribedById:De}));function gu(){const fe=W?.autoScrollEnabled===!1,Se=typeof c=="object"?c.enabled===!1:c===!1,Ee=k&&!fe&&!Se;return typeof c=="object"?{...c,enabled:Ee}:{enabled:Ee}}}),Cp=g.createContext(null),wo="button",_p="Draggable";function Sp(s){let{id:e,data:t,disabled:n=!1,attributes:i}=s;const r=qn(_p),{activators:a,activatorEvent:o,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:h,over:v}=g.useContext(Wi),{role:y=wo,roleDescription:x="draggable",tabIndex:_=0}=i??{},C=c?.id===e,N=g.useContext(C?Nc:Cp),[f,b]=_i(),[S,A]=_i(),k=op(a,e),P=un(t);at(()=>(h.set(e,{id:e,key:r,node:f,activatorNode:S,data:P}),()=>{const U=h.get(e);U&&U.key===r&&h.delete(e)}),[h,e]);const D=g.useMemo(()=>({role:y,tabIndex:_,"aria-disabled":n,"aria-pressed":C&&y===wo?!0:void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[n,y,_,C,x,u.draggable]);return{active:c,activatorEvent:o,activeNodeRect:d,attributes:D,isDragging:C,listeners:n?void 0:k,node:f,over:v,setNodeRef:b,setActivatorNodeRef:A,transform:N}}function Ep(){return g.useContext(Pc)}const Fp="Droppable",Pp={timeout:25};function Np(s){let{data:e,disabled:t=!1,id:n,resizeObserverConfig:i}=s;const r=qn(Fp),{active:a,dispatch:o,over:c,measureDroppableContainers:d}=g.useContext(Wi),u=g.useRef({disabled:t}),h=g.useRef(!1),v=g.useRef(null),y=g.useRef(null),{disabled:x,updateMeasurementsFor:_,timeout:C}={...Pp,...i},N=un(_??n),f=g.useCallback(()=>{if(!h.current){h.current=!0;return}y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{d(Array.isArray(N.current)?N.current:[N.current]),y.current=null},C)},[C]),b=Vi({callback:f,disabled:x||!a}),S=g.useCallback((D,U)=>{b&&(U&&(b.unobserve(U),h.current=!1),D&&b.observe(D))},[b]),[A,k]=_i(S),P=un(e);return g.useEffect(()=>{!b||!A.current||(b.disconnect(),h.current=!1,b.observe(A.current))},[A,b]),g.useEffect(()=>(o({type:re.RegisterDroppable,element:{id:n,key:r,disabled:t,node:A,rect:v,data:P}}),()=>o({type:re.UnregisterDroppable,key:r,id:n})),[n]),g.useEffect(()=>{t!==u.current.disabled&&(o({type:re.SetDroppableDisabled,id:n,key:r,disabled:t}),u.current.disabled=t)},[n,r,t,o]),{active:a,rect:v,isOver:c?.id===n,node:A,over:c,setNodeRef:k}}function ka(s,e,t){const n=s.slice();return n.splice(t<0?n.length+t:t,0,n.splice(e,1)[0]),n}function kp(s,e){return s.reduce((t,n,i)=>{const r=e.get(n);return r&&(t[i]=r),t},Array(s.length))}function ni(s){return s!==null&&s>=0}function Tp(s,e){if(s===e)return!0;if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function Ap(s){return typeof s=="boolean"?{draggable:s,droppable:s}:s}const kc=s=>{let{rects:e,activeIndex:t,overIndex:n,index:i}=s;const r=ka(e,n,t),a=e[i],o=r[i];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},ii={scaleX:1,scaleY:1},Rp=s=>{var e;let{activeIndex:t,activeNodeRect:n,index:i,rects:r,overIndex:a}=s;const o=(e=r[t])!=null?e:n;if(!o)return null;if(i===t){const d=r[a];return d?{x:0,y:t<a?d.top+d.height-(o.top+o.height):d.top-o.top,...ii}:null}const c=Dp(r,i,t);return i>t&&i<=a?{x:0,y:-o.height-c,...ii}:i<t&&i>=a?{x:0,y:o.height+c,...ii}:{x:0,y:0,...ii}};function Dp(s,e,t){const n=s[e],i=s[e-1],r=s[e+1];return n?t<e?i?n.top-(i.top+i.height):r?r.top-(n.top+n.height):0:r?r.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const Tc="Sortable",Ac=be.createContext({activeIndex:-1,containerId:Tc,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:kc,disabled:{draggable:!1,droppable:!1}});function jp(s){let{children:e,id:t,items:n,strategy:i=kc,disabled:r=!1}=s;const{active:a,dragOverlay:o,droppableRects:c,over:d,measureDroppableContainers:u}=Ep(),h=qn(Tc,t),v=o.rect!==null,y=g.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),x=a!=null,_=a?y.indexOf(a.id):-1,C=d?y.indexOf(d.id):-1,N=g.useRef(y),f=!Tp(y,N.current),b=C!==-1&&_===-1||f,S=Ap(r);at(()=>{f&&x&&u(y)},[f,y,x,u]),g.useEffect(()=>{N.current=y},[y]);const A=g.useMemo(()=>({activeIndex:_,containerId:h,disabled:S,disableTransforms:b,items:y,overIndex:C,useDragOverlay:v,sortedRects:kp(y,c),strategy:i}),[_,h,S.draggable,S.droppable,b,y,C,c,v,i]);return be.createElement(Ac.Provider,{value:A},e)}const Op=s=>{let{id:e,items:t,activeIndex:n,overIndex:i}=s;return ka(t,n,i).indexOf(e)},Up=s=>{let{containerId:e,isSorting:t,wasDragging:n,index:i,items:r,newIndex:a,previousItems:o,previousContainerId:c,transition:d}=s;return!d||!n||o!==r&&i===a?!1:t?!0:a!==i&&e===c},Mp={duration:200,easing:"ease"},Rc="transform",Ip=hn.Transition.toString({property:Rc,duration:0,easing:"linear"}),Lp={roleDescription:"sortable"};function $p(s){let{disabled:e,index:t,node:n,rect:i}=s;const[r,a]=g.useState(null),o=g.useRef(t);return at(()=>{if(!e&&t!==o.current&&n.current){const c=i.current;if(c){const d=Ls(n.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}t!==o.current&&(o.current=t)},[e,t,n,i]),g.useEffect(()=>{r&&a(null)},[r]),r}function Bp(s){let{animateLayoutChanges:e=Up,attributes:t,disabled:n,data:i,getNewIndex:r=Op,id:a,strategy:o,resizeObserverConfig:c,transition:d=Mp}=s;const{items:u,containerId:h,activeIndex:v,disabled:y,disableTransforms:x,sortedRects:_,overIndex:C,useDragOverlay:N,strategy:f}=g.useContext(Ac),b=zp(n,y),S=u.indexOf(a),A=g.useMemo(()=>({sortable:{containerId:h,index:S,items:u},...i}),[h,i,S,u]),k=g.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:P,node:D,isOver:U,setNodeRef:H}=Np({id:a,data:A,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:I,activatorEvent:X,activeNodeRect:E,attributes:q,setNodeRef:W,listeners:te,isDragging:Z,over:he,setActivatorNodeRef:oe,transform:De}=Sp({id:a,data:A,attributes:{...Lp,...t},disabled:b.draggable}),Ke=oh(H,W),F=!!I,L=F&&!x&&ni(v)&&ni(C),$=!N&&Z,O=$&&L?De:null,J=L?O??(o??f)({rects:_,activeNodeRect:E,activeIndex:v,overIndex:C,index:S}):null,Q=ni(v)&&ni(C)?r({id:a,items:u,activeIndex:v,overIndex:C}):S,ee=I?.id,G=g.useRef({activeId:ee,items:u,newIndex:Q,containerId:h}),$s=u!==G.current.items,Xe=e({active:I,containerId:h,isDragging:Z,isSorting:F,id:a,index:S,items:u,newIndex:G.current.newIndex,previousItems:G.current.items,previousContainerId:G.current.containerId,transition:d,wasDragging:G.current.activeId!=null}),Kt=$p({disabled:!Xe,index:S,node:D,rect:P});return g.useEffect(()=>{F&&G.current.newIndex!==Q&&(G.current.newIndex=Q),h!==G.current.containerId&&(G.current.containerId=h),u!==G.current.items&&(G.current.items=u)},[F,Q,h,u]),g.useEffect(()=>{if(ee===G.current.activeId)return;if(ee!=null&&G.current.activeId==null){G.current.activeId=ee;return}const Xt=setTimeout(()=>{G.current.activeId=ee},50);return()=>clearTimeout(Xt)},[ee]),{active:I,activeIndex:v,attributes:q,data:A,rect:P,index:S,newIndex:Q,items:u,isOver:U,isSorting:F,isDragging:Z,listeners:te,node:D,overIndex:C,over:he,setNodeRef:Ke,setActivatorNodeRef:oe,setDroppableNodeRef:H,setDraggableNodeRef:W,transform:Kt??J,transition:ot()};function ot(){if(Kt||$s&&G.current.newIndex===S)return Ip;if(!($&&!Ea(X)||!d)&&(F||Xe))return hn.Transition.toString({...d,property:Rc})}}function zp(s,e){var t,n;return typeof s=="boolean"?{draggable:s,droppable:!1}:{draggable:(t=s?.draggable)!=null?t:e.draggable,droppable:(n=s?.droppable)!=null?n:e.droppable}}K.Down,K.Right,K.Up,K.Left;function Hp(s){if(!s||s===""||s==="0"||s===0)return"0.00";const e=typeof s=="string"?parseFloat(s):s;return isNaN(e)?"0.00":(Math.ceil(e*100)/100).toFixed(2)}var xo=1,qp=.9,Vp=.8,Wp=.17,ir=.1,rr=.999,Gp=.9999,Kp=.99,Xp=/[\\\/_+.#"@\[\(\{&]/,Yp=/[\\\/_+.#"@\[\(\{&]/g,Jp=/[\s-]/,Dc=/[\s-]/g;function Ir(s,e,t,n,i,r,a){if(r===e.length)return i===s.length?xo:Kp;var o=`${i},${r}`;if(a[o]!==void 0)return a[o];for(var c=n.charAt(r),d=t.indexOf(c,i),u=0,h,v,y,x;d>=0;)h=Ir(s,e,t,n,d+1,r+1,a),h>u&&(d===i?h*=xo:Xp.test(s.charAt(d-1))?(h*=Vp,y=s.slice(i,d-1).match(Yp),y&&i>0&&(h*=Math.pow(rr,y.length))):Jp.test(s.charAt(d-1))?(h*=qp,x=s.slice(i,d-1).match(Dc),x&&i>0&&(h*=Math.pow(rr,x.length))):(h*=Wp,i>0&&(h*=Math.pow(rr,d-i))),s.charAt(d)!==e.charAt(r)&&(h*=Gp)),(h<ir&&t.charAt(d-1)===n.charAt(r+1)||n.charAt(r+1)===n.charAt(r)&&t.charAt(d-1)!==n.charAt(r))&&(v=Ir(s,e,t,n,d+1,r+2,a),v*ir>h&&(h=v*ir)),h>u&&(u=h),d=t.indexOf(c,d+1);return a[o]=u,u}function Co(s){return s.toLowerCase().replace(Dc," ")}function Qp(s,e,t){return s=t&&t.length>0?`${s+" "+t.join(" ")}`:s,Ir(s,e,Co(s),Co(e),0,0,{})}var Ws='[cmdk-group=""]',ar='[cmdk-group-items=""]',Zp='[cmdk-group-heading=""]',jc='[cmdk-item=""]',_o=`${jc}:not([aria-disabled="true"])`,Lr="cmdk-item-select",cs="data-value",ef=(s,e,t)=>Qp(s,e,t),Oc=g.createContext(void 0),Vn=()=>g.useContext(Oc),Uc=g.createContext(void 0),Ta=()=>g.useContext(Uc),Mc=g.createContext(void 0),Ic=g.forwardRef((s,e)=>{let t=ds(()=>{var F,L;return{search:"",value:(L=(F=s.value)!=null?F:s.defaultValue)!=null?L:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=ds(()=>new Set),i=ds(()=>new Map),r=ds(()=>new Map),a=ds(()=>new Set),o=Lc(s),{label:c,children:d,value:u,onValueChange:h,filter:v,shouldFilter:y,loop:x,disablePointerSelection:_=!1,vimBindings:C=!0,...N}=s,f=hs(),b=hs(),S=hs(),A=g.useRef(null),k=hf();Wt(()=>{if(u!==void 0){let F=u.trim();t.current.value=F,P.emit()}},[u]),Wt(()=>{k(6,E)},[]);let P=g.useMemo(()=>({subscribe:F=>(a.current.add(F),()=>a.current.delete(F)),snapshot:()=>t.current,setState:(F,L,$)=>{var O,B,J,Q;if(!Object.is(t.current[F],L)){if(t.current[F]=L,F==="search")X(),H(),k(1,I);else if(F==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ee=document.getElementById(S);ee?ee.focus():(O=document.getElementById(f))==null||O.focus()}if(k(7,()=>{var ee;t.current.selectedItemId=(ee=q())==null?void 0:ee.id,P.emit()}),$||k(5,E),((B=o.current)==null?void 0:B.value)!==void 0){let ee=L??"";(Q=(J=o.current).onValueChange)==null||Q.call(J,ee);return}}P.emit()}},emit:()=>{a.current.forEach(F=>F())}}),[]),D=g.useMemo(()=>({value:(F,L,$)=>{var O;L!==((O=r.current.get(F))==null?void 0:O.value)&&(r.current.set(F,{value:L,keywords:$}),t.current.filtered.items.set(F,U(L,$)),k(2,()=>{H(),P.emit()}))},item:(F,L)=>(n.current.add(F),L&&(i.current.has(L)?i.current.get(L).add(F):i.current.set(L,new Set([F]))),k(3,()=>{X(),H(),t.current.value||I(),P.emit()}),()=>{r.current.delete(F),n.current.delete(F),t.current.filtered.items.delete(F);let $=q();k(4,()=>{X(),$?.getAttribute("id")===F&&I(),P.emit()})}),group:F=>(i.current.has(F)||i.current.set(F,new Set),()=>{r.current.delete(F),i.current.delete(F)}),filter:()=>o.current.shouldFilter,label:c||s["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:f,inputId:S,labelId:b,listInnerRef:A}),[]);function U(F,L){var $,O;let B=(O=($=o.current)==null?void 0:$.filter)!=null?O:ef;return F?B(F,t.current.search,L):0}function H(){if(!t.current.search||o.current.shouldFilter===!1)return;let F=t.current.filtered.items,L=[];t.current.filtered.groups.forEach(O=>{let B=i.current.get(O),J=0;B.forEach(Q=>{let ee=F.get(Q);J=Math.max(ee,J)}),L.push([O,J])});let $=A.current;W().sort((O,B)=>{var J,Q;let ee=O.getAttribute("id"),G=B.getAttribute("id");return((J=F.get(G))!=null?J:0)-((Q=F.get(ee))!=null?Q:0)}).forEach(O=>{let B=O.closest(ar);B?B.appendChild(O.parentElement===B?O:O.closest(`${ar} > *`)):$.appendChild(O.parentElement===$?O:O.closest(`${ar} > *`))}),L.sort((O,B)=>B[1]-O[1]).forEach(O=>{var B;let J=(B=A.current)==null?void 0:B.querySelector(`${Ws}[${cs}="${encodeURIComponent(O[0])}"]`);J?.parentElement.appendChild(J)})}function I(){let F=W().find($=>$.getAttribute("aria-disabled")!=="true"),L=F?.getAttribute(cs);P.setState("value",L||void 0)}function X(){var F,L,$,O;if(!t.current.search||o.current.shouldFilter===!1){t.current.filtered.count=n.current.size;return}t.current.filtered.groups=new Set;let B=0;for(let J of n.current){let Q=(L=(F=r.current.get(J))==null?void 0:F.value)!=null?L:"",ee=(O=($=r.current.get(J))==null?void 0:$.keywords)!=null?O:[],G=U(Q,ee);t.current.filtered.items.set(J,G),G>0&&B++}for(let[J,Q]of i.current)for(let ee of Q)if(t.current.filtered.items.get(ee)>0){t.current.filtered.groups.add(J);break}t.current.filtered.count=B}function E(){var F,L,$;let O=q();O&&(((F=O.parentElement)==null?void 0:F.firstChild)===O&&(($=(L=O.closest(Ws))==null?void 0:L.querySelector(Zp))==null||$.scrollIntoView({block:"nearest"})),O.scrollIntoView({block:"nearest"}))}function q(){var F;return(F=A.current)==null?void 0:F.querySelector(`${jc}[aria-selected="true"]`)}function W(){var F;return Array.from(((F=A.current)==null?void 0:F.querySelectorAll(_o))||[])}function te(F){let L=W()[F];L&&P.setState("value",L.getAttribute(cs))}function Z(F){var L;let $=q(),O=W(),B=O.findIndex(Q=>Q===$),J=O[B+F];(L=o.current)!=null&&L.loop&&(J=B+F<0?O[O.length-1]:B+F===O.length?O[0]:O[B+F]),J&&P.setState("value",J.getAttribute(cs))}function he(F){let L=q(),$=L?.closest(Ws),O;for(;$&&!O;)$=F>0?df($,Ws):uf($,Ws),O=$?.querySelector(_o);O?P.setState("value",O.getAttribute(cs)):Z(F)}let oe=()=>te(W().length-1),De=F=>{F.preventDefault(),F.metaKey?oe():F.altKey?he(1):Z(1)},Ke=F=>{F.preventDefault(),F.metaKey?te(0):F.altKey?he(-1):Z(-1)};return g.createElement(At.div,{ref:e,tabIndex:-1,...N,"cmdk-root":"",onKeyDown:F=>{var L;(L=N.onKeyDown)==null||L.call(N,F);let $=F.nativeEvent.isComposing||F.keyCode===229;if(!(F.defaultPrevented||$))switch(F.key){case"n":case"j":{C&&F.ctrlKey&&De(F);break}case"ArrowDown":{De(F);break}case"p":case"k":{C&&F.ctrlKey&&Ke(F);break}case"ArrowUp":{Ke(F);break}case"Home":{F.preventDefault(),te(0);break}case"End":{F.preventDefault(),oe();break}case"Enter":{F.preventDefault();let O=q();if(O){let B=new Event(Lr);O.dispatchEvent(B)}}}}},g.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:ff},c),Gi(s,F=>g.createElement(Uc.Provider,{value:P},g.createElement(Oc.Provider,{value:D},F))))}),tf=g.forwardRef((s,e)=>{var t,n;let i=hs(),r=g.useRef(null),a=g.useContext(Mc),o=Vn(),c=Lc(s),d=(n=(t=c.current)==null?void 0:t.forceMount)!=null?n:a?.forceMount;Wt(()=>{if(!d)return o.item(i,a?.id)},[d]);let u=$c(i,r,[s.value,s.children,r],s.keywords),h=Ta(),v=kt(k=>k.value&&k.value===u.current),y=kt(k=>d||o.filter()===!1?!0:k.search?k.filtered.items.get(i)>0:!0);g.useEffect(()=>{let k=r.current;if(!(!k||s.disabled))return k.addEventListener(Lr,x),()=>k.removeEventListener(Lr,x)},[y,s.onSelect,s.disabled]);function x(){var k,P;_(),(P=(k=c.current).onSelect)==null||P.call(k,u.current)}function _(){h.setState("value",u.current,!0)}if(!y)return null;let{disabled:C,value:N,onSelect:f,forceMount:b,keywords:S,...A}=s;return g.createElement(At.div,{ref:dn(r,e),...A,id:i,"cmdk-item":"",role:"option","aria-disabled":!!C,"aria-selected":!!v,"data-disabled":!!C,"data-selected":!!v,onPointerMove:C||o.getDisablePointerSelection()?void 0:_,onClick:C?void 0:x},s.children)}),sf=g.forwardRef((s,e)=>{let{heading:t,children:n,forceMount:i,...r}=s,a=hs(),o=g.useRef(null),c=g.useRef(null),d=hs(),u=Vn(),h=kt(y=>i||u.filter()===!1?!0:y.search?y.filtered.groups.has(a):!0);Wt(()=>u.group(a),[]),$c(a,o,[s.value,s.heading,c]);let v=g.useMemo(()=>({id:a,forceMount:i}),[i]);return g.createElement(At.div,{ref:dn(o,e),...r,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},t&&g.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},t),Gi(s,y=>g.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?d:void 0},g.createElement(Mc.Provider,{value:v},y))))}),nf=g.forwardRef((s,e)=>{let{alwaysRender:t,...n}=s,i=g.useRef(null),r=kt(a=>!a.search);return!t&&!r?null:g.createElement(At.div,{ref:dn(i,e),...n,"cmdk-separator":"",role:"separator"})}),rf=g.forwardRef((s,e)=>{let{onValueChange:t,...n}=s,i=s.value!=null,r=Ta(),a=kt(d=>d.search),o=kt(d=>d.selectedItemId),c=Vn();return g.useEffect(()=>{s.value!=null&&r.setState("search",s.value)},[s.value]),g.createElement(At.input,{ref:e,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":o,id:c.inputId,type:"text",value:i?s.value:a,onChange:d=>{i||r.setState("search",d.target.value),t?.(d.target.value)}})}),af=g.forwardRef((s,e)=>{let{children:t,label:n="Suggestions",...i}=s,r=g.useRef(null),a=g.useRef(null),o=kt(d=>d.selectedItemId),c=Vn();return g.useEffect(()=>{if(a.current&&r.current){let d=a.current,u=r.current,h,v=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let y=d.offsetHeight;u.style.setProperty("--cmdk-list-height",y.toFixed(1)+"px")})});return v.observe(d),()=>{cancelAnimationFrame(h),v.unobserve(d)}}},[]),g.createElement(At.div,{ref:dn(r,e),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:c.listId},Gi(s,d=>g.createElement("div",{ref:dn(a,c.listInnerRef),"cmdk-list-sizer":""},d)))}),of=g.forwardRef((s,e)=>{let{open:t,onOpenChange:n,overlayClassName:i,contentClassName:r,container:a,...o}=s;return g.createElement(Dl,{open:t,onOpenChange:n},g.createElement(jl,{container:a},g.createElement(Il,{"cmdk-overlay":"",className:i}),g.createElement(Ul,{"aria-label":s.label,"cmdk-dialog":"",className:r},g.createElement(Ic,{ref:e,...o}))))}),lf=g.forwardRef((s,e)=>kt(t=>t.filtered.count===0)?g.createElement(At.div,{ref:e,...s,"cmdk-empty":"",role:"presentation"}):null),cf=g.forwardRef((s,e)=>{let{progress:t,children:n,label:i="Loading...",...r}=s;return g.createElement(At.div,{ref:e,...r,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},Gi(s,a=>g.createElement("div",{"aria-hidden":!0},a)))}),_e=Object.assign(Ic,{List:af,Item:tf,Input:rf,Group:sf,Separator:nf,Dialog:of,Empty:lf,Loading:cf});function df(s,e){let t=s.nextElementSibling;for(;t;){if(t.matches(e))return t;t=t.nextElementSibling}}function uf(s,e){let t=s.previousElementSibling;for(;t;){if(t.matches(e))return t;t=t.previousElementSibling}}function Lc(s){let e=g.useRef(s);return Wt(()=>{e.current=s}),e}var Wt=typeof window>"u"?g.useEffect:g.useLayoutEffect;function ds(s){let e=g.useRef();return e.current===void 0&&(e.current=s()),e}function kt(s){let e=Ta(),t=()=>s(e.snapshot());return g.useSyncExternalStore(e.subscribe,t,t)}function $c(s,e,t,n=[]){let i=g.useRef(),r=Vn();return Wt(()=>{var a;let o=(()=>{var d;for(let u of t){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(d=u.current.textContent)==null?void 0:d.trim():i.current}})(),c=n.map(d=>d.trim());r.value(s,o,c),(a=e.current)==null||a.setAttribute(cs,o),i.current=o}),i}var hf=()=>{let[s,e]=g.useState(),t=ds(()=>new Map);return Wt(()=>{t.current.forEach(n=>n()),t.current=new Map},[s]),(n,i)=>{t.current.set(n,i),e({})}};function pf(s){let e=s.type;return typeof e=="function"?e(s.props):"render"in e?e.render(s.props):s}function Gi({asChild:s,children:e},t){return s&&g.isValidElement(e)?g.cloneElement(pf(e),{ref:e.ref},t(e.props.children)):t(e)}var ff={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const $r=g.forwardRef(({className:s,...e},t)=>l.jsx(_e,{ref:t,className:xe("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...e}));$r.displayName=_e.displayName;const Br=g.forwardRef(({className:s,...e},t)=>l.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[l.jsx(Mu,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),l.jsx(_e.Input,{ref:t,className:xe("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...e})]}));Br.displayName=_e.Input.displayName;const mf=g.forwardRef(({className:s,...e},t)=>l.jsx(_e.List,{ref:t,className:xe("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...e}));mf.displayName=_e.List.displayName;const zr=g.forwardRef((s,e)=>l.jsx(_e.Empty,{ref:e,className:"py-6 text-center text-sm",...s}));zr.displayName=_e.Empty.displayName;const Hr=g.forwardRef(({className:s,...e},t)=>l.jsx(_e.Group,{ref:t,className:xe("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...e}));Hr.displayName=_e.Group.displayName;const gf=g.forwardRef(({className:s,...e},t)=>l.jsx(_e.Separator,{ref:t,className:xe("-mx-1 h-px bg-border",s),...e}));gf.displayName=_e.Separator.displayName;const qr=g.forwardRef(({className:s,...e},t)=>l.jsx(_e.Item,{ref:t,className:xe("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...e}));qr.displayName=_e.Item.displayName;function yf(s,e,t){const n=[];return s.forEach(i=>typeof i!="string"?n.push(i):e[Symbol.split](i).forEach((r,a,o)=>{r!==""&&n.push(r),a<o.length-1&&n.push(t)})),n}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function So(s,e){const t=/\$/g,n="$$$$";let i=[s];if(e==null)return i;for(const r of Object.keys(e))if(r!=="_"){let a=e[r];typeof a=="string"&&(a=t[Symbol.replace](a,n)),i=yf(i,new RegExp(`%\\{${r}\\}`,"g"),a)}return i}const vf=s=>{throw new Error(`missing string: ${s}`)};var bn,wn,Vr;class Bc{constructor(e,{onMissingKey:t=vf}={}){T(this,wn);w(this,"locale");T(this,bn);this.locale={strings:{},pluralize(n){return n===1?0:1}},Array.isArray(e)?e.forEach(R(this,wn,Vr),this):R(this,wn,Vr).call(this,e),j(this,bn,t)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let n=this.locale.strings[e];if(n==null&&(m(this,bn).call(this,e),n=e),typeof n=="object"){if(t&&typeof t.smart_count<"u"){const r=this.locale.pluralize(t.smart_count);return So(n[r],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof n!="string")throw new Error("string was not a string");return So(n,t)}}bn=new WeakMap,wn=new WeakSet,Vr=function(e){if(!e?.strings)return;const t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})};class zc{constructor(e,t){w(this,"uppy");w(this,"opts");w(this,"id");w(this,"defaultLocale");w(this,"i18n");w(this,"i18nArray");w(this,"type");w(this,"VERSION");this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new Bc([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function or(s){return s<10?`0${s}`:s.toString()}function vi(){const s=new Date,e=or(s.getHours()),t=or(s.getMinutes()),n=or(s.getSeconds());return`${e}:${t}:${n}`}const bf={debug:()=>{},warn:()=>{},error:(...s)=>console.error(`[Uppy] [${vi()}]`,...s)},wf={debug:(...s)=>console.debug(`[Uppy] [${vi()}]`,...s),warn:(...s)=>console.warn(`[Uppy] [${vi()}]`,...s),error:(...s)=>console.error(`[Uppy] [${vi()}]`,...s)};function Hc(s){return typeof s!="object"||s===null||!("nodeType"in s)?!1:s.nodeType===Node.ELEMENT_NODE}function xf(s,e=document){return typeof s=="string"?e.querySelector(s):Hc(s)?s:null}function qc(s){for(;s&&!s.dir;)s=s.parentNode;return s?.dir}var Wn,z,Vc,Dt,Eo,Wc,Gc,Kc,Aa,Wr,Gr,fn={},Xc=[],Cf=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Gn=Array.isArray;function rt(s,e){for(var t in e)s[t]=e[t];return s}function Ra(s){s&&s.parentNode&&s.parentNode.removeChild(s)}function mn(s,e,t){var n,i,r,a={};for(r in e)r=="key"?n=e[r]:r=="ref"?i=e[r]:a[r]=e[r];if(arguments.length>2&&(a.children=arguments.length>3?Wn.call(arguments,2):t),typeof s=="function"&&s.defaultProps!=null)for(r in s.defaultProps)a[r]===void 0&&(a[r]=s.defaultProps[r]);return ln(s,a,n,i,null)}function ln(s,e,t,n,i){var r={type:s,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Vc,__i:-1,__u:0};return i==null&&z.vnode!=null&&z.vnode(r),r}function _f(){return{current:null}}function qe(s){return s.children}function we(s,e){this.props=s,this.context=e}function Os(s,e){if(e==null)return s.__?Os(s.__,s.__i+1):null;for(var t;e<s.__k.length;e++)if((t=s.__k[e])!=null&&t.__e!=null)return t.__e;return typeof s.type=="function"?Os(s):null}function Yc(s){var e,t;if((s=s.__)!=null&&s.__c!=null){for(s.__e=s.__c.base=null,e=0;e<s.__k.length;e++)if((t=s.__k[e])!=null&&t.__e!=null){s.__e=s.__c.base=t.__e;break}return Yc(s)}}function Fo(s){(!s.__d&&(s.__d=!0)&&Dt.push(s)&&!Pi.__r++||Eo!=z.debounceRendering)&&((Eo=z.debounceRendering)||Wc)(Pi)}function Pi(){for(var s,e,t,n,i,r,a,o=1;Dt.length;)Dt.length>o&&Dt.sort(Gc),s=Dt.shift(),o=Dt.length,s.__d&&(t=void 0,i=(n=(e=s).__v).__e,r=[],a=[],e.__P&&((t=rt({},n)).__v=n.__v+1,z.vnode&&z.vnode(t),Da(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,r,i??Os(n),!!(32&n.__u),a),t.__v=n.__v,t.__.__k[t.__i]=t,Zc(r,t,a),t.__e!=i&&Yc(t)));Pi.__r=0}function Jc(s,e,t,n,i,r,a,o,c,d,u){var h,v,y,x,_,C,N,f=n&&n.__k||Xc,b=e.length;for(c=Sf(t,e,f,c,b),h=0;h<b;h++)(y=t.__k[h])!=null&&(v=y.__i==-1?fn:f[y.__i]||fn,y.__i=h,C=Da(s,y,v,i,r,a,o,c,d,u),x=y.__e,y.ref&&v.ref!=y.ref&&(v.ref&&ja(v.ref,null,y),u.push(y.ref,y.__c||x,y)),_==null&&x!=null&&(_=x),(N=!!(4&y.__u))||v.__k===y.__k?c=Qc(y,c,s,N):typeof y.type=="function"&&C!==void 0?c=C:x&&(c=x.nextSibling),y.__u&=-7);return t.__e=_,c}function Sf(s,e,t,n,i){var r,a,o,c,d,u=t.length,h=u,v=0;for(s.__k=new Array(i),r=0;r<i;r++)(a=e[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(c=r+v,(a=s.__k[r]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?ln(null,a,null,null,null):Gn(a)?ln(qe,{children:a},null,null,null):a.constructor==null&&a.__b>0?ln(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=s,a.__b=s.__b+1,o=null,(d=a.__i=Ef(a,t,c,h))!=-1&&(h--,(o=t[d])&&(o.__u|=2)),o==null||o.__v==null?(d==-1&&(i>u?v--:i<u&&v++),typeof a.type!="function"&&(a.__u|=4)):d!=c&&(d==c-1?v--:d==c+1?v++:(d>c?v--:v++,a.__u|=4))):s.__k[r]=null;if(h)for(r=0;r<u;r++)(o=t[r])!=null&&!(2&o.__u)&&(o.__e==n&&(n=Os(o)),td(o,o));return n}function Qc(s,e,t,n){var i,r;if(typeof s.type=="function"){for(i=s.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=s,e=Qc(i[r],e,t,n));return e}s.__e!=e&&(n&&(e&&s.type&&!e.parentNode&&(e=Os(s)),t.insertBefore(s.__e,e||null)),e=s.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ze(s,e){return e=e||[],s==null||typeof s=="boolean"||(Gn(s)?s.some(function(t){ze(t,e)}):e.push(s)),e}function Ef(s,e,t,n){var i,r,a,o=s.key,c=s.type,d=e[t],u=d!=null&&(2&d.__u)==0;if(d===null&&s.key==null||u&&o==d.key&&c==d.type)return t;if(n>(u?1:0)){for(i=t-1,r=t+1;i>=0||r<e.length;)if((d=e[a=i>=0?i--:r++])!=null&&!(2&d.__u)&&o==d.key&&c==d.type)return a}return-1}function Po(s,e,t){e[0]=="-"?s.setProperty(e,t??""):s[e]=t==null?"":typeof t!="number"||Cf.test(e)?t:t+"px"}function ri(s,e,t,n,i){var r,a;e:if(e=="style")if(typeof t=="string")s.style.cssText=t;else{if(typeof n=="string"&&(s.style.cssText=n=""),n)for(e in n)t&&e in t||Po(s.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||Po(s.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(Kc,"$1")),a=e.toLowerCase(),e=a in s||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),s.l||(s.l={}),s.l[e+r]=t,t?n?t.u=n.u:(t.u=Aa,s.addEventListener(e,r?Gr:Wr,r)):s.removeEventListener(e,r?Gr:Wr,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in s)try{s[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?s.removeAttribute(e):s.setAttribute(e,e=="popover"&&t==1?"":t))}}function No(s){return function(e){if(this.l){var t=this.l[e.type+s];if(e.t==null)e.t=Aa++;else if(e.t<t.u)return;return t(z.event?z.event(e):e)}}}function Da(s,e,t,n,i,r,a,o,c,d){var u,h,v,y,x,_,C,N,f,b,S,A,k,P,D,U,H,I=e.type;if(e.constructor!=null)return null;128&t.__u&&(c=!!(32&t.__u),r=[o=e.__e=t.__e]),(u=z.__b)&&u(e);e:if(typeof I=="function")try{if(N=e.props,f="prototype"in I&&I.prototype.render,b=(u=I.contextType)&&n[u.__c],S=u?b?b.props.value:u.__:n,t.__c?C=(h=e.__c=t.__c).__=h.__E:(f?e.__c=h=new I(N,S):(e.__c=h=new we(N,S),h.constructor=I,h.render=Pf),b&&b.sub(h),h.props=N,h.state||(h.state={}),h.context=S,h.__n=n,v=h.__d=!0,h.__h=[],h._sb=[]),f&&h.__s==null&&(h.__s=h.state),f&&I.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=rt({},h.__s)),rt(h.__s,I.getDerivedStateFromProps(N,h.__s))),y=h.props,x=h.state,h.__v=e,v)f&&I.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),f&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(f&&I.getDerivedStateFromProps==null&&N!==y&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(N,S),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(N,h.__s,S)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(h.props=N,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(X){X&&(X.__=e)}),A=0;A<h._sb.length;A++)h.__h.push(h._sb[A]);h._sb=[],h.__h.length&&a.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(N,h.__s,S),f&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(y,x,_)})}if(h.context=S,h.props=N,h.__P=s,h.__e=!1,k=z.__r,P=0,f){for(h.state=h.__s,h.__d=!1,k&&k(e),u=h.render(h.props,h.state,h.context),D=0;D<h._sb.length;D++)h.__h.push(h._sb[D]);h._sb=[]}else do h.__d=!1,k&&k(e),u=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++P<25);h.state=h.__s,h.getChildContext!=null&&(n=rt(rt({},n),h.getChildContext())),f&&!v&&h.getSnapshotBeforeUpdate!=null&&(_=h.getSnapshotBeforeUpdate(y,x)),U=u,u!=null&&u.type===qe&&u.key==null&&(U=ed(u.props.children)),o=Jc(s,Gn(U)?U:[U],e,t,n,i,r,a,o,c,d),h.base=e.__e,e.__u&=-161,h.__h.length&&a.push(h),C&&(h.__E=h.__=null)}catch(X){if(e.__v=null,c||r!=null)if(X.then){for(e.__u|=c?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,e.__e=o}else{for(H=r.length;H--;)Ra(r[H]);Kr(e)}else e.__e=t.__e,e.__k=t.__k,X.then||Kr(e);z.__e(X,e,t)}else r==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):o=e.__e=Ff(t.__e,e,t,n,i,r,a,c,d);return(u=z.diffed)&&u(e),128&e.__u?void 0:o}function Kr(s){s&&s.__c&&(s.__c.__e=!0),s&&s.__k&&s.__k.forEach(Kr)}function Zc(s,e,t){for(var n=0;n<t.length;n++)ja(t[n],t[++n],t[++n]);z.__c&&z.__c(e,s),s.some(function(i){try{s=i.__h,i.__h=[],s.some(function(r){r.call(i)})}catch(r){z.__e(r,i.__v)}})}function ed(s){return typeof s!="object"||s==null||s.__b&&s.__b>0?s:Gn(s)?s.map(ed):rt({},s)}function Ff(s,e,t,n,i,r,a,o,c){var d,u,h,v,y,x,_,C=t.props,N=e.props,f=e.type;if(f=="svg"?i="http://www.w3.org/2000/svg":f=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((y=r[d])&&"setAttribute"in y==!!f&&(f?y.localName==f:y.nodeType==3)){s=y,r[d]=null;break}}if(s==null){if(f==null)return document.createTextNode(N);s=document.createElementNS(i,f,N.is&&N),o&&(z.__m&&z.__m(e,r),o=!1),r=null}if(f==null)C===N||o&&s.data==N||(s.data=N);else{if(r=r&&Wn.call(s.childNodes),C=t.props||fn,!o&&r!=null)for(C={},d=0;d<s.attributes.length;d++)C[(y=s.attributes[d]).name]=y.value;for(d in C)if(y=C[d],d!="children"){if(d=="dangerouslySetInnerHTML")h=y;else if(!(d in N)){if(d=="value"&&"defaultValue"in N||d=="checked"&&"defaultChecked"in N)continue;ri(s,d,null,y,i)}}for(d in N)y=N[d],d=="children"?v=y:d=="dangerouslySetInnerHTML"?u=y:d=="value"?x=y:d=="checked"?_=y:o&&typeof y!="function"||C[d]===y||ri(s,d,y,C[d],i);if(u)o||h&&(u.__html==h.__html||u.__html==s.innerHTML)||(s.innerHTML=u.__html),e.__k=[];else if(h&&(s.innerHTML=""),Jc(e.type=="template"?s.content:s,Gn(v)?v:[v],e,t,n,f=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:t.__k&&Os(t,0),o,c),r!=null)for(d=r.length;d--;)Ra(r[d]);o||(d="value",f=="progress"&&x==null?s.removeAttribute("value"):x!=null&&(x!==s[d]||f=="progress"&&!x||f=="option"&&x!=C[d])&&ri(s,d,x,C[d],i),d="checked",_!=null&&_!=s[d]&&ri(s,d,_,C[d],i))}return s}function ja(s,e,t){try{if(typeof s=="function"){var n=typeof s.__u=="function";n&&s.__u(),n&&e==null||(s.__u=s(e))}else s.current=e}catch(i){z.__e(i,t)}}function td(s,e,t){var n,i;if(z.unmount&&z.unmount(s),(n=s.ref)&&(n.current&&n.current!=s.__e||ja(n,null,e)),(n=s.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(r){z.__e(r,e)}n.base=n.__P=null}if(n=s.__k)for(i=0;i<n.length;i++)n[i]&&td(n[i],e,t||typeof s.type!="function");t||Ra(s.__e),s.__c=s.__=s.__e=void 0}function Pf(s,e,t){return this.constructor(s,t)}function Nf(s,e,t){var n,i,r,a;e==document&&(e=document.documentElement),z.__&&z.__(s,e),i=(n=!1)?null:e.__k,r=[],a=[],Da(e,s=e.__k=mn(qe,null,[s]),i||fn,fn,e.namespaceURI,i?null:e.firstChild?Wn.call(e.childNodes):null,r,i?i.__e:e.firstChild,n,a),Zc(r,s,a)}function sd(s,e,t){var n,i,r,a,o=rt({},s.props);for(r in s.type&&s.type.defaultProps&&(a=s.type.defaultProps),e)r=="key"?n=e[r]:r=="ref"?i=e[r]:o[r]=e[r]===void 0&&a!=null?a[r]:e[r];return arguments.length>2&&(o.children=arguments.length>3?Wn.call(arguments,2):t),ln(s.type,o,n||s.key,i||s.ref,null)}Wn=Xc.slice,z={__e:function(s,e,t,n){for(var i,r,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(s)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(s,n||{}),a=i.__d),a)return i.__E=i}catch(o){s=o}throw s}},Vc=0,we.prototype.setState=function(s,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=rt({},this.state),typeof s=="function"&&(s=s(rt({},t),this.props)),s&&rt(t,s),s!=null&&this.__v&&(e&&this._sb.push(e),Fo(this))},we.prototype.forceUpdate=function(s){this.__v&&(this.__e=!0,s&&this.__h.push(s),Fo(this))},we.prototype.render=qe,Dt=[],Wc=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Gc=function(s,e){return s.__v.__b-e.__v.__b},Pi.__r=0,Kc=/(PointerCapture)$|Capture$/i,Aa=0,Wr=No(!1),Gr=No(!0);var gn,ne,lr,ko,yn=0,nd=[],ie=z,To=ie.__b,Ao=ie.__r,Ro=ie.diffed,Do=ie.__c,jo=ie.unmount,Oo=ie.__;function Oa(s,e){ie.__h&&ie.__h(ne,s,yn||e),yn=0;var t=ne.__H||(ne.__H={__:[],__h:[]});return s>=t.__.length&&t.__.push({}),t.__[s]}function Ni(s){return yn=1,kf(rd,s)}function kf(s,e,t){var n=Oa(gn++,2);if(n.t=s,!n.__c&&(n.__=[t?t(e):rd(void 0,e),function(o){var c=n.__N?n.__N[0]:n.__[0],d=n.t(c,o);c!==d&&(n.__N=[d,n.__[1]],n.__c.setState({}))}],n.__c=ne,!ne.__f)){var i=function(o,c,d){if(!n.__c.__H)return!0;var u=n.__c.__H.__.filter(function(v){return!!v.__c});if(u.every(function(v){return!v.__N}))return!r||r.call(this,o,c,d);var h=n.__c.props!==o;return u.forEach(function(v){if(v.__N){var y=v.__[0];v.__=v.__N,v.__N=void 0,y!==v.__[0]&&(h=!0)}}),r&&r.call(this,o,c,d)||h};ne.__f=!0;var r=ne.shouldComponentUpdate,a=ne.componentWillUpdate;ne.componentWillUpdate=function(o,c,d){if(this.__e){var u=r;r=void 0,i(o,c,d),r=u}a&&a.call(this,o,c,d)},ne.shouldComponentUpdate=i}return n.__N||n.__}function Xr(s,e){var t=Oa(gn++,3);!ie.__s&&id(t.__H,e)&&(t.__=s,t.u=e,ne.__H.__h.push(t))}function bi(s){return yn=5,Ua(function(){return{current:s}},[])}function Ua(s,e){var t=Oa(gn++,7);return id(t.__H,e)&&(t.__=s(),t.__H=e,t.__h=s),t.__}function Tf(s,e){return yn=8,Ua(function(){return s},e)}function Af(){for(var s;s=nd.shift();)if(s.__P&&s.__H)try{s.__H.__h.forEach(wi),s.__H.__h.forEach(Yr),s.__H.__h=[]}catch(e){s.__H.__h=[],ie.__e(e,s.__v)}}ie.__b=function(s){ne=null,To&&To(s)},ie.__=function(s,e){s&&e.__k&&e.__k.__m&&(s.__m=e.__k.__m),Oo&&Oo(s,e)},ie.__r=function(s){Ao&&Ao(s),gn=0;var e=(ne=s.__c).__H;e&&(lr===ne?(e.__h=[],ne.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(wi),e.__h.forEach(Yr),e.__h=[],gn=0)),lr=ne},ie.diffed=function(s){Ro&&Ro(s);var e=s.__c;e&&e.__H&&(e.__H.__h.length&&(nd.push(e)!==1&&ko===ie.requestAnimationFrame||((ko=ie.requestAnimationFrame)||Rf)(Af)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),lr=ne=null},ie.__c=function(s,e){e.some(function(t){try{t.__h.forEach(wi),t.__h=t.__h.filter(function(n){return!n.__||Yr(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],ie.__e(n,t.__v)}}),Do&&Do(s,e)},ie.unmount=function(s){jo&&jo(s);var e,t=s.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{wi(n)}catch(i){e=i}}),t.__H=void 0,e&&ie.__e(e,t.__v))};var Uo=typeof requestAnimationFrame=="function";function Rf(s){var e,t=function(){clearTimeout(n),Uo&&cancelAnimationFrame(e),setTimeout(s)},n=setTimeout(t,35);Uo&&(e=requestAnimationFrame(t))}function wi(s){var e=ne,t=s.__c;typeof t=="function"&&(s.__c=void 0,t()),ne=e}function Yr(s){var e=ne;s.__c=s.__(),ne=e}function id(s,e){return!s||s.length!==e.length||e.some(function(t,n){return t!==s[n]})}function rd(s,e){return typeof e=="function"?e(s):e}function Df(s,e){for(var t in e)s[t]=e[t];return s}function Mo(s,e){for(var t in s)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&s[n]!==e[n])return!0;return!1}function Io(s,e){this.props=s,this.context=e}(Io.prototype=new we).isPureReactComponent=!0,Io.prototype.shouldComponentUpdate=function(s,e){return Mo(this.props,s)||Mo(this.state,e)};var Lo=z.__b;z.__b=function(s){s.type&&s.type.__f&&s.ref&&(s.props.ref=s.ref,s.ref=null),Lo&&Lo(s)};var jf=z.__e;z.__e=function(s,e,t,n){if(s.then){for(var i,r=e;r=r.__;)if((i=r.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(s,e)}jf(s,e,t,n)};var $o=z.unmount;function ad(s,e,t){return s&&(s.__c&&s.__c.__H&&(s.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),s.__c.__H=null),(s=Df({},s)).__c!=null&&(s.__c.__P===t&&(s.__c.__P=e),s.__c.__e=!0,s.__c=null),s.__k=s.__k&&s.__k.map(function(n){return ad(n,e,t)})),s}function od(s,e,t){return s&&t&&(s.__v=null,s.__k=s.__k&&s.__k.map(function(n){return od(n,e,t)}),s.__c&&s.__c.__P===e&&(s.__e&&t.appendChild(s.__e),s.__c.__e=!0,s.__c.__P=t)),s}function cr(){this.__u=0,this.o=null,this.__b=null}function ld(s){var e=s.__.__c;return e&&e.__a&&e.__a(s)}function ai(){this.i=null,this.l=null}z.unmount=function(s){var e=s.__c;e&&e.__R&&e.__R(),e&&32&s.__u&&(s.type=null),$o&&$o(s)},(cr.prototype=new we).__c=function(s,e){var t=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(t);var i=ld(n.__v),r=!1,a=function(){r||(r=!0,t.__R=null,i?i(o):o())};t.__R=a;var o=function(){if(!--n.__u){if(n.state.__a){var c=n.state.__a;n.__v.__k[0]=od(c,c.__c.__P,c.__c.__O)}var d;for(n.setState({__a:n.__b=null});d=n.o.pop();)d.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),s.then(a,a)},cr.prototype.componentWillUnmount=function(){this.o=[]},cr.prototype.render=function(s,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=ad(this.__b,t,n.__O=n.__P)}this.__b=null}var i=e.__a&&mn(qe,null,s.fallback);return i&&(i.__u&=-33),[mn(qe,null,e.__a?null:s.children),i]};var Bo=function(s,e,t){if(++t[1]===t[0]&&s.l.delete(e),s.props.revealOrder&&(s.props.revealOrder[0]!=="t"||!s.l.size))for(t=s.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;s.i=t=t[2]}};(ai.prototype=new we).__a=function(s){var e=this,t=ld(e.__v),n=e.l.get(s);return n[0]++,function(i){var r=function(){e.props.revealOrder?(n.push(i),Bo(e,s,n)):i()};t?t(r):r()}},ai.prototype.render=function(s){this.i=null,this.l=new Map;var e=ze(s.children);s.revealOrder&&s.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return s.children},ai.prototype.componentDidUpdate=ai.prototype.componentDidMount=function(){var s=this;this.l.forEach(function(e,t){Bo(s,t,e)})};var Of=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Uf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Mf=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,If=/[A-Z0-9]/g,Lf=typeof document<"u",$f=function(s){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(s)};function zo(s,e,t){return e.__k==null&&(e.textContent=""),Nf(s,e),typeof t=="function"&&t(),s?s.__c:null}we.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(s){Object.defineProperty(we.prototype,s,{configurable:!0,get:function(){return this["UNSAFE_"+s]},set:function(e){Object.defineProperty(this,s,{configurable:!0,writable:!0,value:e})}})});var Ho=z.event;function Bf(){}function zf(){return this.cancelBubble}function Hf(){return this.defaultPrevented}z.event=function(s){return Ho&&(s=Ho(s)),s.persist=Bf,s.isPropagationStopped=zf,s.isDefaultPrevented=Hf,s.nativeEvent=s};var qf={enumerable:!1,configurable:!0,get:function(){return this.class}},qo=z.vnode;z.vnode=function(s){typeof s.type=="string"&&function(e){var t=e.props,n=e.type,i={},r=n.indexOf("-")===-1;for(var a in t){var o=t[a];if(!(a==="value"&&"defaultValue"in t&&o==null||Lf&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var c=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&o===!0?o="":c==="translate"&&o==="no"?o=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?a="ondblclick":c!=="onchange"||n!=="input"&&n!=="textarea"||$f(t.type)?c==="onfocus"?a="onfocusin":c==="onblur"?a="onfocusout":Mf.test(a)&&(a=c):c=a="oninput":r&&Uf.test(a)?a=a.replace(If,"-$&").toLowerCase():o===null&&(o=void 0),c==="oninput"&&i[a=c]&&(a="oninputCapture"),i[a]=o}}n=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=ze(t.children).forEach(function(d){d.props.selected=i.value.indexOf(d.props.value)!=-1})),n=="select"&&i.defaultValue!=null&&(i.value=ze(t.children).forEach(function(d){d.props.selected=i.multiple?i.defaultValue.indexOf(d.props.value)!=-1:i.defaultValue==d.props.value})),t.class&&!t.className?(i.class=t.class,Object.defineProperty(i,"className",qf)):(t.className&&!t.class||t.class&&t.className)&&(i.class=i.className=t.className),e.props=i}(s),s.$$typeof=Of,qo&&qo(s)};var Vo=z.__r;z.__r=function(s){Vo&&Vo(s),s.__c};var Wo=z.diffed;z.diffed=function(s){Wo&&Wo(s);var e=s.props,t=s.__e;t!=null&&s.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function Vf(s){let e=null,t;return(...n)=>(t=n,e||(e=Promise.resolve().then(()=>(e=null,s(...t)))),e)}var xn;const Ti=class Ti extends zc{constructor(){super(...arguments);T(this,xn);w(this,"isTargetDOMEl");w(this,"el");w(this,"parent");w(this,"title")}getTargetPlugin(t){let n;if(typeof t?.addTarget=="function")n=t,n instanceof Ti||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:n,UIPlugin:Ti}}));else if(typeof t=="function"){const i=t;this.uppy.iteratePlugins(r=>{r instanceof i&&(n=r)})}return n}mount(t,n){const i=n.id,r=xf(t);if(r){this.isTargetDOMEl=!0;const c=document.createElement("div");return c.classList.add("uppy-Root"),j(this,xn,Vf(d=>{this.uppy.getPlugin(this.id)&&(zo(this.render(d,c),c),this.afterUpdate())})),this.uppy.log(`Installing ${i} to a DOM element '${t}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),zo(this.render(this.uppy.getState(),c),c),this.el=c,r.appendChild(c),c.dir=this.opts.direction||qc(c)||"ltr",this.onMount(),this.el}const a=this.getTargetPlugin(t);if(a)return this.uppy.log(`Installing ${i} to ${a.id}`),this.parent=a,this.el=a.addTarget(n),this.onMount(),this.el;this.uppy.log(`Not installing ${i}`);let o=`Invalid target option given to ${i}.`;throw typeof t=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(t,n){throw new Error("Extend the render method to add your plugin to a DOM element")}update(t){var n;this.el!=null&&((n=m(this,xn))==null||n.call(this,t))}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}};xn=new WeakMap;let Us=Ti;const Wf="4.3.2",Gf={version:Wf};var ms,Ai,dd;class cd{constructor(){T(this,Ai);w(this,"state",{});T(this,ms,new Set)}getState(){return this.state}setState(e){const t={...this.state},n={...this.state,...e};this.state=n,R(this,Ai,dd).call(this,t,n,e)}subscribe(e){return m(this,ms).add(e),()=>{m(this,ms).delete(e)}}}ms=new WeakMap,Ai=new WeakSet,dd=function(...e){m(this,ms).forEach(t=>{t(...e)})},w(cd,"VERSION",Gf.version);function ud(s){const e=s.lastIndexOf(".");return e===-1||e===s.length-1?{name:s,extension:void 0}:{name:s.slice(0,e),extension:s.slice(e+1)}}const Go={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function hd(s){if(s.type)return s.type;const e=s.name?ud(s.name).extension?.toLowerCase():null;return e&&e in Go?Go[e]:"application/octet-stream"}function Kf(s){return s.charCodeAt(0).toString(32)}function Ko(s){let e="";return s.replace(/[^A-Z0-9]/gi,t=>(e+=`-${Kf(t)}`,"/"))+e}function Xf(s,e){let t=e||"uppy";return typeof s.name=="string"&&(t+=`-${Ko(s.name.toLowerCase())}`),s.type!==void 0&&(t+=`-${s.type}`),s.meta&&typeof s.meta.relativePath=="string"&&(t+=`-${Ko(s.meta.relativePath.toLowerCase())}`),s.data.size!==void 0&&(t+=`-${s.data.size}`),s.data.lastModified!==void 0&&(t+=`-${s.data.lastModified}`),t}function Yf(s){return!s.isRemote||!s.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(s.remote.provider)}function Jf(s,e){if(Yf(s))return s.id;const t=hd(s);return Xf({...s,type:t},e)}var Qf=function(){var e={},t=e._fns={};e.emit=function(a,o,c,d,u,h,v){var y=n(a);y.length&&i(a,y,[o,c,d,u,h,v])},e.on=function(a,o){t[a]||(t[a]=[]),t[a].push(o)},e.once=function(a,o){function c(){o.apply(this,arguments),e.off(a,c)}this.on(a,c)},e.off=function(a,o){var c=[];if(a&&o){var d=this._fns[a],u=0,h=d?d.length:0;for(u;u<h;u++)d[u]!==o&&c.push(d[u])}c.length?this._fns[a]=c:delete this._fns[a]};function n(r){var a=t[r]?t[r]:[],o=r.indexOf(":"),c=o===-1?[r]:[r.substring(0,o),r.substring(o+1)],d=Object.keys(t),u=0,h=d.length;for(u;u<h;u++){var v=d[u];if(v==="*"&&(a=a.concat(t[v])),c.length===2&&c[0]===v){a=a.concat(t[v]);break}}return a}function i(r,a,o){var c=0,d=a.length;for(c;c<d&&a[c];c++)a[c].event=r,a[c].apply(a[c],o)}return e};const Zf=$n(Qf);let em="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",tm=(s=21)=>{let e="",t=s|0;for(;t--;)e+=em[Math.random()*64|0];return e};const sm="4.5.3",nm={version:sm};function im(s,e){return e.name?e.name:s.split("/")[0]==="image"?`${s.split("/")[0]}.${s.split("/")[1]}`:"noname"}const rm={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var am=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0;let n=Math.abs(e);if(t&&(n=-n),n===0)return"0 B";const i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],r=Math.min(Math.floor(Math.log(n)/Math.log(1024)),i.length-1),a=Number(n/1024**r),o=i[r];return`${a>=10||a%1===0?Math.round(a):a.toFixed(1)} ${o}`};const jt=$n(am);function pd(s,e){this.text=s=s||"",this.hasWild=~s.indexOf("*"),this.separator=e,this.parts=s.split(e)}pd.prototype.match=function(s){var e=!0,t=this.parts,n,i=t.length,r;if(typeof s=="string"||s instanceof String)if(!this.hasWild&&this.text!=s)e=!1;else{for(r=(s||"").split(this.separator),n=0;e&&n<i;n++)t[n]!=="*"&&(n<r.length?e=t[n]===r[n]:e=!1);e=e&&r}else if(typeof s.splice=="function")for(e=[],n=s.length;n--;)this.match(s[n])&&(e[e.length]=s[n]);else if(typeof s=="object"){e={};for(var a in s)this.match(a)&&(e[a]=s[a])}return e};var om=function(s,e,t){var n=new pd(s,t||/[\/\.]/);return typeof e<"u"?n.match(e):n},lm=om,cm=/[\/\+\.]/,dm=function(s,e){function t(n){var i=lm(n,s,cm);return i&&i.length>=2}return e?t(e.split(";")[0]):t};const um=$n(dm),hm={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class $e extends Error{constructor(t,n){super(t);w(this,"isUserFacing");w(this,"file");w(this,"isRestriction",!0);this.isUserFacing=n?.isUserFacing??!0,n?.file&&(this.file=n.file)}}class pm{constructor(e,t){w(this,"getI18n");w(this,"getOpts");this.getI18n=t,this.getOpts=()=>{const n=e();if(n.restrictions?.allowedFileTypes!=null&&!Array.isArray(n.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return n}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:n,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i&&e.filter(a=>!a.isGhost).length+t.length>i)throw new $e(`${this.getI18n()("youCanOnlyUploadX",{smart_count:i})}`);if(n){const r=[...e,...t].reduce((a,o)=>a+(o.size??0),0);if(r>n)throw new $e(this.getI18n()("aggregateExceedsSize",{sizeAllowed:jt(n),size:jt(r)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:n,allowedFileTypes:i}=this.getOpts().restrictions;if(i&&!i.some(a=>a.includes("/")?e.type?um(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){const a=i.join(", ");throw new $e(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new $e(this.getI18n()("exceedsSize",{size:jt(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(n&&e.size!=null&&e.size<n)throw new $e(this.getI18n()("inferiorSize",{size:jt(n)}),{file:e})}validate(e,t){t.forEach(n=>{this.validateSingleFile(n)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new $e(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new $e(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:n}=this.getOpts().restrictions,i=[];for(const r of n)(!Object.hasOwn(e.meta,r)||e.meta[r]==="")&&i.push(r);return{missingFields:i,error:t}}}function fm(s){if(s==null&&typeof navigator<"u"&&(s=navigator.userAgent),!s)return!0;const e=/Edge\/(\d+\.\d+)/.exec(s);if(!e)return!0;const n=e[1].split(".",2),i=parseInt(n[0],10),r=parseInt(n[1],10);return i<15||i===15&&r<15063||i>18||i===18&&r>=18218}const oi={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var je,Oe,Cn,Ot,gs,ys,Ut,M,Rt,Qr,fd,Zr,md,ea,ta,sa,na,Ri,ia,Mt,gd,yd,Et,_n,Js,vd,xi,Qs;const Di=class Di{constructor(e){T(this,M);T(this,je,Object.create(null));T(this,Oe);T(this,Cn);T(this,Ot,Zf());T(this,gs,new Set);T(this,ys,new Set);T(this,Ut,new Set);w(this,"defaultLocale");w(this,"locale");w(this,"opts");w(this,"store");w(this,"i18n");w(this,"i18nArray");w(this,"scheduledAutoProceed",null);w(this,"wasOffline",!1);T(this,Ri,(e,t)=>{const n=e?this.getFile(e.id):void 0;if(e==null||!n){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}const i={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};n.progress.uploadStarted!=null?this.setFileState(e.id,{progress:{...n.progress,...i,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...n.progress,...i}}),m(this,Mt).call(this)});T(this,Mt,$u(()=>R(this,M,ia).call(this),500,{leading:!0,trailing:!0}));T(this,Et,this.updateOnlineStatus.bind(this));T(this,_n,new Map);this.defaultLocale=rm;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:hm,meta:{},onBeforeFileAdded:(i,r)=>!Object.hasOwn(r,i.id),onBeforeUpload:i=>i,store:new cd,logger:bf,infoTimeout:5e3},n={...t,...e};this.opts={...n,restrictions:{...t.restrictions,...e?.restrictions}},e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=wf),this.log(`Using Core v${Di.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...oi,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:fm(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),j(this,Oe,new pm(()=>this.opts,()=>this.i18n)),j(this,Cn,this.store.subscribe((i,r,a)=>{this.emit("state-update",i,r,a),this.updateAll(r)})),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),R(this,M,yd).call(this)}emit(e,...t){m(this,Ot).emit(e,...t)}on(e,t){return m(this,Ot).on(e,t),this}once(e,t){return m(this,Ot).once(e,t),this}off(e,t){return m(this,Ot).off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(([n,i])=>[n,{...t[n],...i}]))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can’t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=n=>this.log(`Missing i18n string: ${n}`,"error"),t=new Bc([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},n=Object.create(null);Object.keys(t).forEach(i=>{n[i]={...t[i],progress:{...t[i].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:n,...oi})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...oi,files:{}})}addPreProcessor(e){m(this,gs).add(e)}removePreProcessor(e){return m(this,gs).delete(e)}addPostProcessor(e){m(this,Ut).add(e)}removePostProcessor(e){return m(this,Ut).delete(e)}addUploader(e){m(this,ys).add(e)}removeUploader(e){return m(this,ys).delete(e)}setMeta(e){const t={...this.getState().meta,...e},n={...this.getState().files};Object.keys(n).forEach(i=>{n[i]={...n[i],meta:{...n[i].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:n})}setFileMeta(e,t){const n={...this.getState().files};if(!n[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const i={...n[e].meta,...t};n[e]={...n[e],meta:i},this.setState({files:n})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:n}=this.getState(),i=Object.values(e),r=[],a=[],o=[],c=[],d=[],u=[],h=[],v=[],y=[];for(const x of i){const{progress:_}=x;!_.uploadComplete&&_.uploadStarted&&(r.push(x),x.isPaused||v.push(x)),_.uploadStarted||a.push(x),(_.uploadStarted||_.preprocess||_.postprocess)&&o.push(x),_.uploadStarted&&c.push(x),x.isPaused&&d.push(x),_.uploadComplete&&u.push(x),x.error&&h.push(x),(_.preprocess||_.postprocess)&&y.push(x)}return{newFiles:a,startedFiles:o,uploadStartedFiles:c,pausedFiles:d,completeFiles:u,erroredFiles:h,inProgressFiles:r,inProgressNotPausedFiles:v,processingFiles:y,isUploadStarted:c.length>0,isAllComplete:t===100&&u.length===i.length&&y.length===0,isAllErrored:!!n&&h.length===i.length,isAllPaused:r.length!==0&&d.length===r.length,isUploadInProgress:r.length>0,isSomeGhost:i.some(x=>x.isGhost)}}validateRestrictions(e,t=this.getFiles()){try{m(this,Oe).validate(t,[e])}catch(n){return n}return null}validateSingleFile(e){try{m(this,Oe).validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{m(this,Oe).validateAggregateRestrictions(t,e)}catch(n){return n.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}addFile(e){R(this,M,Zr).call(this,e);const{nextFilesState:t,validFilesToAdd:n,errors:i}=R(this,M,ta).call(this,[e]),r=i.filter(o=>o.isRestriction);if(R(this,M,Rt).call(this,r),i.length>0)throw i[0];this.setState({files:t});const[a]=n;return this.emit("file-added",a),this.emit("files-added",n),this.log(`Added file: ${a.name}, ${a.id}, mime type: ${a.type}`),R(this,M,ea).call(this),a.id}addFiles(e){R(this,M,Zr).call(this);const{nextFilesState:t,validFilesToAdd:n,errors:i}=R(this,M,ta).call(this,e),r=i.filter(o=>o.isRestriction);R(this,M,Rt).call(this,r);const a=i.filter(o=>!o.isRestriction);if(a.length>0){let o=`Multiple errors occurred while adding files:
`;if(a.forEach(c=>{o+=`
 * ${c.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:a.length}),details:o},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(a,o);{const c=new Error(o);throw c.errors=a,c}}this.setState({files:t}),n.forEach(o=>{this.emit("file-added",o)}),this.emit("files-added",n),n.length>5?this.log(`Added batch of ${n.length} files`):Object.values(n).forEach(o=>{this.log(`Added file: ${o.name}
 id: ${o.id}
 type: ${o.type}`)}),n.length>0&&R(this,M,ea).call(this)}removeFiles(e){const{files:t,currentUploads:n}=this.getState(),i={...t},r={...n},a=Object.create(null);e.forEach(u=>{t[u]&&(a[u]=t[u],delete i[u])});function o(u){return a[u]===void 0}Object.keys(r).forEach(u=>{const h=n[u].fileIDs.filter(o);if(h.length===0){delete r[u];return}const{capabilities:v}=this.getState();if(h.length!==n[u].fileIDs.length&&!v.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");r[u]={...n[u],fileIDs:h}});const c={currentUploads:r,files:i};Object.keys(i).length===0&&(c.allowNewUpload=!0,c.error=null,c.recoveredState=null),this.setState(c),m(this,Mt).call(this);const d=Object.keys(a);d.forEach(u=>{this.emit("file-removed",a[u])}),d.length>5?this.log(`Removed ${d.length} files`):this.log(`Removed files: ${d.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),i=!(t.isPaused||!1);return this.setFileState(e,{isPaused:i}),this.emit("upload-pause",t,i),i}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{const i={...e[n],isPaused:!0};e[n]=i}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{const i={...e[n],isPaused:!1,error:null};e[n]=i}),this.setState({files:e}),this.emit("resume-all")}async retryAll(){const e=await R(this,M,na).call(this);return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(oi)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=R(this,M,Js).call(this,[e],{forceAllowNewUpload:!0});return R(this,M,Qs).call(this,t)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}[Symbol.for("uppy test: updateTotalProgress")](){return R(this,M,ia).call(this)}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){const a=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(a)}const n=new e(this,...t),i=n.id;if(!i)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");const r=this.getPlugin(i);if(r){const a=`Already found a plugin named '${r.id}'. Tried to use: '${i}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(a)}return e.VERSION&&this.log(`Using ${i} v${e.VERSION}`),n.type in m(this,je)?m(this,je)[n.type].push(n):m(this,je)[n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(e){for(const t of Object.values(m(this,je))){const n=t.find(i=>i.id===e);if(n!=null)return n}}[Symbol.for("uppy test: getPlugins")](e){return m(this,je)[e]}iteratePlugins(e){Object.values(m(this,je)).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=m(this,je)[e.type],n=t.findIndex(a=>a.id===e.id);n!==-1&&t.splice(n,1);const r={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(r)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),m(this,Cn).call(this),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",m(this,Et)),window.removeEventListener("offline",m(this,Et)))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",n=3e3){const i=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:i?e.message:e,details:i?e.details:null}]}),setTimeout(()=>this.hideInfo(),n),this.emit("info-visible")}log(e,t){const{logger:n}=this.opts;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e);break}}registerRequestClient(e,t){m(this,_n).set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=m(this,_n).get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?R(this,M,Qs).call(this,e):(R(this,M,xi).call(this,e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](...e){return R(this,M,Js).call(this,...e)}addResultData(e,t){if(!R(this,M,vd).call(this,e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:n}=this.getState(),i={...n[e],result:{...n[e].result,...t}};this.setState({currentUploads:{...n,[e]:i}})}async upload(){m(this,je).uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(R(this,M,sa).call(this).length>0){const i=await R(this,M,na).call(this);if(!(this.getFiles().filter(a=>a.progress.uploadStarted==null).length>0))return this.emit("complete",i),i;({files:e}=this.getState())}const n=this.opts.onBeforeUpload(e);return n===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&typeof n=="object"&&(e=n,this.setState({files:e})),Promise.resolve().then(()=>m(this,Oe).validateMinNumberOfFiles(e)).catch(i=>{throw R(this,M,Rt).call(this,[i]),i}).then(()=>{if(!R(this,M,fd).call(this,e))throw new $e(this.i18n("missingRequiredMetaField"))}).catch(i=>{throw i}).then(async()=>{const{currentUploads:i}=this.getState(),r=Object.values(i).flatMap(d=>d.fileIDs),a=[];Object.keys(e).forEach(d=>{const u=this.getFile(d);!u.progress.uploadStarted&&r.indexOf(d)===-1&&a.push(u.id)});const o=R(this,M,Js).call(this,a),c=await R(this,M,Qs).call(this,o);return this.emit("complete",c),c}).catch(i=>{throw this.emit("error",i),this.log(i,"error"),i}))}};je=new WeakMap,Oe=new WeakMap,Cn=new WeakMap,Ot=new WeakMap,gs=new WeakMap,ys=new WeakMap,Ut=new WeakMap,M=new WeakSet,Rt=function(e){for(const a of e)a.isRestriction?this.emit("restriction-failed",a.file,a):this.emit("error",a,a.file),this.log(a,"warning");const t=e.filter(a=>a.isUserFacing),n=4,i=t.slice(0,n),r=t.slice(n);i.forEach(({message:a,details:o=""})=>{this.info({message:a,details:o},"error",this.opts.infoTimeout)}),r.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:r.length})})},Qr=function(e){const{missingFields:t,error:n}=m(this,Oe).getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:n.message}),this.log(n.message),this.emit("restriction-failed",e,n),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)},fd=function(e){let t=!0;for(const n of Object.values(e))R(this,M,Qr).call(this,n)||(t=!1);return t},Zr=function(e){const{allowNewUpload:t}=this.getState();if(t===!1){const n=new $e(this.i18n("noMoreFilesAllowed"),{file:e});throw R(this,M,Rt).call(this,[n]),n}},md=function(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,n=hd(t),i=im(n,t),r=ud(i).extension,a=Jf(t,this.getID()),o=t.meta||{};o.name=i,o.type=n;const c=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:a,name:i,extension:r||"",meta:{...this.getState().meta,...o},type:n,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:c,uploadComplete:!1,uploadStarted:null},size:c,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}},ea=function(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))},ta=function(e){let{files:t}=this.getState(),n={...t};const i=[],r=[];for(const a of e)try{let o=R(this,M,md).call(this,a);const c=t[o.id]?.isGhost;c&&(o={...t[o.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${o.name}, ${o.id}`));const d=this.opts.onBeforeFileAdded(o,n);if(t=this.getState().files,n={...t,...n},!d&&this.checkIfFileAlreadyExists(o.id))throw new $e(this.i18n("noDuplicates",{fileName:o.name??this.i18n("unnamed")}),{file:a});if(d===!1&&!c)throw new $e("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof d=="object"&&d!==null&&(o=d),m(this,Oe).validateSingleFile(o),n[o.id]=o,i.push(o)}catch(o){r.push(o)}try{m(this,Oe).validateAggregateRestrictions(Object.values(t),i)}catch(a){return r.push(a),{nextFilesState:t,validFilesToAdd:[],errors:r}}return{nextFilesState:n,validFilesToAdd:i,errors:r}},sa=function(){const{files:e}=this.getState();return Object.keys(e).filter(t=>{const n=e[t];return n.error&&(!n.missingRequiredMetaFields||n.missingRequiredMetaFields.length===0)})},na=async function(){const e=R(this,M,sa).call(this),t={...this.getState().files};if(e.forEach(i=>{t[i]={...t[i],isPaused:!1,error:null}}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};const n=R(this,M,Js).call(this,e,{forceAllowNewUpload:!0});return R(this,M,Qs).call(this,n)},Ri=new WeakMap,ia=function(){const e=R(this,M,gd).call(this);let t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})},Mt=new WeakMap,gd=function(){const t=this.getFiles().filter(c=>c.progress.uploadStarted||c.progress.preprocess||c.progress.postprocess);if(t.length===0)return 0;if(t.every(c=>c.progress.uploadComplete))return 1;const n=c=>c.progress.bytesTotal!=null&&c.progress.bytesTotal!==0,i=t.filter(n),r=t.filter(c=>!n(c));if(i.every(c=>c.progress.uploadComplete)&&r.length>0&&!r.every(c=>c.progress.uploadComplete))return null;const a=i.reduce((c,d)=>c+(d.progress.bytesTotal??0),0),o=i.reduce((c,d)=>c+(d.progress.bytesUploaded||0),0);return a===0?0:o/a},yd=function(){const e=(i,r,a)=>{let o=i.message||"Unknown error";i.details&&(o+=` ${i.details}`),this.setState({error:o}),r!=null&&r.id in this.getState().files&&this.setFileState(r.id,{error:o,response:a})};this.on("error",e),this.on("upload-error",(i,r,a)=>{if(e(r,i,a),typeof r=="object"&&r.message){this.log(r.message,"error");const o=new Error(this.i18n("failedToUpload",{file:i?.name??""}));o.isUserFacing=!0,o.details=r.message,r.details&&(o.details+=` ${r.details}`),R(this,M,Rt).call(this,[o])}else R(this,M,Rt).call(this,[r])});let t=null;this.on("upload-stalled",(i,r)=>{const{message:a}=i,o=r.map(c=>c.meta.name).join(", ");t||(this.info({message:a,details:o},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${a} ${o}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const n=i=>{const r=i.filter(o=>{const c=o!=null&&this.getFile(o.id);return c||this.log(`Not setting progress for a file that has been removed: ${o?.id}`),c}),a=Object.fromEntries(r.map(o=>[o.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:o.size}}]));this.patchFilesState(a)};this.on("upload-start",n),this.on("upload-progress",m(this,Ri)),this.on("upload-success",(i,r)=>{if(i==null||!this.getFile(i.id)){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}const a=this.getFile(i.id).progress;this.setFileState(i.id,{progress:{...a,postprocess:m(this,Ut).size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:a.bytesTotal},response:r,uploadURL:r.uploadURL,isPaused:!1}),i.size==null&&this.setFileState(i.id,{size:r.bytesUploaded||a.bytesTotal}),m(this,Mt).call(this)}),this.on("preprocess-progress",(i,r)=>{if(i==null||!this.getFile(i.id)){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}this.setFileState(i.id,{progress:{...this.getFile(i.id).progress,preprocess:r}})}),this.on("preprocess-complete",i=>{if(i==null||!this.getFile(i.id)){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}const r={...this.getState().files};r[i.id]={...r[i.id],progress:{...r[i.id].progress}},delete r[i.id].progress.preprocess,this.setState({files:r})}),this.on("postprocess-progress",(i,r)=>{if(i==null||!this.getFile(i.id)){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}this.setFileState(i.id,{progress:{...this.getState().files[i.id].progress,postprocess:r}})}),this.on("postprocess-complete",i=>{if(i==null||!this.getFile(i.id)){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}const r={...this.getState().files};r[i.id]={...r[i.id],progress:{...r[i.id].progress}},delete r[i.id].progress.postprocess,this.setState({files:r})}),this.on("restored",()=>{m(this,Mt).call(this)}),this.on("dashboard:file-edit-complete",i=>{i&&R(this,M,Qr).call(this,i)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",m(this,Et)),window.addEventListener("offline",m(this,Et)),setTimeout(m(this,Et),3e3))},Et=new WeakMap,_n=new WeakMap,Js=function(e,t={}){const{forceAllowNewUpload:n=!1}=t,{allowNewUpload:i,currentUploads:r}=this.getState();if(!i&&!n)throw new Error("Cannot create a new upload: already uploading.");const a=tm();return this.emit("upload",a,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...r,[a]:{fileIDs:e,step:0,result:{}}}}),a},vd=function(e){const{currentUploads:t}=this.getState();return t[e]},xi=function(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})},Qs=async function(e){const t=()=>{const{currentUploads:a}=this.getState();return a[e]};let n=t();const i=[...m(this,gs),...m(this,ys),...m(this,Ut)];try{for(let a=n.step||0;a<i.length&&n;a++){const o=i[a];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...n,step:a}}});const{fileIDs:c}=n;await o(c,e),n=t()}}catch(a){throw R(this,M,xi).call(this,e),a}if(n){n.fileIDs.forEach(d=>{const u=this.getFile(d);u?.progress.postprocess&&this.emit("postprocess-complete",u)});const a=n.fileIDs.map(d=>this.getFile(d)),o=a.filter(d=>!d.error),c=a.filter(d=>d.error);this.addResultData(e,{successful:o,failed:c,uploadID:e}),n=t()}let r;return n&&(r=n.result,R(this,M,xi).call(this,e)),r==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),r={successful:[],failed:[],uploadID:e}),r},w(Di,"VERSION",nm.version);let Jr=Di;var mm=0;function p(s,e,t,n,i,r){e||(e={});var a,o,c=e;if("ref"in c)for(o in c={},e)o=="ref"?a=e[o]:c[o]=e[o];var d={type:s,props:c,key:t,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--mm,__i:-1,__u:0,__source:i,__self:r};if(typeof s=="function"&&(a=s.defaultProps))for(o in a)c[o]===void 0&&(c[o]=a[o]);return z.vnode&&z.vnode(d),d}const gm="4.3.2",ym={version:gm},Xo=300;class vm extends we{constructor(){super(...arguments);w(this,"ref",_f())}componentWillEnter(t){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(t,Xo)}componentWillLeave(t){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(t,Xo)}render(){const{children:t}=this.props;return p("div",{className:"uppy-Informer-animated",ref:this.ref,children:t})}}function bm(s,e){return Object.assign(s,e)}function wm(s,e){return s?.key??e}function xm(s,e){const t=s._ptgLinkedRefs||(s._ptgLinkedRefs={});return t[e]||(t[e]=n=>{s.refs[e]=n})}function Gs(s){const e={};for(let t=0;t<s.length;t++)if(s[t]!=null){const n=wm(s[t],t.toString(36));e[n]=s[t]}return e}function Cm(s,e){s=s||{},e=e||{};const t=a=>Object.hasOwn(e,a)?e[a]:s[a],n={};let i=[];for(const a in s)Object.hasOwn(e,a)?i.length&&(n[a]=i,i=[]):i.push(a);const r={};for(const a in e){if(Object.hasOwn(n,a))for(let o=0;o<n[a].length;o++){const c=n[a][o];r[n[a][o]]=t(c)}r[a]=t(a)}for(let a=0;a<i.length;a++)r[i[a]]=t(i[a]);return r}const _m=s=>s;class bd extends we{constructor(e,t){super(e,t),this.refs={},this.state={children:Gs(ze(ze(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=Gs(ze(e.children)||[]),n=this.state.children;this.setState(r=>({children:Cm(r.children,t)}));let i;for(i in t)if(Object.hasOwn(t,i)){const r=n&&Object.hasOwn(n,i);t[i]&&r&&this.currentlyTransitioningKeys[i]?(this.keysToEnter.push(i),this.keysToAbortLeave.push(i)):t[i]&&!r&&!this.currentlyTransitioningKeys[i]&&this.keysToEnter.push(i)}for(i in n)if(Object.hasOwn(n,i)){const r=t&&Object.hasOwn(t,i);n[i]&&!r&&!this.currentlyTransitioningKeys[i]&&this.keysToLeave.push(i)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];t?.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=Gs(ze(this.props.children)||[]);(!n||!Object.hasOwn(n,e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];t?.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=Gs(ze(this.props.children)||[]);(!n||!Object.hasOwn(n,e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;const n=this.refs[e];n?.componentWillLeave?n.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;const n=this.refs[e];n?.componentDidLeave&&n.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const i=Gs(ze(this.props.children)||[]);if(i&&Object.hasOwn(i,e))this.performEnter(e);else{const r=bm({},this.state.children);delete r[e],this.setState({children:r})}}render({childFactory:e,transitionLeave:t,transitionName:n,transitionAppear:i,transitionEnter:r,transitionLeaveTimeout:a,transitionEnterTimeout:o,transitionAppearTimeout:c,component:d,...u},{children:h}){const v=Object.entries(h).map(([y,x])=>{if(!x)return;const _=xm(this,y);return sd(e(x),{ref:_,key:y})}).filter(Boolean);return mn(d,u,v)}}bd.defaultProps={component:"span",childFactory:_m};class wd extends Us{constructor(t,n){super(t,n);w(this,"render",t=>p("div",{className:"uppy uppy-Informer",children:p(bd,{children:t.info.map(n=>p(vm,{children:p("p",{role:"alert",children:[n.message," ",n.details&&p("span",{"aria-label":n.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${n.message} 

 ${n.details}`),children:"?"})]})},n.message))})}));this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}install(){const{target:t}=this.opts;t&&this.mount(t,this)}}w(wd,"VERSION",ym.version);var xd={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function t(){for(var r="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(r=i(r,n(o)))}return r}function n(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var a="";for(var o in r)e.call(r,o)&&r[o]&&(a=i(a,o));return a}function i(r,a){return a?r?r+" "+a:r+a:r}s.exports?(t.default=t,s.exports=t):window.classNames=t})()})(xd);var Sm=xd.exports;const We=$n(Sm),Em={position:"relative",width:"100%",minHeight:"100%"},Fm={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Pm extends we{constructor(t){super(t);w(this,"handleScroll",()=>{this.setState({offset:this.base.scrollTop})});w(this,"handleResize",()=>{this.resize()});this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement?.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}resize(){const{height:t}=this.state;t!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render({data:t,rowHeight:n,renderRow:i,overscanCount:r=10,...a}){const{offset:o,height:c}=this.state;let d=Math.floor(o/n),u=Math.floor(c/n);r&&(d=Math.max(0,d-d%r),u+=r);const h=d+u+4,v=t.slice(d,h),y={...Em,height:t.length*n},x={...Fm,top:d*n};return p("div",{onScroll:this.handleScroll,...a,children:p("div",{role:"presentation",style:y,children:p("div",{role:"presentation",style:x,children:v.map(i)})})})}}function Nm(){return p("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:p("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}function Yo(s,e,t,n){return s===e?s:n===0?e:s+(e-s)*2**(-n/t)}const km="4.2.3",Tm={version:km},Am={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}},et={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};function Rm(s){const e=Math.floor(s/3600)%24,t=Math.floor(s/60)%60,n=Math.floor(s%60);return{hours:e,minutes:t,seconds:n}}function Dm(s){const e=Rm(s),t=e.hours===0?"":`${e.hours}h`,n=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,i=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${n}${i}`}const jm="·",Jo=()=>` ${jm} `;function Om(s){const{newFiles:e,isUploadStarted:t,recoveredState:n,i18n:i,uploadState:r,isSomeGhost:a,startUpload:o}=s,c=We("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":r===et.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":a}),d=e&&t&&!n?i("uploadXNewFiles",{smart_count:e}):i("uploadXFiles",{smart_count:e});return p("button",{type:"button",className:c,"aria-label":i("uploadXFiles",{smart_count:e}),onClick:o,disabled:a,"data-uppy-super-focusable":!0,children:d})}function Um(s){const{i18n:e,uppy:t}=s;return p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:p("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function Mm(s){const{i18n:e,uppy:t}=s;return p("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:p("g",{fill:"none",fillRule:"evenodd",children:[p("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),p("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function Im(s){const{isAllPaused:e,i18n:t,isAllComplete:n,resumableUploads:i,uppy:r}=s,a=t(e?"resume":"pause");function o(){if(!n){if(!i){r.cancelAll();return}if(e){r.resumeAll();return}r.pauseAll()}}return p("button",{title:a,"aria-label":a,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:o,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:p("g",{fill:"none",fillRule:"evenodd",children:[p("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),p("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function Lm(s){const{i18n:e,doneButtonHandler:t}=s;return p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}function Cd(){return p("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:p("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function $m(s){const{progress:e}=s,{value:t,mode:n,message:i}=e;return p("div",{className:"uppy-StatusBar-content",children:[p(Cd,{}),n==="determinate"?`${Math.round(t*100)}% · `:"",i]})}function Bm(s){const{numUploads:e,complete:t,totalUploadedSize:n,totalSize:i,totalETA:r,i18n:a}=s,o=e>1,c=jt(n);return p("div",{className:"uppy-StatusBar-statusSecondary",children:[o&&a("filesUploadedOfTotal",{complete:t,smart_count:e}),p("span",{className:"uppy-StatusBar-additionalInfo",children:[o&&Jo(),i!=null?a("dataUploadedOfTotal",{complete:c,total:jt(i)}):a("dataUploadedOfUnknown",{complete:c}),Jo(),r!=null&&a("xTimeLeft",{time:Dm(r)})]})]})}function _d(s){const{i18n:e,complete:t,numUploads:n}=s;return p("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:n})})}function zm(s){const{i18n:e,newFiles:t,startUpload:n}=s,i=We("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return p("div",{className:"uppy-StatusBar-statusSecondary",children:[p("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),p("button",{type:"button",className:i,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:n,children:e("upload")})]})}function Hm(s){const{i18n:e,supportsUploadProgress:t,totalProgress:n,showProgressDetails:i,isUploadStarted:r,isAllComplete:a,isAllPaused:o,newFiles:c,numUploads:d,complete:u,totalUploadedSize:h,totalSize:v,totalETA:y,startUpload:x}=s,_=c&&r;if(!r||a)return null;const C=e(o?"paused":"uploading");function N(){return!o&&!_&&i?t?p(Bm,{numUploads:d,complete:u,totalUploadedSize:h,totalSize:v,totalETA:y,i18n:e}):p(_d,{i18n:e,complete:u,numUploads:d}):null}return p("div",{className:"uppy-StatusBar-content",title:C,children:[o?null:p(Cd,{}),p("div",{className:"uppy-StatusBar-status",children:[p("div",{className:"uppy-StatusBar-statusPrimary",children:t&&n!==0?`${C}: ${n}%`:C}),N(),_?p(zm,{i18n:e,newFiles:c,startUpload:x}):null]})]})}function qm(s){const{i18n:e}=s;return p("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:p("div",{className:"uppy-StatusBar-status",children:p("div",{className:"uppy-StatusBar-statusPrimary",children:[p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:p("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function Vm(s){const{error:e,i18n:t,complete:n,numUploads:i}=s;function r(){const a=`${t("uploadFailed")} 

 ${e}`;alert(a)}return p("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:p("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),p("div",{className:"uppy-StatusBar-status",children:[p("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),p("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:r,type:"button",children:"?"})]}),p(_d,{i18n:t,complete:n,numUploads:i})]})]})}function dr(s){const e=[];let t="indeterminate",n;for(const{progress:r}of Object.values(s)){const{preprocess:a,postprocess:o}=r;n==null&&(a||o)&&({mode:t,message:n}=a||o),a?.mode==="determinate"&&e.push(a.value),o?.mode==="determinate"&&e.push(o.value)}const i=e.reduce((r,a)=>r+a/e.length,0);return{mode:t,message:n,value:i}}const{STATE_ERROR:Qo,STATE_WAITING:Wm,STATE_PREPROCESSING:ur,STATE_UPLOADING:li,STATE_POSTPROCESSING:hr,STATE_COMPLETE:ci}=et;function Gm({newFiles:s,allowNewUpload:e,isUploadInProgress:t,isAllPaused:n,resumableUploads:i,error:r,hideUploadButton:a=void 0,hidePauseResumeButton:o=!1,hideCancelButton:c=!1,hideRetryButton:d=!1,recoveredState:u,uploadState:h,totalProgress:v,files:y,supportsUploadProgress:x,hideAfterFinish:_=!1,isSomeGhost:C,doneButtonHandler:N=void 0,isUploadStarted:f,i18n:b,startUpload:S,uppy:A,isAllComplete:k,showProgressDetails:P=void 0,numUploads:D,complete:U,totalSize:H,totalETA:I,totalUploadedSize:X}){function E(){switch(h){case hr:case ur:{const Q=dr(y);return Q.mode==="determinate"?Q.value*100:v}case Qo:return null;case li:return x?v:null;default:return v}}function q(){switch(h){case hr:case ur:{const{mode:Q}=dr(y);return Q==="indeterminate"}case li:return!x;default:return!1}}const W=E(),te=W??100,Z=!r&&s&&(!t&&!n||u)&&e&&!a,he=!c&&h!==Wm&&h!==ci,oe=i&&!o&&h===li,De=r&&!k&&!d,Ke=N&&h===ci,F=We("uppy-StatusBar-progress",{"is-indeterminate":q()}),L=We("uppy-StatusBar",`is-${h}`,{"has-ghosts":C}),$=(()=>{switch(h){case ur:case hr:return p($m,{progress:dr(y)});case ci:return p(qm,{i18n:b});case Qo:return p(Vm,{error:r,i18n:b,numUploads:D,complete:U});case li:return p(Hm,{i18n:b,supportsUploadProgress:x,totalProgress:v,showProgressDetails:P,isUploadStarted:f,isAllComplete:k,isAllPaused:n,newFiles:s,numUploads:D,complete:U,totalUploadedSize:X,totalSize:H,totalETA:I,startUpload:S});default:return null}})();return!(Z||De||oe||he||Ke)&&!$||h===ci&&_?null:p("div",{className:L,children:[p("div",{className:F,style:{width:`${te}%`},role:"progressbar","aria-label":`${te}%`,"aria-valuetext":`${te}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":W}),$,p("div",{className:"uppy-StatusBar-actions",children:[Z?p(Om,{newFiles:s,isUploadStarted:f,recoveredState:u,i18n:b,isSomeGhost:C,startUpload:S,uploadState:h}):null,De?p(Um,{i18n:b,uppy:A}):null,oe?p(Im,{isAllPaused:n,i18n:b,isAllComplete:k,resumableUploads:i,uppy:A}):null,he?p(Mm,{i18n:b,uppy:A}):null,Ke?p(Lm,{i18n:b,doneButtonHandler:N}):null]})]})}const Km=2e3,Xm=2e3;function Ym(s,e,t,n){if(s)return et.STATE_ERROR;if(e)return et.STATE_COMPLETE;if(t)return et.STATE_WAITING;let i=et.STATE_WAITING;const r=Object.keys(n);for(let a=0;a<r.length;a++){const{progress:o}=n[r[a]];if(o.uploadStarted&&!o.uploadComplete)return et.STATE_UPLOADING;o.preprocess&&(i=et.STATE_PREPROCESSING),o.postprocess&&i!==et.STATE_PREPROCESSING&&(i=et.STATE_POSTPROCESSING)}return i}const Jm={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var xr,Ft,Pt,It,ut,ji,Sd,Sn;let Qm=(xr=class extends Us{constructor(t,n){super(t,{...Jm,...n});T(this,ji);T(this,Ft);T(this,Pt);T(this,It);T(this,ut);w(this,"startUpload",()=>this.uppy.upload().catch(()=>{}));T(this,Sn,()=>{const{recoveredState:t}=this.uppy.getState();if(j(this,It,null),j(this,ut,null),t){j(this,Pt,Object.values(t.files).reduce((n,{progress:i})=>n+i.bytesUploaded,0)),this.uppy.emit("restore-confirmed");return}j(this,Ft,performance.now()),j(this,Pt,0)});this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=Am,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(t){const{capabilities:n,files:i,allowNewUpload:r,totalProgress:a,error:o,recoveredState:c}=t,{newFiles:d,startedFiles:u,completeFiles:h,isUploadStarted:v,isAllComplete:y,isAllPaused:x,isUploadInProgress:_,isSomeGhost:C}=this.uppy.getObjectOfFilesPerState(),N=c?Object.values(i):d,f=!!n.resumableUploads,b=n.uploadProgress!==!1;let S=null,A=0;u.every(P=>P.progress.bytesTotal!=null&&P.progress.bytesTotal!==0)?(S=0,u.forEach(P=>{S+=P.progress.bytesTotal||0,A+=P.progress.bytesUploaded||0})):u.forEach(P=>{A+=P.progress.bytesUploaded||0});const k=R(this,ji,Sd).call(this,{uploaded:A,total:S});return Gm({error:o,uploadState:Ym(o,y,c,t.files||{}),allowNewUpload:r,totalProgress:a,totalSize:S,totalUploadedSize:A,isAllComplete:!1,isAllPaused:x,isUploadStarted:v,isUploadInProgress:_,isSomeGhost:C,recoveredState:c,complete:h.length,newFiles:N.length,numUploads:u.length,totalETA:k,files:i,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:f,supportsUploadProgress:b,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const t=this.el;qc(t)||(t.dir="ltr")}install(){const{target:t}=this.opts;t&&this.mount(t,this),this.uppy.on("upload",m(this,Sn)),j(this,Ft,performance.now()),j(this,Pt,this.uppy.getFiles().reduce((n,i)=>n+i.progress.bytesUploaded,0))}uninstall(){this.unmount(),this.uppy.off("upload",m(this,Sn))}},Ft=new WeakMap,Pt=new WeakMap,It=new WeakMap,ut=new WeakMap,ji=new WeakSet,Sd=function(t){if(t.total==null||t.total===0)return null;const n=t.total-t.uploaded;if(n<=0)return null;m(this,Ft)??j(this,Ft,performance.now());const i=performance.now()-m(this,Ft);if(i===0)return Math.round((m(this,ut)??0)/100)/10;const r=t.uploaded-m(this,Pt);if(j(this,Pt,t.uploaded),r<=0)return Math.round((m(this,ut)??0)/100)/10;const a=r/i,o=m(this,It)==null?a:Yo(a,m(this,It),Km,i);j(this,It,o);const c=n/o,d=Math.max(m(this,ut)-i,0),u=m(this,ut)==null?c:Yo(c,d,Xm,i);return j(this,ut,u),j(this,Ft,performance.now()),Math.round(u/100)/10},Sn=new WeakMap,w(xr,"VERSION",Tm.version),xr);const Zm=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function eg(s,e,t){const n=Zm.exec(s),i=e.mimeType??n?.[1]??"plain/text";let r;if(n?.[2]!=null){const a=atob(decodeURIComponent(n[3])),o=new Uint8Array(a.length);for(let c=0;c<a.length;c++)o[c]=a.charCodeAt(c);r=[o]}else n?.[3]!=null&&(r=[decodeURIComponent(n[3])]);return new Blob(r,{type:i})}function Zo(s){return s.startsWith("blob:")}function el(s){return s?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(s):!1}function Y(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var Ed=typeof self<"u"?self:global;const vn=typeof navigator<"u",tg=vn&&typeof HTMLImageElement>"u",tl=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Fd=Ed.Buffer,Pd=!!Fd,sg=s=>s!==void 0;function Nd(s){return s===void 0||(s instanceof Map?s.size===0:Object.values(s).filter(sg).length===0)}function de(s){let e=new Error(s);throw delete e.stack,e}function sl(s){let e=function(t){let n=0;return t.ifd0.enabled&&(n+=1024),t.exif.enabled&&(n+=2048),t.makerNote&&(n+=2048),t.userComment&&(n+=1024),t.gps.enabled&&(n+=512),t.interop.enabled&&(n+=100),t.ifd1.enabled&&(n+=1024),n+2048}(s);return s.jfif.enabled&&(e+=50),s.xmp.enabled&&(e+=2e4),s.iptc.enabled&&(e+=14e3),s.icc.enabled&&(e+=6e3),e}const pr=s=>String.fromCharCode.apply(null,s),nl=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;class He{static from(e,t){return e instanceof this&&e.le===t?e:new He(e,void 0,void 0,t)}constructor(e,t=0,n,i){if(typeof i=="boolean"&&(this.le=i),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){n===void 0&&(n=e.byteLength-t);let r=new DataView(e,t,n);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof He){n===void 0&&(n=e.byteLength-t),(t+=e.byteOffset)+n>e.byteOffset+e.byteLength&&de("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,n);this._swapDataView(r)}else if(typeof e=="number"){let r=new DataView(new ArrayBuffer(e));this._swapDataView(r)}else de("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,n=He){return e instanceof DataView||e instanceof He?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||de("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new n(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new He(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return i=this.getUint8Array(e,t),nl?nl.decode(i):Pd?Buffer.from(i).toString("utf8"):decodeURIComponent(escape(pr(i)));var i}getLatin1String(e=0,t=this.byteLength){let n=this.getUint8Array(e,t);return pr(n)}getUnicodeString(e=0,t=this.byteLength){const n=[];for(let i=0;i<t&&e+i<this.byteLength;i+=2)n.push(this.getUint16(e+i));return pr(n)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}getUint(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function ra(s,e){de(`${s} '${e}' was not loaded, try using full build of exifr.`)}class Ma extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||ra(this.kind,e),t&&(e in t||function(n,i){de(`Unknown ${n} '${i}'.`)}(this.kind,e),t[e].enabled||ra(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var kd=new Ma("file parser"),Be=new Ma("segment parser"),Ia=new Ma("file reader");let ng=Ed.fetch;function il(s,e){return(t=s).startsWith("data:")||t.length>1e4?oa(s,e,"base64"):tl&&s.includes("://")?aa(s,e,"url",rl):tl?oa(s,e,"fs"):vn?aa(s,e,"url",rl):void de("Invalid input argument");var t}async function aa(s,e,t,n){return Ia.has(t)?oa(s,e,t):n?async function(i,r){let a=await r(i);return new He(a)}(s,n):void de(`Parser ${t} is not loaded`)}async function oa(s,e,t){let n=new(Ia.get(t))(s,e);return await n.read(),n}const rl=s=>ng(s).then(e=>e.arrayBuffer()),la=s=>new Promise((e,t)=>{let n=new FileReader;n.onloadend=()=>e(n.result||new ArrayBuffer),n.onerror=t,n.readAsArrayBuffer(s)}),La=new Map,ig=new Map,rg=new Map,di=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Td=["jfif","xmp","icc","iptc","ihdr"],ca=["tiff",...Td],le=["ifd0","ifd1","exif","gps","interop"],ui=[...ca,...le],hi=["makerNote","userComment"],Ad=["translateKeys","translateValues","reviveValues","multiSegment"],pi=[...Ad,"sanitize","mergeOutput","silentErrors"];class Rd{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Ks extends Rd{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,n,i){if(super(),Y(this,"enabled",!1),Y(this,"skip",new Set),Y(this,"pick",new Set),Y(this,"deps",new Set),Y(this,"translateKeys",!1),Y(this,"translateValues",!1),Y(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(i),this.canBeFiltered=le.includes(e),this.canBeFiltered&&(this.dict=La.get(e)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:r,skip:a}=n;r&&r.length>0&&this.translateTagSet(r,this.pick),a&&a.length>0&&this.translateTagSet(a,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:de(`Invalid options argument: ${n}`)}applyInheritables(e){let t,n;for(t of Ad)n=e[t],n!==void 0&&(this[t]=n)}translateTagSet(e,t){if(this.dict){let n,i,{tagKeys:r,tagValues:a}=this.dict;for(n of e)typeof n=="string"?(i=a.indexOf(n),i===-1&&(i=r.indexOf(Number(n))),i!==-1&&t.add(Number(r[i]))):t.add(n)}else for(let n of e)t.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ki(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ki(this.pick,this.deps)}}var ye={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},al=new Map;class $a extends Rd{static useCached(e){let t=al.get(e);return t!==void 0||(t=new this(e),al.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):de(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=vn?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of di)this[e]=ye[e];for(e of pi)this[e]=ye[e];for(e of hi)this[e]=ye[e];for(e of ui)this[e]=new Ks(e,ye[e],void 0,this)}setupFromTrue(){let e;for(e of di)this[e]=ye[e];for(e of pi)this[e]=ye[e];for(e of hi)this[e]=!0;for(e of ui)this[e]=new Ks(e,!0,void 0,this)}setupFromArray(e){let t;for(t of di)this[t]=ye[t];for(t of pi)this[t]=ye[t];for(t of hi)this[t]=ye[t];for(t of ui)this[t]=new Ks(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,le)}setupFromObject(e){let t;for(t of(le.ifd0=le.ifd0||le.image,le.ifd1=le.ifd1||le.thumbnail,Object.assign(this,e),di))this[t]=fr(e[t],ye[t]);for(t of pi)this[t]=fr(e[t],ye[t]);for(t of hi)this[t]=fr(e[t],ye[t]);for(t of ca)this[t]=new Ks(t,ye[t],e[t],this);for(t of le)this[t]=new Ks(t,ye[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,le,ui),e.tiff===!0?this.batchEnableWithBool(le,!0):e.tiff===!1?this.batchEnableWithUserValue(le,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,le):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,le)}batchEnableWithBool(e,t){for(let n of e)this[n].enabled=t}batchEnableWithUserValue(e,t){for(let n of e){let i=t[n];this[n].enabled=i!==!1&&i!==void 0}}setupGlobalFilters(e,t,n,i=n){if(e&&e.length){for(let a of i)this[a].enabled=!1;let r=ol(e,n);for(let[a,o]of r)ki(this[a].pick,o),this[a].enabled=!0}else if(t&&t.length){let r=ol(t,n);for(let[a,o]of r)ki(this[a].skip,o)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:n,iptc:i,icc:r}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),n.enabled||e.skip.add(700),i.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:n,interop:i}=this;i.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),n.needed&&e.deps.add(34853),this.tiff.enabled=le.some(r=>this[r].enabled===!0)||this.makerNote||this.userComment;for(let r of le)this[r].finalizeFilters()}get onlyTiff(){return!Td.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of ca)this[e].enabled&&!Be.has(e)&&ra("segment parser",e)}}function ol(s,e){let t,n,i,r,a=[];for(i of e){for(r of(t=La.get(i),n=[],t))(s.includes(r[0])||s.includes(r[1]))&&n.push(r[0]);n.length&&a.push([i,n])}return a}function fr(s,e){return s!==void 0?s:e!==void 0?e:void 0}function ki(s,e){for(let t of e)s.add(t)}Y($a,"default",ye);class ag{constructor(e){Y(this,"parsers",{}),Y(this,"output",{}),Y(this,"errors",[]),Y(this,"pushToErrors",t=>this.errors.push(t)),this.options=$a.useCached(e)}async read(e){this.file=await function(t,n){return typeof t=="string"?il(t,n):vn&&!tg&&t instanceof HTMLImageElement?il(t.src,n):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new He(t):vn&&t instanceof Blob?aa(t,n,"blob",la):void de("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[n,i]of kd)if(i.canHandle(e,t))return this.fileParser=new i(this.options,this.file,this.parsers),e[n]=!0;this.file.close&&this.file.close(),de("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Nd(n=e)?void 0:n;var n}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async n=>{let i=await n.parse();n.assignToOutput(e,i)});this.options.silentErrors&&(t=t.map(n=>n.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,n=Be.get("tiff",e);var i;if(t.tiff?i={start:0,type:"tiff"}:t.jpeg&&(i=await this.fileParser.getOrFindSegment("tiff")),i===void 0)return;let r=await this.fileParser.ensureSegmentChunk(i),a=this.parsers.tiff=new n(r,e,t),o=await a.extractThumbnail();return t.close&&t.close(),o}}class us{static findPosition(e,t){let n=e.getUint16(t+2)+2,i=typeof this.headerLength=="function"?this.headerLength(e,t,n):this.headerLength,r=t+i,a=n-i;return{offset:t,length:n,headerLength:i,start:r,size:a,end:r+a}}static parse(e,t={}){return new this(e,new $a({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof He?e:new He(e)}constructor(e,t={},n){Y(this,"errors",[]),Y(this,"raw",new Map),Y(this,"handleError",i=>{if(!this.options.silentErrors)throw i;this.errors.push(i.message)}),this.chunk=this.normalizeInput(e),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let n=rg.get(t),i=ig.get(t),r=La.get(t),a=this.options[t],o=a.reviveValues&&!!n,c=a.translateValues&&!!i,d=a.translateKeys&&!!r,u={};for(let[h,v]of e)o&&n.has(h)?v=n.get(h)(v):c&&i.has(h)&&(v=this.translateValue(v,i.get(h))),d&&r.has(h)&&(h=r.get(h)||h),u[h]=v;return u}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,n){if(this.globalOptions.mergeOutput)return Object.assign(e,n);e[t]?Object.assign(e[t],n):e[t]=n}}Y(us,"headerLength",4),Y(us,"type",void 0),Y(us,"multiSegment",!1),Y(us,"canHandle",()=>!1);function og(s){return s===192||s===194||s===196||s===219||s===221||s===218||s===254}function lg(s){return s>=224&&s<=239}function cg(s,e,t){for(let[n,i]of Be)if(i.canHandle(s,e,t))return n}class ll extends class{constructor(e,t,n){Y(this,"errors",[]),Y(this,"ensureSegmentChunk",async i=>{let r=i.start,a=i.size||65536;if(this.file.chunked)if(this.file.available(r,a))i.chunk=this.file.subarray(r,a);else try{i.chunk=await this.file.readChunk(r,a)}catch(o){de(`Couldn't read segment: ${JSON.stringify(i)}. ${o.message}`)}else this.file.byteLength>r+a?i.chunk=this.file.subarray(r,a):i.size===void 0?i.chunk=this.file.subarray(r):de("Segment unreachable: "+JSON.stringify(i));return i.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=n}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let n=new(Be.get(e))(t,this.options,this.file);return this.parsers[e]=n}createParsers(e){for(let t of e){let{type:n,chunk:i}=t,r=this.options[n];if(r&&r.enabled){let a=this.parsers[n];a&&a.append||a||this.createParser(n,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),Y(this,"appSegments",[]),Y(this,"jpegSegments",[]),Y(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(Be.keyList())):(e=e===void 0?Be.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&Be.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:n,findAll:i,wanted:r,remaining:a}=this;if(!i&&this.file.chunked&&(i=Array.from(r).some(o=>{let c=Be.get(o),d=this.options[o];return c.multiSegment&&d.multiSegment}),i&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,n.byteLength),!this.options.onlyTiff&&n.chunked){let o=!1;for(;a.size>0&&!o&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:c}=n,d=this.appSegments.some(u=>!this.file.available(u.offset||u.start,u.length||u.size));if(o=e>c&&!d?!await n.readNextChunk(e):!await n.readNextChunk(c),(e=this.findAppSegmentsInRange(e,n.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let n,i,r,a,o,c,{file:d,findAll:u,wanted:h,remaining:v,options:y}=this;for(;e<t;e++)if(d.getUint8(e)===255){if(n=d.getUint8(e+1),lg(n)){if(i=d.getUint16(e+2),r=cg(d,e,i),r&&h.has(r)&&(a=Be.get(r),o=a.findPosition(d,e),c=y[r],o.type=r,this.appSegments.push(o),!u&&(a.multiSegment&&c.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||v.delete(r)):v.delete(r),v.size===0)))break;y.recordUnknownSegments&&(o=us.findPosition(d,e),o.marker=n,this.unknownSegments.push(o)),e+=i+1}else if(og(n)){if(i=d.getUint16(e+2),n===218&&y.stopAfterSos!==!1)return;y.recordJpegSegments&&this.jpegSegments.push({offset:e,length:i,marker:n}),e+=i+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,n){let i,r,a,o=new Map;for(let c=0;c<t.length;c++)i=t[c],r=i[n],o.has(r)?a=o.get(r):o.set(r,a=[]),a.push(i);return Array.from(o)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,n])=>{let i=Be.get(t,this.options);return i.handleMultiSegments?{type:t,chunk:i.handleMultiSegments(n)}:n[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}Y(ll,"type","jpeg"),kd.set("jpeg",ll);const dg=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ug extends us{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,n=new Map){let{pick:i,skip:r}=this.options[t];i=new Set(i);let a=i.size>0,o=r.size===0,c=this.chunk.getUint16(e);e+=2;for(let d=0;d<c;d++){let u=this.chunk.getUint16(e);if(a){if(i.has(u)&&(n.set(u,this.parseTag(e,u,t)),i.delete(u),i.size===0))break}else!o&&r.has(u)||n.set(u,this.parseTag(e,u,t));e+=12}return n}parseTag(e,t,n){let{chunk:i}=this,r=i.getUint16(e+2),a=i.getUint32(e+4),o=dg[r];if(o*a<=4?e+=8:e=i.getUint32(e+8),(r<1||r>13)&&de(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>i.byteLength&&de(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${i.byteLength}`),r===1)return i.getUint8Array(e,a);if(r===2)return(c=function(d){for(;d.endsWith("\0");)d=d.slice(0,-1);return d}(c=i.getString(e,a)).trim())===""?void 0:c;var c;if(r===7)return i.getUint8Array(e,a);if(a===1)return this.parseTagValue(r,e);{let d=new(function(h){switch(h){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(r))(a),u=o;for(let h=0;h<a;h++)d[h]=this.parseTagValue(r,e),e+=u;return d}}parseTagValue(e,t){let{chunk:n}=this;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:de(`Invalid tiff type ${e}`)}}}class mr extends ug{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let n=new Map;return this[t]=n,this.parseTags(e,t,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&de("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&de(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,sl(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,sl(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let n=e.get(t);n&&n.length===1&&e.set(t,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",cl(...e.get(2),e.get(1))),e.set("longitude",cl(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,n,i={};for(t of le)if(e=this[t],!Nd(e))if(n=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(i,n)}else i[t]=n;return this.makerNote&&(i.makerNote=this.makerNote),this.userComment&&(i.userComment=this.userComment),i}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[n,i]of Object.entries(t))this.assignObjectToOutput(e,n,i)}}function cl(s,e,t,n){var i=s+e/60+t/3600;return n!=="S"&&n!=="W"||(i*=-1),i}Y(mr,"type","tiff"),Y(mr,"headerLength",10),Be.set("tiff",mr);const Ba={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},Ba,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},Ba,{tiff:!1,ifd1:!0,mergeOutput:!1});const hg=Object.assign({},Ba,{firstChunkSize:4e4,ifd0:[274]});async function pg(s){let e=new ag(hg);await e.read(s);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const fg=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Zs=!0,en=!0;if(typeof navigator=="object"){let s=navigator.userAgent;if(s.includes("iPad")||s.includes("iPhone")){let e=s.match(/OS (\d+)_(\d+)/);if(e){let[,t,n]=e;Zs=Number(t)+.1*Number(n)<13.4,en=!1}}else if(s.includes("OS X 10")){let[,e]=s.match(/OS X 10[_.](\d+)/);Zs=en=Number(e)<15}if(s.includes("Chrome/")){let[,e]=s.match(/Chrome\/(\d+)/);Zs=en=Number(e)<81}else if(s.includes("Firefox/")){let[,e]=s.match(/Firefox\/(\d+)/);Zs=en=Number(e)<77}}async function mg(s){let e=await pg(s);return Object.assign({canvas:Zs,css:en},fg[e])}class gg extends He{constructor(...e){super(...e),Y(this,"ranges",new yg),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,n){if(e===0&&this.byteLength===0&&n){let i=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(i)}else{let i=e+t;if(i>this.byteLength){let{dataView:r}=this._extend(i);this._swapDataView(r)}}}_extend(e){let t;t=Pd?Fd.allocUnsafe(e):new Uint8Array(e);let n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}subarray(e,t,n=!1){return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,n=!1){n&&this._tryExtend(t,e.byteLength,e);let i=super.set(e,t);return this.ranges.add(t,i.byteLength),i}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class yg{constructor(){Y(this,"list",[])}get length(){return this.list.length}add(e,t,n=0){let i=e+t,r=this.list.filter(a=>dl(e,a.offset,i)||dl(e,a.end,i));if(r.length>0){e=Math.min(e,...r.map(o=>o.offset)),i=Math.max(i,...r.map(o=>o.end)),t=i-e;let a=r.shift();a.offset=e,a.length=t,a.end=i,this.list=this.list.filter(o=>!r.includes(o))}else this.list.push({offset:e,length:t,end:i})}available(e,t){let n=e+t;return this.list.some(i=>i.offset<=e&&n<=i.end)}}function dl(s,e,t){return s<=e&&e<=t}class vg extends gg{constructor(e,t){super(0),Y(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,n=await this.readChunk(e,t);return!!n&&n.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Ia.set("blob",class extends vg{async readWhole(){this.chunked=!1;let s=await la(this.input);this._swapArrayBuffer(s)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(s,e){let t=e?s+e:void 0,n=this.input.slice(s,t),i=await la(n);return this.set(i,s,!0)}});const bg="4.2.3",wg={version:bg},xg={strings:{generatingThumbnails:"Generating thumbnails..."}};function Cg(s,e,t){try{s.getContext("2d").getImageData(0,0,1,1)}catch(n){if(n.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return s.toBlob?new Promise(n=>{s.toBlob(n,e,t)}).then(n=>{if(n===null)throw new Error("cannot read image, probably an svg with external resources");return n}):Promise.resolve().then(()=>eg(s.toDataURL(e,t),{})).then(n=>{if(n===null)throw new Error("could not extract blob, probably an old browser");return n})}function _g(s,e){let t=s.width,n=s.height;(e.deg===90||e.deg===270)&&(t=s.height,n=s.width);const i=document.createElement("canvas");i.width=t,i.height=n;const r=i.getContext("2d");return r.translate(t/2,n/2),e.canvas&&(r.rotate(e.rad),r.scale(e.scaleX,e.scaleY)),r.drawImage(s,-s.width/2,-s.height/2,s.width,s.height),i}function Sg(s){const e=s.width/s.height,t=5e6,n=4096;let i=Math.floor(Math.sqrt(t*e)),r=Math.floor(t/Math.sqrt(t*e));if(i>n&&(i=n,r=Math.round(i/e)),r>n&&(r=n,i=Math.round(e*r)),s.width>i){const a=document.createElement("canvas");return a.width=i,a.height=r,a.getContext("2d").drawImage(s,0,0,i,r),a}return s}const Eg={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class Dd extends Us{constructor(t,n){super(t,{...Eg,...n});w(this,"queue");w(this,"queueProcessing");w(this,"defaultThumbnailDimension");w(this,"thumbnailType");w(this,"onFileAdded",t=>{!t.preview&&t.data&&el(t.type)&&!t.isRemote&&this.addToQueue(t.id)});w(this,"onCancelRequest",t=>{const n=this.queue.indexOf(t.id);n!==-1&&this.queue.splice(n,1)});w(this,"onFileRemoved",t=>{const n=this.queue.indexOf(t.id);n!==-1&&this.queue.splice(n,1),t.preview&&Zo(t.preview)&&URL.revokeObjectURL(t.preview)});w(this,"onRestored",()=>{this.uppy.getFiles().filter(n=>n.isRestored).forEach(n=>{(!n.preview||Zo(n.preview))&&this.addToQueue(n.id)})});w(this,"onAllFilesRemoved",()=>{this.queue=[]});w(this,"waitUntilAllProcessed",t=>{t.forEach(i=>{const r=this.uppy.getFile(i);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});const n=()=>{t.forEach(i=>{const r=this.uppy.getFile(i);this.uppy.emit("preprocess-complete",r)})};return new Promise(i=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{n(),i()}):(n(),i())})});if(this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=xg,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(t,n,i){const r=URL.createObjectURL(t.data),a=new Promise((c,d)=>{const u=new Image;u.src=r,u.addEventListener("load",()=>{URL.revokeObjectURL(r),c(u)}),u.addEventListener("error",h=>{URL.revokeObjectURL(r),d(h.error||new Error("Could not create thumbnail"))})}),o=mg(t.data).catch(()=>1);return Promise.all([a,o]).then(([c,d])=>{const u=this.getProportionalDimensions(c,n,i,d.deg),h=_g(c,d),v=this.resizeImage(h,u.width,u.height);return Cg(v,this.thumbnailType,80)}).then(c=>URL.createObjectURL(c))}getProportionalDimensions(t,n,i,r){let a=t.width/t.height;if((r===90||r===270)&&(a=t.height/t.width),n!=null){let o=n;return t.width<n&&(o=t.width),{width:o,height:Math.round(o/a)}}if(i!=null){let o=i;return t.height<i&&(o=t.height),{width:Math.round(o*a),height:o}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/a)}}resizeImage(t,n,i){let r=Sg(t),a=Math.ceil(Math.log2(r.width/n));a<1&&(a=1);let o=n*2**(a-1),c=i*2**(a-1);const d=2;for(;a--;){const u=document.createElement("canvas");u.width=o,u.height=c,u.getContext("2d").drawImage(r,0,0,o,c),r=u,o=Math.round(o/d),c=Math.round(c/d)}return r}setPreviewURL(t,n){this.uppy.setFileState(t,{preview:n})}addToQueue(t){this.queue.push(t),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const t=this.uppy.getFile(this.queue.shift());return t?this.requestThumbnail(t).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(t){return el(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(n=>{this.setPreviewURL(t.id,n),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${t.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(t.id),n)}).catch(n=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${t.id}:`,"warning"),this.uppy.log(n,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(t.id),n)}):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}w(Dd,"VERSION",wg.version);function ul(s){if(typeof s=="string"){const e=document.querySelectorAll(s);return e.length===0?null:Array.from(e)}return typeof s=="object"&&Hc(s)?[s]:null}const cn=Array.from;function Fg(s){const e=cn(s.files);return Promise.resolve(e)}function jd(s,e,t,{onSuccess:n}){s.readEntries(i=>{const r=[...e,...i];i.length?queueMicrotask(()=>{jd(s,r,t,{onSuccess:n})}):n(r)},i=>{t(i),n(e)})}function Od(s,e){return s==null?s:{kind:s.isFile?"file":s.isDirectory?"directory":void 0,name:s.name,getFile(){return new Promise((t,n)=>s.file(t,n))},async*values(){const t=s.createReader();yield*await new Promise(i=>{jd(t,[],e,{onSuccess:r=>i(r.map(a=>Od(a,e)))})})},isSameEntry:void 0}}async function*Ud(s,e,t=void 0){const n=()=>`${e}/${s.name}`;if(s.kind==="file"){const i=await s.getFile();i!=null?(i.relativePath=e?n():null,yield i):t!=null&&(yield t)}else if(s.kind==="directory")for await(const i of s.values())yield*Ud(i,e?n():s.name);else t!=null&&(yield t)}async function*Pg(s,e){const t=await Promise.all(Array.from(s.items,async n=>{let i;return i??(i=Od(typeof n.getAsEntry=="function"?n.getAsEntry():n.webkitGetAsEntry(),e)),{fileSystemHandle:i,lastResortFile:n.getAsFile()}}));for(const{lastResortFile:n,fileSystemHandle:i}of t)if(i!=null)try{yield*Ud(i,"",n)}catch(r){n!=null?yield n:e(r)}else n!=null&&(yield n)}async function Ng(s,e){const t=e?.logDropError??Function.prototype;try{const n=[];for await(const i of Pg(s,t))n.push(i);return n}catch{return Fg(s)}}let kg="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Md=(s=21)=>{let e="",t=s|0;for(;t--;)e+=kg[Math.random()*64|0];return e};const Tg="4.4.3",Ag={version:Tg};function Rg(){const s=document.body;return!(!("draggable"in s)||!("ondragstart"in s&&"ondrop"in s)||!("FormData"in window)||!("FileReader"in window))}class Id extends we{constructor(){super(...arguments);w(this,"fileInput",null);w(this,"folderInput",null);w(this,"mobilePhotoFileInput",null);w(this,"mobileVideoFileInput",null);w(this,"triggerFileInputClick",()=>{this.fileInput?.click()});w(this,"triggerFolderInputClick",()=>{this.folderInput?.click()});w(this,"triggerVideoCameraInputClick",()=>{this.mobileVideoFileInput?.click()});w(this,"triggerPhotoCameraInputClick",()=>{this.mobilePhotoFileInput?.click()});w(this,"onFileInputChange",t=>{this.props.handleInputChange(t),t.currentTarget.value=""});w(this,"renderHiddenInput",(t,n)=>p("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:t,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:n}));w(this,"renderHiddenCameraInput",(t,n,i)=>{const a={photo:"image/*",video:"video/*"}[t];return p("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${t}`,onChange:this.onFileInputChange,capture:n===""?"environment":n,accept:a,ref:i})});w(this,"renderMyDeviceAcquirer",()=>p("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[p("div",{className:"uppy-DashboardTab-inner",children:p("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:p("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),p("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})}));w(this,"renderPhotoCamera",()=>p("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[p("div",{className:"uppy-DashboardTab-inner",children:p("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:p("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),p("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})}));w(this,"renderVideoCamera",()=>p("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[p("div",{className:"uppy-DashboardTab-inner",children:p("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:p("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),p("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})}));w(this,"renderBrowseButton",(t,n)=>{const i=this.props.acquirers.length;return p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:n,"data-uppy-super-focusable":i===0,children:t})});w(this,"renderDropPasteBrowseTagline",t=>{const n=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),i=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,a=r.charAt(0).toUpperCase()+r.slice(1);return p("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):t>0?this.props.i18nArray(`dropPasteImport${a}`,{browseFiles:n,browseFolders:i,browse:n}):this.props.i18nArray(`dropPaste${a}`,{browseFiles:n,browseFolders:i,browse:n})})});w(this,"renderAcquirer",t=>p("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":t.id,children:p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":t.id,"aria-controls":`uppy-DashboardContent-panel--${t.id}`,"aria-selected":this.props.activePickerPanel?.id===t.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(t.id),children:[p("div",{className:"uppy-DashboardTab-inner",children:t.icon()}),p("div",{className:"uppy-DashboardTab-name",children:t.name})]})}));w(this,"renderAcquirers",t=>{const n=[...t],i=n.splice(t.length-2,t.length);return p(qe,{children:[n.map(r=>this.renderAcquirer(r)),p("span",{role:"presentation",style:{"white-space":"nowrap"},children:i.map(r=>this.renderAcquirer(r))})]})});w(this,"renderSourcesList",(t,n)=>{const{showNativePhotoCameraButton:i,showNativeVideoCameraButton:r}=this.props;let a=[];const o="myDevice";n||a.push({key:o,elements:this.renderMyDeviceAcquirer()}),i&&a.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&a.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),a.push(...t.map(h=>({key:h.id,elements:this.renderAcquirer(h)}))),a.length===1&&a[0].key===o&&(a=[]);const d=[...a],u=d.splice(a.length-2,a.length);return p(qe,{children:[this.renderDropPasteBrowseTagline(a.length),p("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[d.map(({key:h,elements:v})=>p(qe,{children:v},h)),p("span",{role:"presentation",style:{"white-space":"nowrap"},children:u.map(({key:h,elements:v})=>p(qe,{children:v},h))})]})]})})}[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderPoweredByUppy(){const{i18nArray:t}=this.props,n=p("span",{children:[p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:p("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),p("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),i=t("poweredBy",{uppy:n});return p("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:i})}render(){const{showNativePhotoCameraButton:t,showNativeVideoCameraButton:n,nativeCameraFacingMode:i}=this.props;return p("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),t&&this.renderHiddenCameraInput("photo",i,r=>{this.mobilePhotoFileInput=r}),n&&this.renderHiddenCameraInput("video",i,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),p("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&p("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}}const Dg=s=>p("div",{className:We("uppy-Dashboard-AddFilesPanel",s.className),"data-uppy-panelType":"AddFiles","aria-hidden":!s.showAddFilesPanel,children:[p("div",{className:"uppy-DashboardContent-bar",children:[p("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:s.i18n("addingMoreFiles")}),p("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>s.toggleAddFilesPanel(!1),children:s.i18n("back")})]}),p(Id,{...s})]});function jg(s){const e=s.files[s.fileCardFor],t=()=>{s.uppy.emit("file-editor:cancel",e),s.closeFileEditor()};return p("div",{className:We("uppy-DashboardContent-panel",s.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[p("div",{className:"uppy-DashboardContent-bar",children:[p("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:s.i18nArray("editing",{file:p("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),p("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:s.i18n("cancel")}),p("button",{className:"uppy-DashboardContent-save",type:"button",onClick:s.saveFileEditor,children:s.i18n("save")})]}),p("div",{className:"uppy-DashboardContent-panelBody",children:s.editors.map(n=>s.uppy.getPlugin(n.id).render(s.state))})]})}function Og(){return p("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:p("g",{fill:"#686DE0",fillRule:"evenodd",children:[p("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),p("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),p("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function Ug(){return p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:p("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function Mg(){return p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:p("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function Ig(){return p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:p("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function Lg(){return p("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:p("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function $g(){return p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:p("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[p("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),p("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function Bg(){return p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:p("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function za(s){const e={color:"#838999",icon:$g()};if(!s)return e;const t=s.split("/")[0],n=s.split("/")[1];return t==="text"?{color:"#5a5e69",icon:Bg()}:t==="image"?{color:"#686de0",icon:Og()}:t==="audio"?{color:"#068dbb",icon:Ug()}:t==="video"?{color:"#19af67",icon:Mg()}:t==="application"&&n==="pdf"?{color:"#e25149",icon:Ig()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(n)!==-1?{color:"#00C469",icon:Lg()}:e}function Nt(s){const{tagName:e}=s.target;if(e==="INPUT"||e==="TEXTAREA"){s.stopPropagation();return}s.preventDefault(),s.stopPropagation()}function Ld(s){const{file:e}=s;if(e.preview)return p("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});const{color:t,icon:n}=za(e.type);return p("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[p("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:n}),p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:p("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function zg(s){const{computedMetaFields:e,requiredMetaFields:t,updateMeta:n,form:i,formState:r}=s,a={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(o=>{const c=`uppy-Dashboard-FileCard-input-${o.id}`,d=t.includes(o.id);return p("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[p("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:c,children:o.name}),o.render!==void 0?o.render({value:r[o.id],onChange:u=>n(u,o.id),fieldCSSClasses:a,required:d,form:i.id},mn):p("input",{className:a.text,id:c,form:i.id,type:o.type||"text",required:d,value:r[o.id],placeholder:o.placeholder,onInput:u=>n(u.target.value,o.id),"data-uppy-super-focusable":!0})]},o.id)})}function Hg(s){const{files:e,fileCardFor:t,toggleFileCard:n,saveFileCard:i,metaFields:r,requiredMetaFields:a,openFileEditor:o,i18n:c,i18nArray:d,className:u,canEditFile:h}=s,v=()=>typeof r=="function"?r(e[t]):r,y=e[t],x=v()??[],_=h(y),C={};x.forEach(P=>{C[P.id]=y.meta[P.id]??""});const[N,f]=Ni(C),b=Tf(P=>{P.preventDefault(),i(N,t)},[i,N,t]),S=(P,D)=>{f({...N,[D]:P})},A=()=>{n(!1)},[k]=Ni(()=>{const P=document.createElement("form");return P.setAttribute("tabindex","-1"),P.id=Md(),P});return Xr(()=>(document.body.appendChild(k),k.addEventListener("submit",b),()=>{k.removeEventListener("submit",b),document.body.removeChild(k)}),[k,b]),p("div",{className:We("uppy-Dashboard-FileCard",u),"data-uppy-panelType":"FileCard",onDragOver:Nt,onDragLeave:Nt,onDrop:Nt,onPaste:Nt,children:[p("div",{className:"uppy-DashboardContent-bar",children:[p("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:d("editing",{file:p("span",{className:"uppy-DashboardContent-titleFile",children:y.meta?y.meta.name:y.name})})}),p("button",{className:"uppy-DashboardContent-back",type:"button",form:k.id,title:c("finishEditingFile"),onClick:A,children:c("cancel")})]}),p("div",{className:"uppy-Dashboard-FileCard-inner",children:[p("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:za(y.type).color},children:[p(Ld,{file:y}),_&&p("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:P=>{b(P),o(y)},children:c("editImage")})]}),p("div",{className:"uppy-Dashboard-FileCard-info",children:p(zg,{computedMetaFields:x,requiredMetaFields:a,updateMeta:S,form:k,formState:N})}),p("div",{className:"uppy-Dashboard-FileCard-actions",children:[p("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:k.id,children:c("saveChanges")}),p("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:A,form:k.id,children:c("cancel")})]})]})]})}function qg(s,e){if(s===e)return!0;if(!s||!e)return!1;const t=Object.keys(s),n=Object.keys(e),i=t.length;if(n.length!==i)return!1;for(let r=0;r<i;r++){const a=t[r];if(s[a]!==e[a]||!Object.prototype.hasOwnProperty.call(e,a))return!1}return!0}function Vg(s,e="Copy the URL below"){return new Promise(t=>{const n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=s,document.body.appendChild(n),n.select();const i=()=>{document.body.removeChild(n),window.prompt(e,s),t()};try{return document.execCommand("copy")?(document.body.removeChild(n),t()):i()}catch{return document.body.removeChild(n),i()}})}function Wg({file:s,uploadInProgressOrComplete:e,metaFields:t,canEditFile:n,i18n:i,onClick:r}){return!e&&t&&t.length>0||!e&&n(s)?p("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":i("editFileWithFilename",{file:s.meta.name}),title:i("editFileWithFilename",{file:s.meta.name}),onClick:()=>r(),children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:p("g",{fillRule:"evenodd",children:[p("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),p("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),p("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function Gg({i18n:s,onClick:e,file:t}){return p("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":s("removeFile",{file:t.meta.name}),title:s("removeFile",{file:t.meta.name}),onClick:()=>e(),children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[p("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),p("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function Kg({file:s,uppy:e,i18n:t}){const n=i=>{Vg(s.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>i.target.focus({preventScroll:!0}))};return p("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:i=>n(i),children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:p("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function Xg(s){const{uppy:e,file:t,uploadInProgressOrComplete:n,canEditFile:i,metaFields:r,showLinkToFileUploadResult:a,showRemoveButton:o,i18n:c,toggleFileCard:d,openFileEditor:u}=s;return p("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[p(Wg,{i18n:c,file:t,uploadInProgressOrComplete:n,canEditFile:i,metaFields:r,onClick:()=>{r&&r.length>0?d(!0,t.id):u(t)}}),a&&t.uploadURL?p(Kg,{file:t,uppy:e,i18n:c}):null,o?p(Gg,{i18n:c,file:t,onClick:()=>e.removeFile(t.id)}):null]})}const gr="...";function $d(s,e){if(e===0)return"";if(s.length<=e)return s;if(e<=gr.length+1)return`${s.slice(0,e-1)}…`;const t=e-gr.length,n=Math.ceil(t/2),i=Math.floor(t/2);return s.slice(0,n)+gr+s.slice(-i)}const Yg=(s,e)=>(typeof e=="function"?e():e).filter(i=>i.id===s)[0].name;function Bd(s){const{file:e,toggleFileCard:t,i18n:n,metaFields:i}=s,{missingRequiredMetaFields:r}=e;if(!r?.length)return null;const a=r.map(o=>Yg(o,i)).join(", ");return p("div",{className:"uppy-Dashboard-Item-errorMessage",children:[n("missingRequiredMetaFields",{smart_count:r.length,fields:a})," ",p("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>t(!0,e.id),children:n("editFile")})]})}const Jg=s=>{const{author:e,name:t}=s.file.meta;function n(){return s.isSingleFile&&s.containerHeight>=350?90:s.containerWidth<=352?35:s.containerWidth<=576?60:e?20:30}return p("div",{className:"uppy-Dashboard-Item-name",title:t,children:$d(t,n())})},Qg=s=>{const{author:e}=s.file.meta,t=s.file.remote?.providerName,n="·";return e?p("div",{className:"uppy-Dashboard-Item-author",children:[p("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:$d(e.name,13)}),t?p(qe,{children:[` ${n} `,t,` ${n} `]}):null]}):null},Zg=s=>s.file.size&&p("div",{className:"uppy-Dashboard-Item-statusSize",children:jt(s.file.size)}),ey=s=>s.file.isGhost&&p("span",{children:[" • ",p("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>s.toggleAddFilesPanel(!0),children:s.i18n("reSelect")})]}),ty=({file:s,onClick:e})=>s.error?p("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":s.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function sy(s){const{file:e,i18n:t,toggleFileCard:n,metaFields:i,toggleAddFilesPanel:r,isSingleFile:a,containerHeight:o,containerWidth:c}=s;return p("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[p("div",{className:"uppy-Dashboard-Item-fileName",children:[Jg({file:e,isSingleFile:a,containerHeight:o,containerWidth:c}),p(ty,{file:e,onClick:()=>alert(e.error)})]}),p("div",{className:"uppy-Dashboard-Item-status",children:[Qg({file:e}),Zg({file:e}),ey({file:e,toggleAddFilesPanel:r,i18n:t})]}),p(Bd,{file:e,i18n:t,toggleFileCard:n,metaFields:i})]})}function ny(s){const{file:e,i18n:t,toggleFileCard:n,metaFields:i,showLinkToFileUploadResult:r}=s,o=e.preview?"rgba(255, 255, 255, 0.5)":za(e.type).color;return p("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:o},children:[r&&e.uploadURL&&p("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:p("span",{hidden:!0,children:e.meta.name})}),p(Ld,{file:e}),p(Bd,{file:e,i18n:t,toggleFileCard:n,metaFields:i})]})}function iy(s){if(!s.isUploaded){if(s.error&&!s.hideRetryButton){s.uppy.retryUpload(s.file.id);return}s.resumableUploads&&!s.hidePauseResumeButton?s.uppy.pauseResume(s.file.id):s.individualCancellation&&!s.hideCancelButton&&s.uppy.removeFile(s.file.id)}}function hl(s){return s.isUploaded?s.i18n("uploadComplete"):s.error?s.i18n("retryUpload"):s.resumableUploads?s.file.isPaused?s.i18n("resumeUpload"):s.i18n("pauseUpload"):s.individualCancellation?s.i18n("cancelUpload"):""}function yr(s){return p("div",{className:"uppy-Dashboard-Item-progress",children:p("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":hl(s),title:hl(s),onClick:()=>iy(s),children:s.children})})}function fi({children:s}){return p("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:s})}function vr({progress:s}){const e=2*Math.PI*15;return p("g",{children:[p("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),p("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*s})]})}function ry(s){return!s.file.progress.uploadStarted||s.file.progress.percentage===void 0?null:s.isUploaded?p("div",{className:"uppy-Dashboard-Item-progress",children:p("div",{className:"uppy-Dashboard-Item-progressIndicator",children:p(fi,{children:[p("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),p("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):s.recoveredState?null:s.error&&!s.hideRetryButton?p(yr,{...s,children:p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[p("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),p("path",{d:"M7.9 3H10v2H7.9z"}),p("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),p("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):s.resumableUploads&&!s.hidePauseResumeButton?p(yr,{...s,children:p(fi,{children:[p(vr,{progress:s.file.progress.percentage}),s.file.isPaused?p("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):p("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[p("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),p("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!s.resumableUploads&&s.individualCancellation&&!s.hideCancelButton?p(yr,{...s,children:p(fi,{children:[p(vr,{progress:s.file.progress.percentage}),p("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):p("div",{className:"uppy-Dashboard-Item-progress",children:p("div",{className:"uppy-Dashboard-Item-progressIndicator",children:p(fi,{children:p(vr,{progress:s.file.progress.percentage})})})})}class ay extends we{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!qg(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,n=!!e.progress.uploadComplete&&!t&&!e.error,i=!!e.progress.uploadStarted||!!t,r=e.progress.uploadStarted&&!e.progress.uploadComplete||t,a=e.error||!1,{isGhost:o}=e;let c=(this.props.individualCancellation||!r)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(c=!0);const d=We({"uppy-Dashboard-Item":!0,"is-inprogress":r&&!this.props.recoveredState,"is-processing":t,"is-complete":n,"is-error":!!a,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":o});return p("div",{className:d,id:`uppy_${e.id}`,role:this.props.role,children:[p("div",{className:"uppy-Dashboard-Item-preview",children:[p(ny,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),p(ry,{uppy:this.props.uppy,file:e,error:a,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),p("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[p(sy,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),p(Xg,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:c,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:i,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}}function oy(s,e){const t=[];let n=[];return s.forEach(i=>{n.length<e?n.push(i):(t.push(n),n=[i])}),n.length&&t.push(n),t}function ly({id:s,i18n:e,uppy:t,files:n,resumableUploads:i,hideRetryButton:r,hidePauseResumeButton:a,hideCancelButton:o,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:d,metaFields:u,isSingleFile:h,toggleFileCard:v,handleRequestThumbnail:y,handleCancelThumbnail:x,recoveredState:_,individualCancellation:C,itemsPerRow:N,openFileEditor:f,canEditFile:b,toggleAddFilesPanel:S,containerWidth:A,containerHeight:k}){const P=N===1?71:200,D=Ua(()=>{const H=(X,E)=>Number(n[E].isGhost)-Number(n[X].isGhost),I=Object.keys(n);return _&&I.sort(H),oy(I,N)},[n,N,_]),U=H=>p("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:H.map(I=>p(ay,{uppy:t,id:s,i18n:e,resumableUploads:i,individualCancellation:C,hideRetryButton:r,hidePauseResumeButton:a,hideCancelButton:o,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:d,metaFields:u,recoveredState:_,isSingleFile:h,containerWidth:A,containerHeight:k,toggleFileCard:v,handleRequestThumbnail:y,handleCancelThumbnail:x,role:"listitem",openFileEditor:f,canEditFile:b,toggleAddFilesPanel:S,file:n[I]},I))},H[0]);return h?p("div",{class:"uppy-Dashboard-files",children:U(D[0])}):p(Pm,{class:"uppy-Dashboard-files",role:"list",data:D,renderRow:U,rowHeight:P})}function cy({activePickerPanel:s,className:e,hideAllPanels:t,i18n:n,state:i,uppy:r}){const a=bi(null);return p("div",{className:We("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${s.id}`,onDragOver:Nt,onDragLeave:Nt,onDrop:Nt,onPaste:Nt,children:[p("div",{className:"uppy-DashboardContent-bar",children:[p("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n("importFrom",{name:s.name})}),p("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:n("cancel")})]}),p("div",{ref:a,className:"uppy-DashboardContent-panelBody",children:r.getPlugin(s.id).render(i,a.current)})]})}const Ze={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function dy(s,e,t,n={}){if(s)return Ze.STATE_ERROR;if(e)return Ze.STATE_COMPLETE;if(t)return Ze.STATE_PAUSED;let i=Ze.STATE_WAITING;const r=Object.keys(n);for(let a=0;a<r.length;a++){const{progress:o}=n[r[a]];if(o.uploadStarted&&!o.uploadComplete)return Ze.STATE_UPLOADING;o.preprocess&&i!==Ze.STATE_UPLOADING&&(i=Ze.STATE_PREPROCESSING),o.postprocess&&i!==Ze.STATE_UPLOADING&&i!==Ze.STATE_PREPROCESSING&&(i=Ze.STATE_POSTPROCESSING)}return i}function uy({files:s,i18n:e,isAllComplete:t,isAllErrored:n,isAllPaused:i,inProgressNotPausedFiles:r,newFiles:a,processingFiles:o}){switch(dy(n,t,i,s)){case"uploading":return e("uploadingXFiles",{smart_count:r.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:o.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:a.length});case"complete":return e("uploadComplete");case"error":return e("error")}}function hy(s){const{i18n:e,isAllComplete:t,hideCancelButton:n,maxNumberOfFiles:i,toggleAddFilesPanel:r,uppy:a}=s;let{allowNewUpload:o}=s;return o&&i&&(o=s.totalFileCount<s.maxNumberOfFiles),p("div",{className:"uppy-DashboardContent-bar",children:[!t&&!n?p("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>a.cancelAll(),children:e("cancel")}):p("div",{}),p("div",{className:"uppy-DashboardContent-title",children:p(uy,{...s})}),o?p("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>r(!0),children:[p("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:p("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),p("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):p("div",{})]})}const os="uppy-transition-slideDownUp",pl=250;function mi({children:s}){const[e,t]=Ni(null),[n,i]=Ni(""),r=bi(),a=bi(),o=bi(),c=()=>{i(`${os}-enter`),cancelAnimationFrame(o.current),clearTimeout(a.current),a.current=void 0,o.current=requestAnimationFrame(()=>{i(`${os}-enter ${os}-enter-active`),r.current=setTimeout(()=>{i("")},pl)})},d=()=>{i(`${os}-leave`),cancelAnimationFrame(o.current),clearTimeout(r.current),r.current=void 0,o.current=requestAnimationFrame(()=>{i(`${os}-leave ${os}-leave-active`),a.current=setTimeout(()=>{t(null),i("")},pl)})};return Xr(()=>{const u=ze(s)[0];e!==u&&(u&&!e?c():e&&!u&&!a.current&&d(),t(u))},[s,e]),Xr(()=>()=>{clearTimeout(r.current),clearTimeout(a.current),cancelAnimationFrame(o.current)},[]),e?sd(e,{className:We(n,e.props.className)}):null}const fl=900,ml=700,br=576,gl=330;function py(s){const e=s.totalFileCount===0,t=s.totalFileCount===1,n=s.containerWidth>br,i=s.containerHeight>gl,r=We({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":s.disabled,"uppy-Dashboard--animateOpenClose":s.animateOpenClose,"uppy-Dashboard--isClosing":s.isClosing,"uppy-Dashboard--isDraggingOver":s.isDraggingOver,"uppy-Dashboard--modal":!s.inline,"uppy-size--md":s.containerWidth>br,"uppy-size--lg":s.containerWidth>ml,"uppy-size--xl":s.containerWidth>fl,"uppy-size--height-md":s.containerHeight>gl,"uppy-Dashboard--isAddFilesPanelVisible":s.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":s.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":s.singleFileFullScreen&&t&&i});let a=1;s.containerWidth>fl?a=5:s.containerWidth>ml?a=4:s.containerWidth>br&&(a=3);const o=s.showSelectedFiles&&!e,c=s.recoveredState?Object.keys(s.recoveredState.files).length:null,d=s.files?Object.keys(s.files).filter(v=>s.files[v].isGhost).length:0,u=()=>d>0?s.i18n("recoveredXFiles",{smart_count:d}):s.i18n("recoveredAllFiles");return p("div",{className:r,"data-uppy-theme":s.theme,"data-uppy-num-acquirers":s.acquirers.length,"data-uppy-drag-drop-supported":!s.disableLocalFiles&&Rg(),"aria-hidden":s.inline?"false":s.isHidden,"aria-disabled":s.disabled,"aria-label":s.inline?s.i18n("dashboardTitle"):s.i18n("dashboardWindowTitle"),onPaste:s.handlePaste,onDragOver:s.handleDragOver,onDragLeave:s.handleDragLeave,onDrop:s.handleDrop,children:[p("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:s.handleClickOutside}),p("div",{className:"uppy-Dashboard-inner",role:s.inline?void 0:"dialog",style:{width:s.inline&&s.width?s.width:"",height:s.inline&&s.height?s.height:""},children:[s.inline?null:p("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":s.i18n("closeModal"),title:s.i18n("closeModal"),onClick:s.closeModal,children:p("span",{"aria-hidden":"true",children:"×"})}),p("div",{className:"uppy-Dashboard-innerWrap",children:[p("div",{className:"uppy-Dashboard-dropFilesHereHint",children:s.i18n("dropHint")}),o&&p(hy,{...s}),c&&p("div",{className:"uppy-Dashboard-serviceMsg",children:[p("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:p("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[p("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),p("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),p("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),p("strong",{className:"uppy-Dashboard-serviceMsg-title",children:s.i18n("sessionRestored")}),p("div",{className:"uppy-Dashboard-serviceMsg-text",children:u()})]}),o?p(ly,{id:s.id,i18n:s.i18n,uppy:s.uppy,files:s.files,resumableUploads:s.resumableUploads,hideRetryButton:s.hideRetryButton,hidePauseResumeButton:s.hidePauseResumeButton,hideCancelButton:s.hideCancelButton,showLinkToFileUploadResult:s.showLinkToFileUploadResult,showRemoveButtonAfterComplete:s.showRemoveButtonAfterComplete,metaFields:s.metaFields,toggleFileCard:s.toggleFileCard,handleRequestThumbnail:s.handleRequestThumbnail,handleCancelThumbnail:s.handleCancelThumbnail,recoveredState:s.recoveredState,individualCancellation:s.individualCancellation,openFileEditor:s.openFileEditor,canEditFile:s.canEditFile,toggleAddFilesPanel:s.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:a,containerWidth:s.containerWidth,containerHeight:s.containerHeight}):p(Id,{i18n:s.i18n,i18nArray:s.i18nArray,acquirers:s.acquirers,handleInputChange:s.handleInputChange,maxNumberOfFiles:s.maxNumberOfFiles,allowedFileTypes:s.allowedFileTypes,showNativePhotoCameraButton:s.showNativePhotoCameraButton,showNativeVideoCameraButton:s.showNativeVideoCameraButton,nativeCameraFacingMode:s.nativeCameraFacingMode,showPanel:s.showPanel,activePickerPanel:s.activePickerPanel,disableLocalFiles:s.disableLocalFiles,fileManagerSelectionType:s.fileManagerSelectionType,note:s.note,proudlyDisplayPoweredByUppy:s.proudlyDisplayPoweredByUppy}),p(mi,{children:s.showAddFilesPanel?p(Dg,{...s,isSizeMD:n},"AddFiles"):null}),p(mi,{children:s.fileCardFor?p(Hg,{...s},"FileCard"):null}),p(mi,{children:s.activePickerPanel?p(cy,{...s},"Picker"):null}),p(mi,{children:s.showFileEditor?p(jg,{...s},"Editor"):null}),p("div",{className:"uppy-Dashboard-progressindicators",children:s.progressindicators.map(v=>s.uppy.getPlugin(v.id).render(s.state))})]})]})]})}const fy={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}},zd=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function Hd(s,e){if(e){const t=s.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return s}function my(){let s=!1;return Bu((t,n)=>{const i=Hd(t,n),r=i.contains(document.activeElement);if(r&&s)return;const a=i.querySelector("[data-uppy-super-focusable]");r&&!a||(a?(a.focus({preventScroll:!0}),s=!0):(i.querySelector(zd)?.focus({preventScroll:!0}),s=!1))},260)}function yl(s,e){const t=e[0];t&&(t.focus(),s.preventDefault())}function gy(s,e){const t=e[e.length-1];t&&(t.focus(),s.preventDefault())}function yy(s){return s.contains(document.activeElement)}function qd(s,e,t){const n=Hd(t,e),i=cn(n.querySelectorAll(zd)),r=i.indexOf(document.activeElement);yy(n)?s.shiftKey&&r===0?gy(s,i):!s.shiftKey&&r===i.length-1&&yl(s,i):yl(s,i)}function vy(s,e,t){e===null||qd(s,e,t)}const vl=9,by=27;function bl(){const s={};return s.promise=new Promise((e,t)=>{s.resolve=e,s.reject=t}),s}const wy={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Nm,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};var Cr,vs,Lt,En,bs,Oi,Ui,Mi,$t,Ii,Li,ws,ue,da,ua,Vd,ha,pa,Wd;let xy=(Cr=class extends Us{constructor(t,n){var r;const i=n?.autoOpen??null;super(t,{...wy,...n,autoOpen:i});T(this,ue);T(this,vs);w(this,"modalName",`uppy-Dashboard-${Md()}`);w(this,"superFocus",my());w(this,"ifFocusedOnUppyRecently",!1);w(this,"dashboardIsDisabled");w(this,"savedScrollPosition");w(this,"savedActiveElement");w(this,"resizeObserver");w(this,"darkModeMediaQuery");w(this,"makeDashboardInsidesVisibleAnywayTimeout");w(this,"removeTarget",t=>{const i=this.getPluginState().targets.filter(r=>r.id!==t.id);this.setPluginState({targets:i})});w(this,"addTarget",t=>{const n=t.id||t.constructor.name,i=t.title||n,r=t.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;const a={id:n,name:i,type:r},c=this.getPluginState().targets.slice();return c.push(a),this.setPluginState({targets:c}),this.el});w(this,"hideAllPanels",()=>{const t=this.getPluginState(),n={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};t.activePickerPanel===n.activePickerPanel&&t.showAddFilesPanel===n.showAddFilesPanel&&t.showFileEditor===n.showFileEditor&&t.activeOverlayType===n.activeOverlayType||(this.setPluginState(n),this.uppy.emit("dashboard:close-panel",t.activePickerPanel?.id))});w(this,"showPanel",t=>{const{targets:n}=this.getPluginState(),i=n.find(r=>r.type==="acquirer"&&r.id===t);this.setPluginState({activePickerPanel:i,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",t)});w(this,"canEditFile",t=>{const{targets:n}=this.getPluginState();return m(this,$t).call(this,n).some(r=>this.uppy.getPlugin(r.id).canEditFile(t))});w(this,"openFileEditor",t=>{const{targets:n}=this.getPluginState(),i=m(this,$t).call(this,n);this.setPluginState({showFileEditor:!0,fileCardFor:t.id||null,activeOverlayType:"FileEditor"}),i.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(t)})});w(this,"closeFileEditor",()=>{const{metaFields:t}=this.getPluginState();t&&t.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})});w(this,"saveFileEditor",()=>{const{targets:t}=this.getPluginState();m(this,$t).call(this,t).forEach(i=>{this.uppy.getPlugin(i.id).save()}),this.closeFileEditor()});w(this,"openModal",()=>{const{promise:t,resolve:n}=bl();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const i=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",i,!1),n()};this.el.addEventListener("animationend",i,!1)}else this.setPluginState({isHidden:!1}),n();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),t});w(this,"closeModal",t=>{const n=t?.manualClose??!0,{isHidden:i,isClosing:r}=this.getPluginState();if(i||r)return;const{promise:a,resolve:o}=bl();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const c=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",c,!1),o()};this.el.addEventListener("animationend",c,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),o();return document.removeEventListener("keydown",this.handleKeyDownInModal),n&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),a});w(this,"isModalOpen",()=>!this.getPluginState().isHidden||!1);w(this,"requestCloseModal",()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal());w(this,"setDarkModeCapability",t=>{const{capabilities:n}=this.uppy.getState();this.uppy.setState({capabilities:{...n,darkMode:t}})});w(this,"handleSystemDarkModeChange",t=>{const n=t.matches;this.uppy.log(`[Dashboard] Dark mode is ${n?"on":"off"}`),this.setDarkModeCapability(n)});w(this,"toggleFileCard",(t,n)=>{const i=this.uppy.getFile(n);t?this.uppy.emit("dashboard:file-edit-start",i):this.uppy.emit("dashboard:file-edit-complete",i),this.setPluginState({fileCardFor:t?n:null,activeOverlayType:t?"FileCard":null})});w(this,"toggleAddFilesPanel",t=>{this.setPluginState({showAddFilesPanel:t,activeOverlayType:t?"AddFiles":null})});w(this,"addFiles",t=>{const n=t.map(i=>({source:this.id,name:i.name,type:i.type,data:i,meta:{relativePath:i.relativePath||i.webkitRelativePath||null}}));try{this.uppy.addFiles(n)}catch(i){this.uppy.log(i)}});w(this,"startListeningToResize",()=>{this.resizeObserver=new ResizeObserver(t=>{const n=t[0],{width:i,height:r}=n.contentRect;this.setPluginState({containerWidth:i,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{const t=this.getPluginState(),n=!this.opts.inline&&t.isHidden;!t.areInsidesReadyToBeVisible&&!n&&(this.uppy.log("[Dashboard] resize event didn’t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)});w(this,"stopListeningToResize",()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)});w(this,"recordIfFocusedOnUppyRecently",t=>{this.el.contains(t.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())});w(this,"disableInteractiveElements",t=>{const n=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],i=m(this,vs)??cn(this.el.querySelectorAll(n)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(const r of i)r.tagName==="A"?r.setAttribute("aria-disabled",t):r.disabled=t;t?j(this,vs,i):j(this,vs,null),this.dashboardIsDisabled=t});w(this,"updateBrowserHistory",()=>{history.state?.[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)});w(this,"handlePopState",t=>{this.isModalOpen()&&(!t.state||!t.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&t.state?.[this.modalName]&&history.back()});w(this,"handleKeyDownInModal",t=>{t.keyCode===by&&this.requestCloseModal(),t.keyCode===vl&&qd(t,this.getPluginState().activeOverlayType,this.el)});w(this,"handleClickOutside",()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()});w(this,"handlePaste",t=>{this.uppy.iteratePlugins(i=>{i.type==="acquirer"&&i.handleRootPaste?.(t)});const n=cn(t.clipboardData.files);n.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(n))});w(this,"handleInputChange",t=>{t.preventDefault();const n=cn(t.currentTarget.files||[]);n.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(n))});w(this,"handleDragOver",t=>{t.preventDefault(),t.stopPropagation();const n=()=>{let o=!0;return this.uppy.iteratePlugins(c=>{c.canHandleRootDrop?.(t)&&(o=!0)}),o},i=()=>{const{types:o}=t.dataTransfer;return o.some(c=>c==="Files")},r=n(),a=i();if(!r&&!a||this.opts.disabled||this.opts.disableLocalFiles&&(a||!r)||!this.uppy.getState().allowNewUpload){t.dataTransfer.dropEffect="none";return}t.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(t)});w(this,"handleDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(t)});w(this,"handleDrop",async t=>{t.preventDefault(),t.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(a=>{a.type==="acquirer"&&a.handleRootDrop?.(t)});let n=!1;const i=a=>{this.uppy.log(a,"error"),n||(this.uppy.info(a.message,"error"),n=!0)};this.uppy.log("[Dashboard] Processing dropped files");const r=await Ng(t.dataTransfer,{logDropError:i});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(t)});w(this,"handleRequestThumbnail",t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",t)});w(this,"handleCancelThumbnail",t=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",t)});w(this,"handleKeyDownInInline",t=>{t.keyCode===vl&&vy(t,this.getPluginState().activeOverlayType,this.el)});w(this,"handlePasteOnBody",t=>{this.el.contains(document.activeElement)&&this.handlePaste(t)});w(this,"handleComplete",({failed:t})=>{this.opts.closeAfterFinish&&!t?.length&&this.requestCloseModal()});w(this,"handleCancelRestore",()=>{this.uppy.emit("restore-canceled")});T(this,Lt,()=>{if(this.opts.disableThumbnailGenerator)return;const t=600,n=this.uppy.getFiles();if(n.length===1){const i=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);i?.setOptions({thumbnailWidth:t});const r={...n[0],preview:void 0};i?.requestThumbnail(r).then(()=>{i?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}});T(this,En,t=>{const n=t[0],{metaFields:i}=this.getPluginState(),r=i&&i.length>0,a=this.canEditFile(n);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,n.id):a&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(n)});w(this,"initEvents",()=>{if(this.opts.trigger&&!this.opts.inline){const t=ul(this.opts.trigger);t?t.forEach(n=>n.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",m(this,ws)),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",m(this,Lt)),this.uppy.on("file-removed",m(this,Lt)),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",m(this,En))});w(this,"removeEvents",()=>{const t=ul(this.opts.trigger);!this.opts.inline&&t&&t.forEach(n=>n.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",m(this,ws)),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",m(this,Lt)),this.uppy.off("file-removed",m(this,Lt)),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",m(this,En))});w(this,"superFocusOnEachUpdate",()=>{const t=this.el.contains(document.activeElement),n=document.activeElement===document.body||document.activeElement===null,i=this.uppy.getState().info.length===0,r=!this.opts.inline;i&&(r||t||n&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()});w(this,"afterUpdate",()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()});w(this,"saveFileCard",(t,n)=>{this.uppy.setFileMeta(n,t),this.toggleFileCard(!1,n)});T(this,bs,t=>{const n=this.uppy.getPlugin(t.id);return{...t,icon:n.icon||this.opts.defaultPickerIcon,render:n.render}});T(this,Oi,t=>{const n=this.uppy.getPlugin(t.id);return typeof n.isSupported!="function"?!0:n.isSupported()});T(this,Ui,t=>t.filter(n=>n.type==="acquirer"&&m(this,Oi).call(this,n)).map(m(this,bs)));T(this,Mi,t=>t.filter(n=>n.type==="progressindicator").map(m(this,bs)));T(this,$t,t=>t.filter(n=>n.type==="editor").map(m(this,bs)));w(this,"render",t=>{const n=this.getPluginState(),{files:i,capabilities:r,allowNewUpload:a}=t,{newFiles:o,uploadStartedFiles:c,completeFiles:d,erroredFiles:u,inProgressFiles:h,inProgressNotPausedFiles:v,processingFiles:y,isUploadStarted:x,isAllComplete:_,isAllPaused:C}=this.uppy.getObjectOfFilesPerState(),N=m(this,Ui).call(this,n.targets),f=m(this,Mi).call(this,n.targets),b=m(this,$t).call(this,n.targets);let S;return this.opts.theme==="auto"?S=r.darkMode?"dark":"light":S=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),py({state:t,isHidden:n.isHidden,files:i,newFiles:o,uploadStartedFiles:c,completeFiles:d,erroredFiles:u,inProgressFiles:h,inProgressNotPausedFiles:v,processingFiles:y,isUploadStarted:x,isAllComplete:_,isAllPaused:C,totalFileCount:Object.keys(i).length,totalProgress:t.totalProgress,allowNewUpload:a,acquirers:N,theme:S,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:n.activePickerPanel,showFileEditor:n.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:n.isClosing,progressindicators:f,editors:b,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:t.recoveredState,metaFields:n.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:n.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:n.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:n.containerWidth,containerHeight:n.containerHeight,areInsidesReadyToBeVisible:n.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:n.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})});T(this,Ii,()=>{const{plugins:t}=this.opts;t.forEach(n=>{const i=this.uppy.getPlugin(n);i?i.mount(this,i):this.uppy.log(`[Uppy] Dashboard could not find plugin '${n}', make sure to uppy.use() the plugins you are specifying`,"warning")})});T(this,Li,()=>{this.uppy.iteratePlugins(m(this,ws))});T(this,ws,t=>{const n=["acquirer","editor"];t&&!t.opts?.target&&n.includes(t.type)&&(this.getPluginState().targets.some(r=>t.id===r.id)||t.mount(this,t))});w(this,"install",()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:t,closeAfterFinish:n}=this.opts;if(t&&n)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:i,allowMultipleUploadBatches:r}=this.uppy.opts;(i||r)&&n&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:a}=this.opts;a&&this.mount(a,this),this.opts.disableStatusBar||this.uppy.use(Qm,{id:R(this,ue,ha).call(this),target:this,...R(this,ue,da).call(this)}),this.opts.disableInformer||this.uppy.use(wd,{id:R(this,ue,Wd).call(this),target:this,...R(this,ue,Vd).call(this)}),this.opts.disableThumbnailGenerator||this.uppy.use(Dd,{id:R(this,ue,pa).call(this),...R(this,ue,ua).call(this)}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const o=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${o?"on":"off"}`),this.setDarkModeCapability(o),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),m(this,Ii).call(this),m(this,Li).call(this),this.initEvents()});w(this,"uninstall",()=>{if(!this.opts.disableInformer){const n=this.uppy.getPlugin(`${this.id}:Informer`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableStatusBar){const n=this.uppy.getPlugin(`${this.id}:StatusBar`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableThumbnailGenerator){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n&&this.uppy.removePlugin(n)}const{plugins:t}=this.opts;t.forEach(n=>{const i=this.uppy.getPlugin(n);i&&i.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()});this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=fy,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),(r=this.opts).onRequestCloseModal??(r.onRequestCloseModal=()=>this.closeModal()),this.i18nInit()}setOptions(t){super.setOptions(t),this.uppy.getPlugin(R(this,ue,ha).call(this))?.setOptions(R(this,ue,da).call(this)),this.uppy.getPlugin(R(this,ue,pa).call(this))?.setOptions(R(this,ue,ua).call(this))}},vs=new WeakMap,Lt=new WeakMap,En=new WeakMap,bs=new WeakMap,Oi=new WeakMap,Ui=new WeakMap,Mi=new WeakMap,$t=new WeakMap,Ii=new WeakMap,Li=new WeakMap,ws=new WeakMap,ue=new WeakSet,da=function(){const{hideUploadButton:t,hideRetryButton:n,hidePauseResumeButton:i,hideCancelButton:r,showProgressDetails:a,hideProgressAfterFinish:o,locale:c,doneButtonHandler:d}=this.opts;return{hideUploadButton:t,hideRetryButton:n,hidePauseResumeButton:i,hideCancelButton:r,showProgressDetails:a,hideAfterFinish:o,locale:c,doneButtonHandler:d}},ua=function(){const{thumbnailWidth:t,thumbnailHeight:n,thumbnailType:i,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:t,thumbnailHeight:n,thumbnailType:i,waitForThumbnailsBeforeUpload:r,lazy:!r}},Vd=function(){return{}},ha=function(){return`${this.id}:StatusBar`},pa=function(){return`${this.id}:ThumbnailGenerator`},Wd=function(){return`${this.id}:Informer`},w(Cr,"VERSION",Ag.version),Cr);const Cy=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],_y=/^(aria-|data-)/,Gd=s=>Object.fromEntries(Object.entries(s).filter(([e])=>_y.test(e)||Cy.includes(e)));function Sy(s,e){const t=Gd(s);return Object.keys(s).some(n=>!Object.hasOwn(t,n)&&s[n]!==e[n])}class Kd extends g.Component{constructor(){super(...arguments);w(this,"container");w(this,"plugin")}componentDidMount(){this.installPlugin()}componentDidUpdate(t){const{uppy:n,open:i,onRequestClose:r}=this.props;if(t.uppy!==n)this.uninstallPlugin(t),this.installPlugin();else if(Sy(this.props,t)){const{uppy:a,...o}={...this.props,inline:!1,onRequestCloseModal:r};this.plugin.setOptions(o)}t.open&&!i?this.plugin.closeModal():!t.open&&i&&this.plugin.openModal()}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{target:t=this.container,open:n,onRequestClose:i,uppy:r,...a}=this.props,o={id:"DashboardModal",...a,inline:!1,target:t,open:n,onRequestCloseModal:i};r.use(xy,o),this.plugin=r.getPlugin(o.id),n&&this.plugin.openModal()}uninstallPlugin(t=this.props){const{uppy:n}=t;n.removePlugin(this.plugin)}render(){return g.createElement("div",{className:"uppy-Container",ref:t=>{this.container=t},...Gd(this.props)})}}w(Kd,"defaultProps",{open:void 0,onRequestClose:void 0});g.createContext({uppy:void 0,status:"init",progress:0});var Ey={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kn=g;function Fy(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var Py=typeof Object.is=="function"?Object.is:Fy,Ny=Kn.useSyncExternalStore,ky=Kn.useRef,Ty=Kn.useEffect,Ay=Kn.useMemo,Ry=Kn.useDebugValue;Ey.useSyncExternalStoreWithSelector=function(s,e,t,n,i){var r=ky(null);if(r.current===null){var a={hasValue:!1,value:null};r.current=a}else a=r.current;r=Ay(function(){function c(y){if(!d){if(d=!0,u=y,y=n(y),i!==void 0&&a.hasValue){var x=a.value;if(i(x,y))return h=x}return h=y}if(x=h,Py(u,y))return x;var _=n(y);return i!==void 0&&i(x,_)?(u=y,x):(u=y,h=_)}var d=!1,u,h,v=t===void 0?null:t;return[function(){return c(e())},v===null?void 0:function(){return c(v())}]},[e,t,n,i]);var o=Ny(s,r[0],r[1]);return Ty(function(){a.hasValue=!0,a.value=o},[o]),Ry(o),o};function Xd(s,e){return Object.hasOwn(s,e)}class Dy extends Error{constructor(t,n){super(t);w(this,"isNetworkError");w(this,"cause");this.cause=n?.cause,this.cause&&Xd(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}class jy extends Error{constructor(t,n=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.");w(this,"cause");w(this,"isNetworkError");w(this,"request");this.cause=t,this.isNetworkError=!0,this.request=n}}function Oy(...s){return fetch(...s).catch(e=>{throw e.name==="AbortError"?e:new jy(e)})}function Uy(s){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(s)?.[1];return`${/^http:\/\//i.test(s)?"ws":"wss"}://${t}`}class My extends Error{constructor(){super(...arguments);w(this,"name","UserFacingApiError")}}var Yd={};function Re(s,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(s)),this._timeouts=s,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Iy=Re;Re.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Re.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Re.prototype.retry=function(s){if(this._timeout&&clearTimeout(this._timeout),!s)return!1;var e=new Date().getTime();if(s&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(s),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(s);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},t),this._options.unref&&this._timer.unref(),!0};Re.prototype.attempt=function(s,e){this._fn=s,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Re.prototype.try=function(s){console.log("Using RetryOperation.try() is deprecated"),this.attempt(s)};Re.prototype.start=function(s){console.log("Using RetryOperation.start() is deprecated"),this.attempt(s)};Re.prototype.start=Re.prototype.try;Re.prototype.errors=function(){return this._errors};Re.prototype.attempts=function(){return this._attempts};Re.prototype.mainError=function(){if(this._errors.length===0)return null;for(var s={},e=null,t=0,n=0;n<this._errors.length;n++){var i=this._errors[n],r=i.message,a=(s[r]||0)+1;s[r]=a,a>=t&&(e=i,t=a)}return e};(function(s){var e=Iy;s.operation=function(t){var n=s.timeouts(t);return new e(n,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},s.timeouts=function(t){if(t instanceof Array)return[].concat(t);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in t)n[i]=t[i];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],a=0;a<n.retries;a++)r.push(this.createTimeout(a,n));return t&&t.forever&&!r.length&&r.push(this.createTimeout(a,n)),r.sort(function(o,c){return o-c}),r},s.createTimeout=function(t,n){var i=n.randomize?Math.random()+1:1,r=Math.round(i*Math.max(n.minTimeout,1)*Math.pow(n.factor,t));return r=Math.min(r,n.maxTimeout),r},s.wrap=function(t,n,i){if(n instanceof Array&&(i=n,n=null),!i){i=[];for(var r in t)typeof t[r]=="function"&&i.push(r)}for(var a=0;a<i.length;a++){var o=i[a],c=t[o];t[o]=function(u){var h=s.operation(n),v=Array.prototype.slice.call(arguments,1),y=v.pop();v.push(function(x){h.retry(x)||(x&&(arguments[0]=h.mainError()),y.apply(this,arguments))}),h.attempt(function(){u.apply(t,v)})}.bind(t,c),t[o].options=n}}})(Yd);var Ly=Yd;const $y=$n(Ly),By=Object.prototype.toString,zy=s=>By.call(s)==="[object Error]",Hy=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function qy(s){return s&&zy(s)&&s.name==="TypeError"&&typeof s.message=="string"?s.message==="Load failed"?s.stack===void 0:Hy.has(s.message):!1}class fa extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const wl=(s,e,t)=>{const n=t.retries-(e-1);return s.attemptNumber=e,s.retriesLeft=n,s};async function xl(s,e){return new Promise((t,n)=>{e={...e},e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.retries??(e.retries=10);const i=$y.operation(e),r=()=>{i.stop(),n(e.signal?.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",r,{once:!0});const a=()=>{e.signal?.removeEventListener("abort",r),i.stop()};i.attempt(async o=>{try{const c=await s(o);a(),t(c)}catch(c){try{if(!(c instanceof Error))throw new TypeError(`Non-error was thrown: "${c}". You should only throw errors.`);if(c instanceof fa)throw c.originalError;if(c instanceof TypeError&&!qy(c))throw c;if(wl(c,o,e),await e.shouldRetry(c)||(i.stop(),n(c)),await e.onFailedAttempt(c),!i.retry(c))throw i.mainError()}catch(d){wl(d,o,e),a(),n(d)}}})})}const Vy="4.5.2",Wy={version:Vy};class Gy extends Error{constructor(){super("Authorization required");w(this,"isAuthError");this.name="AuthError",this.isAuthError=!0}}function Ky(s){return s.replace(/\/$/,"")}const Cl=10,Xy=5*60*1e3,Yy=401;class Jy extends Error{constructor({statusCode:t,message:n}){super(n);w(this,"statusCode");this.name="HttpError",this.statusCode=t}}async function Qy(s){if(s.status===Yy)throw new Gy;if(s.ok)return s.json();let e=`Failed request with status: ${s.status}. ${s.statusText}`,t;try{t=await s.json(),t.message&&(e=`${e} message: ${t.message}`),t.requestId&&(e=`${e} request-Id: ${t.requestId}`)}catch(n){throw new Error(e,{cause:n})}throw s.status>=400&&s.status<=499&&t.message?new My(t.message):new Jy({statusCode:s.status,message:e})}function Zy(s,e,t){const{progress:n,bytesUploaded:i,bytesTotal:r}=e;n&&(s.uppy.log(`Upload progress: ${n}`),s.uppy.emit("upload-progress",t,{uploadStarted:t.progress.uploadStarted??0,bytesUploaded:i,bytesTotal:r}))}var Bt,Tt,ma,$i,ga;class Jd{constructor(e,t){T(this,Tt);T(this,Bt);w(this,"uppy");w(this,"opts");T(this,$i,async({file:e,postBody:t,signal:n})=>{if(e.remote?.url==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(e.remote.url,{...e.remote.body,...t},{signal:n})).token});this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),j(this,Bt,t.companionHeaders)}setCompanionHeaders(e){j(this,Bt,e)}[Symbol.for("uppy test: getCompanionHeaders")](){return m(this,Bt)}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return Ky(e?.[t]?e[t]:t)}async headers(e=!1){return{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...m(this,Bt)}}onReceiveResponse(e){const{headers:t}=e,i=this.uppy.getState().companion||{},r=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==i[r]&&this.uppy.setState({companion:{...i,[r]:t.get("i-am")}})}async request({path:e,method:t="GET",data:n,skipPostResponse:i,signal:r}){try{const a=await this.headers(!n),o=await Oy(R(this,Tt,ma).call(this,e),{method:t,signal:r,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:n?JSON.stringify(n):null});return i||this.onReceiveResponse(o),await Qy(o)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new Dy(`Could not ${t} ${R(this,Tt,ma).call(this,e)}`,{cause:a})}}async get(e,t){return this.request({...t,path:e})}async post(e,t,n){return this.request({...n,path:e,method:"POST",data:t})}async delete(e,t,n){return this.request({...n,path:e,method:"DELETE",data:t})}async uploadRemoteFile(e,t,n){try{const{signal:i,getQueue:r}=n||{};return await xl(async()=>{const a=this.uppy.getFile(e.id)?.serverToken;if(a!=null)return this.uppy.log(`Connecting to exiting websocket ${a}`),R(this,Tt,ga).call(this,{file:e,queue:r(),signal:i});const c=await r().wrapPromiseFunction(async(...d)=>{try{return await m(this,$i).call(this,...d)}catch(u){if(u.isAuthError)throw new fa(u);if(u.cause==null)throw u;const h=u.cause,v=()=>[408,409,429,418,423].includes(h.statusCode)||h.statusCode>=500&&h.statusCode<=599&&![501,505].includes(h.statusCode);throw h.name==="HttpError"&&!v()?new fa(h):h}},{priority:-1})({file:e,postBody:t,signal:i}).abortOn(i);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:c}),R(this,Tt,ga).call(this,{file:this.uppy.getFile(e.id),queue:r(),signal:i})},{retries:Cl,signal:i,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(i){if(i.name==="AbortError")return;throw this.uppy.emit("upload-error",e,i),i}}}Bt=new WeakMap,Tt=new WeakSet,ma=function(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`},$i=new WeakMap,ga=async function({file:e,queue:t,signal:n}){let i;const{capabilities:r}=this.uppy.getState();try{return await new Promise((a,o)=>{const c=e.serverToken,d=Uy(e.remote.companionUrl);let u,h,v,{isPaused:y}=e;const x=(P,D)=>{if(u==null||u.readyState!==u.OPEN){this.uppy.log(`Cannot send "${P}" to socket ${e.id} because the socket state was ${String(u?.readyState)}`,"warning");return}u.send(JSON.stringify({action:P,payload:D??{}}))};function _(){r.resumableUploads&&x(y?"pause":"resume")}const C=async()=>{h&&h.abort(),h=new AbortController;const P=U=>{this.uppy.setFileState(e.id,{serverToken:null}),h?.abort?.(),o(U)};function D(){clearTimeout(v),!y&&(v=setTimeout(()=>P(new Error("Timeout waiting for message from Companion socket")),Xy))}try{await t.wrapPromiseFunction(async()=>{await xl(async()=>new Promise((H,I)=>{u=new WebSocket(`${d}/api/${c}`),D(),u.addEventListener("close",()=>{u=void 0,I(new Error("Socket closed unexpectedly"))}),u.addEventListener("error",E=>{this.uppy.log(`Companion socket error ${JSON.stringify(E)}, closing socket`,"warning"),u?.close()}),u.addEventListener("open",()=>{_()}),u.addEventListener("message",E=>{D();try{const{action:q,payload:W}=JSON.parse(E.data);switch(q){case"progress":{Zy(this,W,this.uppy.getFile(e.id));break}case"success":{const te=W.response?.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:W.url,status:W.response?.status??200,body:te?JSON.parse(te):void 0}),h?.abort?.(),a();break}case"error":{const{message:te}=W.error;throw Object.assign(new Error(te),{cause:W.error})}default:this.uppy.log(`Companion socket unknown action ${q}`,"warning")}}catch(q){P(q)}});const X=()=>{this.uppy.log(`Closing socket ${e.id}`),clearTimeout(v),u&&u.close(),u=void 0};h.signal.addEventListener("abort",()=>{X()})}),{retries:Cl,signal:h.signal,onFailedAttempt:()=>{h.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`)}})})().abortOn(h.signal)}catch(U){if(h.signal.aborted)return;P(U)}},N=P=>{r.resumableUploads&&(y=P,u&&_())},f=P=>{r.individualCancellation&&P.id===e.id&&(x("cancel"),h?.abort?.(),this.uppy.log(`upload ${e.id} was removed`),a())},b=()=>{x("cancel"),h?.abort?.(),this.uppy.log(`upload ${e.id} was canceled`),a()},S=(P,D)=>{P?.id===e.id&&N(D)},A=()=>N(!0),k=()=>N(!1);this.uppy.on("file-removed",f),this.uppy.on("cancel-all",b),this.uppy.on("upload-pause",S),this.uppy.on("pause-all",A),this.uppy.on("resume-all",k),i=()=>{this.uppy.off("file-removed",f),this.uppy.off("cancel-all",b),this.uppy.off("upload-pause",S),this.uppy.off("pause-all",A),this.uppy.off("resume-all",k)},n.addEventListener("abort",()=>{h?.abort()}),C()})}finally{i?.()}},w(Jd,"VERSION",Wy.version);var tt,Fn;class ev{constructor(e){T(this,tt);T(this,Fn,[]);j(this,tt,e)}on(e,t){return m(this,Fn).push([e,t]),m(this,tt).on(e,t)}remove(){for(const[e,t]of m(this,Fn).splice(0))m(this,tt).off(e,t)}onFilePause(e,t){this.on("upload-pause",(n,i)=>{e===n?.id&&t(i)})}onFileRemove(e,t){this.on("file-removed",n=>{e===n.id&&t(n.id)})}onPause(e,t){this.on("upload-pause",(n,i)=>{e===n?.id&&t(i)})}onRetry(e,t){this.on("upload-retry",n=>{e===n?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{m(this,tt).getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{m(this,tt).getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...n)=>{m(this,tt).getFile(e)&&t(...n)})}onResumeAll(e,t){this.on("resume-all",()=>{m(this,tt).getFile(e)&&t()})}}tt=new WeakMap,Fn=new WeakMap;const{AbortController:wr}=globalThis,Qd=(s="Aborted",e)=>{const t=new DOMException(s,"AbortError");return e!=null&&Xd(e,"cause")&&Object.defineProperty(t,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t};function tv(s){const e=t=>"error"in t&&!!t.error;return s.filter(t=>!e(t))}function sv(s){return s.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}function _l(s,e){return s===!0?Object.keys(e):Array.isArray(s)?s:[]}function nv(s){return new Error("Cancelled",{cause:s})}function Sl(s){if(s!=null){const e=()=>this.abort(s.reason);s.addEventListener("abort",e,{once:!0});const t=()=>{s.removeEventListener("abort",e)};this.then?.(t,t)}return this}var ht,st,pt,xs,nt,Cs,zt,ge,ya,tn,Zd,eu,tu,Bi,_s;class iv{constructor(e){T(this,ge);T(this,ht,0);T(this,st,[]);T(this,pt,!1);T(this,xs);T(this,nt,1);T(this,Cs);T(this,zt);w(this,"limit");T(this,Bi,()=>this.resume());T(this,_s,()=>{if(m(this,pt)){j(this,zt,setTimeout(m(this,_s),0));return}j(this,nt,this.limit),this.limit=Math.ceil((m(this,Cs)+m(this,nt))/2);for(let e=m(this,nt);e<=this.limit;e++)R(this,ge,tn).call(this);m(this,Cs)-m(this,nt)>3?j(this,zt,setTimeout(m(this,_s),2e3)):j(this,nt,Math.floor(m(this,nt)/2))});typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,t){return!m(this,pt)&&m(this,ht)<this.limit?R(this,ge,ya).call(this,e):R(this,ge,eu).call(this,e,t)}wrapSyncFunction(e,t){return(...n)=>{const i=this.run(()=>(e(...n),queueMicrotask(()=>i.done()),()=>{}),t);return{abortOn:Sl,abort(){i.abort()}}}}wrapPromiseFunction(e,t){return(...n)=>{let i;const r=new Promise((a,o)=>{i=this.run(()=>{let c,d;try{d=Promise.resolve(e(...n))}catch(u){d=Promise.reject(u)}return d.then(u=>{c?o(c):(i.done(),a(u))},u=>{c?o(c):(i.done(),o(u))}),u=>{c=nv(u)}},t)});return r.abort=a=>{i.abort(a)},r.abortOn=Sl,r}}resume(){j(this,pt,!1),clearTimeout(m(this,xs));for(let e=0;e<this.limit;e++)R(this,ge,tn).call(this)}pause(e=null){j(this,pt,!0),clearTimeout(m(this,xs)),e!=null&&j(this,xs,setTimeout(m(this,Bi),e))}rateLimit(e){clearTimeout(m(this,zt)),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(j(this,Cs,this.limit-1),this.limit=m(this,nt),j(this,zt,setTimeout(m(this,_s),e)))}get isPaused(){return m(this,pt)}}ht=new WeakMap,st=new WeakMap,pt=new WeakMap,xs=new WeakMap,nt=new WeakMap,Cs=new WeakMap,zt=new WeakMap,ge=new WeakSet,ya=function(e){j(this,ht,m(this,ht)+1);let t=!1,n;try{n=e()}catch(i){throw j(this,ht,m(this,ht)-1),i}return{abort:i=>{t||(t=!0,j(this,ht,m(this,ht)-1),n?.(i),R(this,ge,tn).call(this))},done:()=>{t||(t=!0,j(this,ht,m(this,ht)-1),R(this,ge,tn).call(this))}}},tn=function(){queueMicrotask(()=>R(this,ge,Zd).call(this))},Zd=function(){if(m(this,pt)||m(this,ht)>=this.limit||m(this,st).length===0)return;const e=m(this,st).shift();if(e==null)throw new Error("Invariant violation: next is null");const t=R(this,ge,ya).call(this,e.fn);e.abort=t.abort,e.done=t.done},eu=function(e,t){const n={fn:e,priority:t?.priority||0,abort:()=>{R(this,ge,tu).call(this,n)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},i=m(this,st).findIndex(r=>n.priority>r.priority);return i===-1?m(this,st).push(n):m(this,st).splice(i,0,n),n},tu=function(e){const t=m(this,st).indexOf(e);t!==-1&&m(this,st).splice(t,1)},Bi=new WeakMap,_s=new WeakMap;const rv="4.3.2",av={version:rv};function ov({method:s="PUT",CanonicalUri:e="/",CanonicalQueryString:t="",SignedHeaders:n,HashedPayload:i}){const r=Object.keys(n).map(a=>a.toLowerCase()).sort();return[s,e,t,...r.map(a=>`${a}:${n[a]}`),"",r.join(";"),i].join(`
`)}const Ha=new TextEncoder,qa={name:"HMAC",hash:"SHA-256"};async function lv(s){const{subtle:e}=globalThis.crypto;return e.digest(qa.hash,Ha.encode(s))}async function cv(s){const{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof s=="string"?Ha.encode(s):s,qa,!1,["sign"])}function El(s){const e=new Uint8Array(s);let t="";for(let n=0;n<e.length;n++)t+=e[n].toString(16).padStart(2,"0");return t}async function Xs(s,e){const{subtle:t}=globalThis.crypto;return t.sign(qa,await cv(s),Ha.encode(e))}async function dv({accountKey:s,accountSecret:e,sessionToken:t,bucketName:n,Key:i,Region:r,expires:a,uploadId:o,partNumber:c}){const d="s3",u=`${d}.${r}.amazonaws.com`,h=`/${n}/${encodeURI(i).replace(/[;?:@&=+$,#!'()*]/g,U=>`%${U.charCodeAt(0).toString(16).toUpperCase()}`)}`,v="UNSIGNED-PAYLOAD",y=new Date().toISOString().replace(/[-:]|\.\d+/g,""),x=y.slice(0,8),_=`${x}/${r}/${d}/aws4_request`,C=new URL(`https://${u}${h}`);C.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),C.searchParams.set("X-Amz-Content-Sha256",v),C.searchParams.set("X-Amz-Credential",`${s}/${_}`),C.searchParams.set("X-Amz-Date",y),C.searchParams.set("X-Amz-Expires",a),C.searchParams.set("X-Amz-Security-Token",t),C.searchParams.set("X-Amz-SignedHeaders","host"),c&&C.searchParams.set("partNumber",c),o&&C.searchParams.set("uploadId",o),C.searchParams.set("x-id",c&&o?"UploadPart":"PutObject");const N=ov({CanonicalUri:h,CanonicalQueryString:C.search.slice(1),SignedHeaders:{host:u},HashedPayload:v}),f=El(await lv(N)),b=["AWS4-HMAC-SHA256",y,_,f].join(`
`),S=await Xs(`AWS4${e}`,x),A=await Xs(S,r),k=await Xs(A,d),P=await Xs(k,"aws4_request"),D=El(await Xs(P,b));return C.searchParams.set("X-Amz-Signature",D),C}const uv=1024*1024,Fl={getChunkSize(s){return Math.ceil(s.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(s){throw s}};function hv(s){if(typeof s=="string")return parseInt(s,10);if(typeof s=="number")return s;throw new TypeError("Expected a number")}const Ci=Symbol("pausing upload, not an actual error");var Ue,Te,it,ft,mt,Pn,Nn,Ss,Ht,Es,kn,Fs,Tn,Ge,su,nu,va,An,Rn,iu;class pv{constructor(e,t){T(this,Ge);w(this,"options");T(this,Ue,new wr);T(this,Te,[]);T(this,it,[]);T(this,ft);T(this,mt);T(this,Pn,!1);T(this,Nn);T(this,Ss);T(this,Ht);T(this,Es);T(this,kn,e=>e?.cause===Ci?null:m(this,Nn).call(this,e));T(this,Fs,1e4);T(this,Tn,5*uv);T(this,An,e=>t=>{if(!t.lengthComputable)return;m(this,it)[e].uploaded=hv(t.loaded);const n=m(this,it).reduce((i,r)=>i+r.uploaded,0);this.options.onProgress(n,m(this,ft).size)});T(this,Rn,e=>t=>{m(this,Te)[e]=null,m(this,it)[e].etag=t,m(this,it)[e].done=!0;const n={PartNumber:e+1,ETag:t};this.options.onPartComplete(n)});var n;this.options={...Fl,...t},(n=this.options).getChunkSize??(n.getChunkSize=Fl.getChunkSize),j(this,ft,e),j(this,mt,t.file),j(this,Ss,this.options.onSuccess),j(this,Nn,this.options.onError),j(this,Ht,this.options.shouldUseMultipart),j(this,Es,t.uploadId&&t.key),R(this,Ge,su).call(this)}start(){m(this,Pn)?(m(this,Ue).signal.aborted||m(this,Ue).abort(Ci),j(this,Ue,new wr),R(this,Ge,va).call(this)):m(this,Es)?(this.options.companionComm.restoreUploadFile(m(this,mt),{uploadId:this.options.uploadId,key:this.options.key}),R(this,Ge,va).call(this)):R(this,Ge,nu).call(this)}pause(){m(this,Ue).abort(Ci),j(this,Ue,new wr)}abort(e){e?.really?R(this,Ge,iu).call(this):this.pause()}[Symbol.for("uppy test: getChunkState")](){return m(this,it)}}Ue=new WeakMap,Te=new WeakMap,it=new WeakMap,ft=new WeakMap,mt=new WeakMap,Pn=new WeakMap,Nn=new WeakMap,Ss=new WeakMap,Ht=new WeakMap,Es=new WeakMap,kn=new WeakMap,Fs=new WeakMap,Tn=new WeakMap,Ge=new WeakSet,su=function(){const e=m(this,ft).size,t=typeof m(this,Ht)=="function"?m(this,Ht).call(this,m(this,mt)):!!m(this,Ht);if(t&&e>m(this,Tn)){let n=Math.max(this.options.getChunkSize(m(this,ft)),m(this,Tn)),i=Math.floor(e/n);i>m(this,Fs)&&(i=m(this,Fs),n=e/m(this,Fs)),j(this,Te,Array(i));for(let r=0,a=0;r<e;r+=n,a++){const o=Math.min(e,r+n),c=()=>{const d=r;return m(this,ft).slice(d,o)};if(m(this,Te)[a]={getData:c,onProgress:m(this,An).call(this,a),onComplete:m(this,Rn).call(this,a),shouldUseMultipart:t},m(this,Es)){const d=r+n>e?e-r:n;m(this,Te)[a].setAsUploaded=()=>{m(this,Te)[a]=null,m(this,it)[a].uploaded=d}}}}else j(this,Te,[{getData:()=>m(this,ft),onProgress:m(this,An).call(this,0),onComplete:m(this,Rn).call(this,0),shouldUseMultipart:t}]);j(this,it,m(this,Te).map(()=>({uploaded:0})))},nu=function(){this.options.companionComm.uploadFile(m(this,mt),m(this,Te),m(this,Ue).signal).then(m(this,Ss),m(this,kn)),j(this,Pn,!0)},va=function(){this.options.companionComm.resumeUploadFile(m(this,mt),m(this,Te),m(this,Ue).signal).then(m(this,Ss),m(this,kn))},An=new WeakMap,Rn=new WeakMap,iu=function(){m(this,Ue).abort(),this.options.companionComm.abortFileUpload(m(this,mt)).catch(e=>this.options.log(e))};function me(s){if(s?.aborted)throw Qd("The operation was aborted",{cause:s.reason})}function fv(s){const e=new URL(s);return e.search="",e.hash="",e.href}var Dn,Me,jn,On,Un,Mn,Ps,Ns,ks,Ts,qt,As,Ie,Gt,ru,ba;class mv{constructor(e,t,n,i){T(this,Gt);T(this,Dn);T(this,Me,new WeakMap);T(this,jn);T(this,On);T(this,Un);T(this,Mn);T(this,Ps);T(this,Ns);T(this,ks);T(this,Ts);T(this,qt);T(this,As);T(this,Ie);j(this,Ns,e),j(this,qt,n),j(this,Ie,i),this.setOptions(t)}setOptions(e){const t=m(this,Ns);"abortMultipartUpload"in e&&j(this,Dn,t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&j(this,jn,t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&j(this,On,t.wrapPromiseFunction(e.signPart)),"listParts"in e&&j(this,Mn,t.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&j(this,Ts,t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e&&j(this,ks,e.retryDelays??[]),"uploadPartBytes"in e&&j(this,As,t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&j(this,Un,t.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,t){let n;for(;n=m(this,Me).get(e.data),n!=null;)try{return await n}catch{}const i=m(this,jn).call(this,m(this,Ie).call(this,e),t),r=()=>{i.abort(t.reason),m(this,Me).delete(e.data)};return t.addEventListener("abort",r,{once:!0}),m(this,Me).set(e.data,i),i.then(async a=>{t.removeEventListener("abort",r),m(this,qt).call(this,e,a),m(this,Me).set(e.data,a)},()=>{t.removeEventListener("abort",r),m(this,Me).delete(e.data)}),i}async abortFileUpload(e){const t=m(this,Me).get(e.data);if(t==null)return;m(this,Me).delete(e.data),m(this,qt).call(this,e,Object.create(null));let n;try{n=await t}catch{return}await m(this,Dn).call(this,m(this,Ie).call(this,e),n)}async uploadFile(e,t,n){if(me(n),t.length===1&&!t[0].shouldUseMultipart)return R(this,Gt,ba).call(this,e,t[0],n);const{uploadId:i,key:r}=await this.getUploadId(e,n);me(n);try{const a=await Promise.all(t.map((o,c)=>this.uploadChunk(e,c+1,o,n)));return me(n),await m(this,Ts).call(this,m(this,Ie).call(this,e),{key:r,uploadId:i,parts:a,signal:n},n).abortOn(n)}catch(a){throw a?.cause!==Ci&&a?.name!=="AbortError"&&this.abortFileUpload(e),a}}restoreUploadFile(e,t){m(this,Me).set(e.data,t)}async resumeUploadFile(e,t,n){if(me(n),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return R(this,Gt,ba).call(this,e,t[0],n);const{uploadId:i,key:r}=await this.getUploadId(e,n);me(n);const a=await m(this,Mn).call(this,m(this,Ie).call(this,e),{uploadId:i,key:r,signal:n},n).abortOn(n);me(n);const o=await Promise.all(t.map((c,d)=>{const u=d+1,h=a.find(({PartNumber:v})=>v===u);return h==null?this.uploadChunk(e,u,c,n):(c?.setAsUploaded?.(),{PartNumber:u,ETag:h.ETag})}));return me(n),m(this,Ts).call(this,m(this,Ie).call(this,e),{key:r,uploadId:i,parts:o,signal:n},n).abortOn(n)}async uploadChunk(e,t,n,i){me(i);const{uploadId:r,key:a}=await this.getUploadId(e,i),o=m(this,ks).values(),c=m(this,ks).values(),d=()=>{const u=o.next();return u==null||u.done?null:u.value};for(;;){me(i);const u=n.getData(),{onProgress:h,onComplete:v}=n;let y;try{y=await m(this,On).call(this,m(this,Ie).call(this,e),{uploadId:r,key:a,partNumber:t,body:u,signal:i}).abortOn(i)}catch(x){const _=d();if(_==null||i.aborted)throw x;await new Promise(C=>setTimeout(C,_));continue}me(i);try{return{PartNumber:t,...await m(this,As).call(this,{signature:y,body:u,size:u.size,onProgress:h,onComplete:v,signal:i}).abortOn(i)}}catch(x){if(!await R(this,Gt,ru).call(this,x,c))throw x}}}}Dn=new WeakMap,Me=new WeakMap,jn=new WeakMap,On=new WeakMap,Un=new WeakMap,Mn=new WeakMap,Ps=new WeakMap,Ns=new WeakMap,ks=new WeakMap,Ts=new WeakMap,qt=new WeakMap,As=new WeakMap,Ie=new WeakMap,Gt=new WeakSet,ru=async function(e,t){const n=m(this,Ns),i=e?.source?.status;if(i==null)return!1;if(i===403&&e.message==="Request has expired"){if(!n.isPaused){if(n.limit===1||m(this,Ps)==null){const r=t.next();if(r==null||r.done)return!1;j(this,Ps,r.value)}n.rateLimit(0),await new Promise(r=>setTimeout(r,m(this,Ps)))}}else if(i===429){if(!n.isPaused){const r=t.next();if(r==null||r.done)return!1;n.rateLimit(r.value)}}else{if(i>400&&i<500&&i!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)n.isPaused||(n.pause(),window.addEventListener("online",()=>{n.resume()},{once:!0}));else{const r=t.next();if(r==null||r.done)return!1;await new Promise(a=>setTimeout(a,r.value))}}return!0},ba=async function(e,t,n){const{method:i="POST",url:r,fields:a,headers:o}=await m(this,Un).call(this,m(this,Ie).call(this,e),{signal:n}).abortOn(n);let c;const d=t.getData();if(i.toUpperCase()==="POST"){const x=new FormData;Object.entries(a).forEach(([_,C])=>x.set(_,C)),x.set("file",d),c=x}else c=d;const{onProgress:u,onComplete:h}=t,v=await m(this,As).call(this,{signature:{url:r,headers:o,method:i},body:c,size:d.size,onProgress:u,onComplete:h,signal:n}).abortOn(n),y=a?.key;return m(this,qt).call(this,e,{key:y}),{...v,location:v.location??fv(r),bucket:a?.bucket,key:y}};function ls(s){if(s?.error){const e=new Error(s.message);throw Object.assign(e,s.error),e}return s}function Pl(s){const e=s.Expiration;if(e){const t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}function Nl({meta:s,allowedMetaFields:e,querify:t=!1}){const n=e??Object.keys(s);return s?Object.fromEntries(n.filter(i=>s[i]!=null).map(i=>{const r=t?`metadata[${i}]`:i,a=String(s[i]);return[r,a]})):{}}const gv={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:s=>(s.size||0)>100*1024*1024,retryDelays:[0,1e3,3e3,5e3]};var Rs,ve,ae,xa,_t,Le,au,zi,Ds,ou,lu,In,js,Vt,Ln;const Hi=class Hi extends zc{constructor(t,n){super(t,{...gv,uploadPartBytes:Hi.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...n});T(this,ae);T(this,Rs);T(this,ve);w(this,"requests");w(this,"uploaderEvents");w(this,"uploaders");T(this,Le);T(this,zi,(t,{key:n,uploadId:i})=>{const r=this.uppy.getFile(t.id);r!=null&&this.uppy.setFileState(t.id,{s3Multipart:{...r.s3Multipart,key:n,uploadId:i}})});T(this,Ds,t=>this.uppy.getFile(t.id)||t);T(this,In,async t=>{if(t.length===0)return;const n=this.uppy.getFilesByIds(t),i=tv(n),r=sv(i);this.uppy.emit("upload-start",r);const a=i.map(c=>{if(c.isRemote){const d=()=>this.requests;m(this,Vt).call(this,!1);const u=new AbortController,h=y=>{y.id===c.id&&u.abort()};this.uppy.on("file-removed",h);const v=this.uppy.getRequestClientForFile(c).uploadRemoteFile(c,R(this,ae,lu).call(this,c),{signal:u.signal,getQueue:d});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",h)},{priority:-1})(),v}return R(this,ae,ou).call(this,c)}),o=await Promise.allSettled(a);return m(this,Vt).call(this,!0),o});T(this,js,()=>{m(this,ve)?.setCompanionHeaders(this.opts.headers)});T(this,Vt,t=>{const{capabilities:n}=this.uppy.getState();this.uppy.setState({capabilities:{...n,resumableUploads:t}})});T(this,Ln,()=>{m(this,Vt).call(this,!0)});this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",R(this,ae,xa).call(this,n);const i={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:n?.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:n?.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const r of Object.keys(i))this.opts[r]==null&&(this.opts[r]=i[r].bind(this));this.requests=this.opts.rateLimitedQueue??new iv(this.opts.limit),j(this,Rs,new mv(this.requests,this.opts,m(this,zi),m(this,Ds))),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return m(this,ve)}setOptions(t){m(this,Rs).setOptions(t),super.setOptions(t),R(this,ae,xa).call(this,t)}resetUploaderReferences(t,n){this.uploaders[t]&&(this.uploaders[t].abort({really:n?.abort||!1}),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null)}createMultipartUpload(t,n){R(this,ae,_t).call(this,"createMultipartUpload"),me(n);const i=_l(this.opts.allowedMetaFields,t.meta),r=Nl({meta:t.meta,allowedMetaFields:i});return m(this,ve).post("s3/multipart",{filename:t.name,type:t.type,metadata:r},{signal:n}).then(ls)}listParts(t,{key:n,uploadId:i,signal:r},a){r??(r=a),R(this,ae,_t).call(this,"listParts"),me(r);const o=encodeURIComponent(n);return m(this,ve).get(`s3/multipart/${encodeURIComponent(i)}?key=${o}`,{signal:r}).then(ls)}completeMultipartUpload(t,{key:n,uploadId:i,parts:r,signal:a},o){a??(a=o),R(this,ae,_t).call(this,"completeMultipartUpload"),me(a);const c=encodeURIComponent(n),d=encodeURIComponent(i);return m(this,ve).post(`s3/multipart/${d}/complete?key=${c}`,{parts:r.map(({ETag:u,PartNumber:h})=>({ETag:u,PartNumber:h}))},{signal:a}).then(ls)}async createSignedURL(t,n){const i=await R(this,ae,au).call(this,n),r=Pl(i.credentials)||604800,{uploadId:a,key:o,partNumber:c}=n;return{method:"PUT",expires:r,fields:{},url:`${await dv({accountKey:i.credentials.AccessKeyId,accountSecret:i.credentials.SecretAccessKey,sessionToken:i.credentials.SessionToken,expires:r,bucketName:i.bucket,Region:i.region,Key:o??`${crypto.randomUUID()}-${t.name}`,uploadId:a,partNumber:c})}`,headers:{"Content-Type":t.type}}}signPart(t,{uploadId:n,key:i,partNumber:r,signal:a}){if(R(this,ae,_t).call(this,"signPart"),me(a),n==null||i==null||r==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const o=encodeURIComponent(i);return m(this,ve).get(`s3/multipart/${encodeURIComponent(n)}/${r}?key=${o}`,{signal:a}).then(ls)}abortMultipartUpload(t,{key:n,uploadId:i,signal:r}){R(this,ae,_t).call(this,"abortMultipartUpload");const a=encodeURIComponent(n),o=encodeURIComponent(i);return m(this,ve).delete(`s3/multipart/${o}?key=${a}`,void 0,{signal:r}).then(ls)}getUploadParameters(t,n){R(this,ae,_t).call(this,"getUploadParameters");const{meta:i}=t,{type:r,name:a}=i,o=_l(this.opts.allowedMetaFields,t.meta),c=Nl({meta:i,allowedMetaFields:o,querify:!0}),d=new URLSearchParams({filename:a,type:r,...c});return m(this,ve).get(`s3/params?${d}`,n)}static async uploadPartBytes({signature:{url:t,expires:n,headers:i,method:r="PUT"},body:a,size:o=a.size,onProgress:c,onComplete:d,signal:u}){if(me(u),t==null)throw new Error("Cannot upload to an undefined URL");return new Promise((h,v)=>{const y=new XMLHttpRequest;y.open(r,t,!0),i&&Object.keys(i).forEach(C=>{y.setRequestHeader(C,i[C])}),y.responseType="text",typeof n=="number"&&(y.timeout=n*1e3);function x(){y.abort()}function _(){u?.removeEventListener("abort",x)}u?.addEventListener("abort",x),y.upload.addEventListener("progress",C=>{c(C)}),y.addEventListener("abort",()=>{_(),v(Qd())}),y.addEventListener("timeout",()=>{_();const C=new Error("Request has expired");C.source={status:403},v(C)}),y.addEventListener("load",()=>{if(_(),y.status===403&&y.responseText.includes("<Message>Request has expired</Message>")){const S=new Error("Request has expired");S.source=y,v(S);return}if(y.status<200||y.status>=300){const S=new Error("Non 2xx");S.source=y,v(S);return}c?.({loaded:o,lengthComputable:!0});const C=y.getAllResponseHeaders().trim().split(/[\r\n]+/),N={__proto__:null};for(const S of C){const A=S.split(": "),k=A.shift(),P=A.join(": ");N[k]=P}const{etag:f,location:b}=N;if(r.toUpperCase()==="POST"&&b==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),f==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}d?.(f),h({...N,ETag:f})}),y.addEventListener("error",C=>{_();const N=new Error("Unknown error");N.source=C.target,v(N)}),y.send(a)})}install(){m(this,Vt).call(this,!0),this.uppy.addPreProcessor(m(this,js)),this.uppy.addUploader(m(this,In)),this.uppy.on("cancel-all",m(this,Ln))}uninstall(){this.uppy.removePreProcessor(m(this,js)),this.uppy.removeUploader(m(this,In)),this.uppy.off("cancel-all",m(this,Ln))}};Rs=new WeakMap,ve=new WeakMap,ae=new WeakSet,xa=function(t){t==null||!("endpoint"in t||"companionUrl"in t||"headers"in t||"companionHeaders"in t||"cookiesRule"in t||"companionCookiesRule"in t)||("companionUrl"in t&&!("endpoint"in t)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in t&&!("headers"in t)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in t&&!("cookiesRule"in t)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in t?j(this,ve,new Jd(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule})):("headers"in t&&m(this,js).call(this),"cookiesRule"in t&&(m(this,ve).opts.companionCookiesRule=t.cookiesRule)))},_t=function(t){if(!m(this,ve))throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${t}\` implementation.`)},Le=new WeakMap,au=async function(t){if(me(t?.signal),m(this,Le)==null){const{getTemporarySecurityCredentials:n}=this.opts;n===!0?(R(this,ae,_t).call(this,"getTemporarySecurityCredentials"),j(this,Le,m(this,ve).get("s3/sts",t).then(ls))):j(this,Le,n(t)),j(this,Le,await m(this,Le)),setTimeout(()=>{j(this,Le,null)},(Pl(m(this,Le).credentials)||0)*500)}return m(this,Le)},zi=new WeakMap,Ds=new WeakMap,ou=function(t){return new Promise((n,i)=>{const r=(u,h)=>{const v=this.uppy.getFile(t.id);this.uppy.emit("upload-progress",v,{uploadStarted:v.progress.uploadStarted??0,bytesUploaded:u,bytesTotal:h})},a=u=>{this.uppy.log(u),this.uppy.emit("upload-error",t,u),this.resetUploaderReferences(t.id),i(u)},o=u=>{const h={body:{...u},status:200,uploadURL:u.location};this.resetUploaderReferences(t.id),this.uppy.emit("upload-success",m(this,Ds).call(this,t),h),u.location&&this.uppy.log(`Download ${t.name} from ${u.location}`),n(void 0)},c=new pv(t.data,{companionComm:m(this,Rs),log:(...u)=>this.uppy.log(...u),getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:r,onError:a,onSuccess:o,onPartComplete:u=>{this.uppy.emit("s3-multipart:part-uploaded",m(this,Ds).call(this,t),u)},file:t,shouldUseMultipart:this.opts.shouldUseMultipart,...t.s3Multipart});this.uploaders[t.id]=c;const d=new ev(this.uppy);this.uploaderEvents[t.id]=d,d.onFileRemove(t.id,u=>{c.abort(),this.resetUploaderReferences(t.id,{abort:!0}),n(`upload ${u} was removed`)}),d.onCancelAll(t.id,()=>{c.abort(),this.resetUploaderReferences(t.id,{abort:!0}),n(`upload ${t.id} was canceled`)}),d.onFilePause(t.id,u=>{u?c.pause():c.start()}),d.onPauseAll(t.id,()=>{c.pause()}),d.onResumeAll(t.id,()=>{c.start()}),c.start()})},lu=function(t){return{...t.remote?.body,protocol:"s3-multipart",size:t.data.size,metadata:t.meta}},In=new WeakMap,js=new WeakMap,Vt=new WeakMap,Ln=new WeakMap,w(Hi,"VERSION",av.version);let wa=Hi;function kl({maxNumberOfFiles:s=1,maxFileSize:e=10485760,onGetUploadParameters:t,onComplete:n,buttonClassName:i,children:r}){const[a,o]=g.useState(!1),[c]=g.useState(()=>new Jr({restrictions:{maxNumberOfFiles:s,maxFileSize:e},autoProceed:!1}).use(wa,{shouldUseMultipart:!1,getUploadParameters:t}).on("complete",d=>{n?.(d)}));return l.jsxs("div",{children:[l.jsx(se,{onClick:()=>o(!0),className:i,type:"button",children:r}),l.jsx(Kd,{uppy:c,open:a,onRequestClose:()=>o(!1),proudlyDisplayPoweredByUppy:!1})]})}const Tl=["gambling","dating","crypto","betting","e-commerce","gaming","finance","health","vpn","antivirus","education","software","mobile_apps","nutra","beauty"],Al=[{code:"afghanistan",name:"🇦🇫 Афганистан"},{code:"albania",name:"🇦🇱 Албания"},{code:"algeria",name:"🇩🇿 Алжир"},{code:"andorra",name:"🇦🇩 Андорра"},{code:"angola",name:"🇦🇴 Ангола"},{code:"argentina",name:"🇦🇷 Аргентина"},{code:"armenia",name:"🇦🇲 Армения"},{code:"australia",name:"🇦🇺 Австралия"},{code:"austria",name:"🇦🇹 Австрия"},{code:"azerbaijan",name:"🇦🇿 Азербайджан"},{code:"bahrain",name:"🇧🇭 Бахрейн"},{code:"bangladesh",name:"🇧🇩 Бангладеш"},{code:"belarus",name:"🇧🇾 Беларусь"},{code:"belgium",name:"🇧🇪 Бельгия"},{code:"bolivia",name:"🇧🇴 Боливия"},{code:"brazil",name:"🇧🇷 Бразилия"},{code:"bulgaria",name:"🇧🇬 Болгария"},{code:"cambodia",name:"🇰🇭 Камбоджа"},{code:"canada",name:"🇨🇦 Канада"},{code:"chile",name:"🇨🇱 Чили"},{code:"china",name:"🇨🇳 Китай"},{code:"colombia",name:"🇨🇴 Колумбия"},{code:"croatia",name:"🇭🇷 Хорватия"},{code:"cyprus",name:"🇨🇾 Кипр"},{code:"czech",name:"🇨🇿 Чехия"},{code:"denmark",name:"🇩🇰 Дания"},{code:"ecuador",name:"🇪🇨 Эквадор"},{code:"egypt",name:"🇪🇬 Египет"},{code:"estonia",name:"🇪🇪 Эстония"},{code:"finland",name:"🇫🇮 Финляндия"},{code:"france",name:"🇫🇷 Франция"},{code:"germany",name:"🇩🇪 Германия"},{code:"greece",name:"🇬🇷 Греция"},{code:"hungary",name:"🇭🇺 Венгрия"},{code:"india",name:"🇮🇳 Индия"},{code:"indonesia",name:"🇮🇩 Индонезия"},{code:"italy",name:"🇮🇹 Италия"},{code:"japan",name:"🇯🇵 Япония"},{code:"malaysia",name:"🇲🇾 Малайзия"},{code:"mexico",name:"🇲🇽 Мексика"},{code:"netherlands",name:"🇳🇱 Нидерланды"},{code:"poland",name:"🇵🇱 Польша"},{code:"portugal",name:"🇵🇹 Португалия"},{code:"russia",name:"🇷🇺 Россия"},{code:"spain",name:"🇪🇸 Испания"},{code:"sweden",name:"🇸🇪 Швеция"},{code:"switzerland",name:"🇨🇭 Швейцария"},{code:"thailand",name:"🇹🇭 Таиланд"},{code:"turkey",name:"🇹🇷 Турция"},{code:"ukraine",name:"🇺🇦 Украина"},{code:"united_kingdom",name:"🇬🇧 Великобритания"},{code:"united_states",name:"🇺🇸 США"},{code:"vietnam",name:"🇻🇳 Вьетнам"}],yv=["Google Ads","Facebook Ads","TikTok Ads","Snapchat Ads","Push Notifications","Pop-under","Banner","Native","Instagram","YouTube Ads","UAC","SEO","Email","WhatsApp","Telegram","Motivated","In-App","Cloaking","Display","Video","Affiliate","Direct","Contextual"],vv=["Web Browser","Mobile App","Desktop Application","Browser Extension","Progressive Web App","Hybrid App","Native Mobile","Cross-Platform"],bv=["Adult Traffic","Malware Distribution","Click Injection","Fraudulent Sources","Bot Traffic","Incentivized Traffic"],wv=[{value:"desktop",label:"Desktop"},{value:"mobile",label:"Mobile"},{value:"tablet",label:"Tablet"},{value:"smarttv",label:"Smart TV"},{value:"console",label:"Console"}],xv=[{value:"ip_filtering",label:"IP фильтрация",description:"Блокировка подозрительных IP адресов"},{value:"device_fingerprinting",label:"Отпечатки устройств",description:"Анализ уникальных характеристик устройства"},{value:"behavioral_analysis",label:"Анализ поведения",description:"Отслеживание паттернов поведения пользователей"},{value:"geo_verification",label:"Проверка геолокации",description:"Верификация реального местоположения"},{value:"rate_limiting",label:"Лимит запросов",description:"Ограничение частоты запросов от одного источника"},{value:"bot_detection",label:"Детекция ботов",description:"Выявление автоматизированного трафика"}],Cv=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"€"},{code:"RUB",name:"Russian Ruble",symbol:"₽"},{code:"UAH",name:"Ukrainian Hryvnia",symbol:"₴"},{code:"GBP",name:"British Pound",symbol:"£"},{code:"JPY",name:"Japanese Yen",symbol:"¥"},{code:"BRL",name:"Brazilian Real",symbol:"R$"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"},{code:"CHF",name:"Swiss Franc",symbol:"CHF"},{code:"SEK",name:"Swedish Krona",symbol:"kr"},{code:"NOK",name:"Norwegian Krone",symbol:"kr"},{code:"PLN",name:"Polish Zloty",symbol:"zł"},{code:"CZK",name:"Czech Koruna",symbol:"Kč"},{code:"HUF",name:"Hungarian Forint",symbol:"Ft"}],_v=({offer:s,onClose:e,onSave:t})=>{const{toast:n}=$l(),[i,r]=g.useState({name:s.name||"",description:{ru:s.description?.ru||s.description||"",en:s.description?.en||""},category:s.category||"",logo:s.logo||"",image:s.image||"",geoTargeting:s.geoTargeting||[],targetUrl:s.targetUrl||s.url||"",postbackUrl:s.postbackUrl||"",hasGlobalGeoSetting:s.hasGlobalGeoSetting||!1,hasGlobalPayoutSetting:s.hasGlobalPayoutSetting||!1,globalGeo:s.globalGeo||"",globalPayout:s.globalPayout||"",landingPages:s.landingPages||[{id:"1",name:"Основная",url:s.url||"",geo:"",payout:"",hasCustomGeo:!1,hasCustomPayout:!1,isDefault:!0}],payoutType:s.payoutType||"cpa",payoutAmount:s.payout||s.payoutAmount||0,currency:s.currency||"USD",trafficSources:s.trafficSources||[],allowedApplications:s.allowedApplications||[],dailyLimit:s.dailyLimit||s.cap||0,monthlyLimit:s.monthlyLimit||0,antifraudEnabled:s.antifraudEnabled!==void 0?s.antifraudEnabled:!0,antifraudMethods:s.antifraudMethods||["ip_check","vpn_detection"],partnerApprovalType:s.partnerApprovalType||"manual",kycRequired:s.kycRequired||!1,isPrivate:s.isPrivate||!1,tags:s.tags||[],notes:s.notes||"",requiresApproval:s.requiresApproval||!1,trackingEnabled:s.trackingEnabled!==void 0?s.trackingEnabled:!0,saveAsTemplate:!1,kpi:s.kpi||"",status:s.status||"active"}),[a,o]=g.useState(!1),[c,d]=g.useState(!1),u=()=>{const f=(i.landingPages.length+1).toString(),b={id:f,name:`Лендинг ${f}`,url:"",geo:i.hasGlobalGeoSetting?i.globalGeo:"",payout:i.hasGlobalPayoutSetting?i.globalPayout:"",hasCustomGeo:!i.hasGlobalGeoSetting,hasCustomPayout:!i.hasGlobalPayoutSetting,isDefault:!1};r(S=>({...S,landingPages:[...S.landingPages,b]}))},h=f=>{i.landingPages.length>1&&r(b=>({...b,landingPages:b.landingPages.filter(S=>S.id!==f)}))},v=(f,b,S)=>{r(A=>({...A,landingPages:A.landingPages.map(k=>k.id===f?{...k,[b]:S}:k)}))},y=f=>{const b=i.trafficSources.includes(f);r(S=>({...S,trafficSources:b?S.trafficSources.filter(A=>A!==f):[...S.trafficSources,f]}))},x=f=>{const b=i.allowedApplications.includes(f);r(S=>({...S,allowedApplications:b?S.allowedApplications.filter(A=>A!==f):[...S.allowedApplications,f]}))},_=f=>{const b=i.antifraudMethods.includes(f);r(S=>({...S,antifraudMethods:b?S.antifraudMethods.filter(A=>A!==f):[...S.antifraudMethods,f]}))},C=f=>{const b=i.geoTargeting.includes(f);r(S=>({...S,geoTargeting:b?S.geoTargeting.filter(A=>A!==f):[...S.geoTargeting,f]}))},N=()=>{if(!i.name.trim()){n({title:"Ошибка",description:"Укажите название оффера",variant:"destructive"});return}if(!i.targetUrl.trim()){n({title:"Ошибка",description:"Укажите целевую URL",variant:"destructive"});return}if(i.geoTargeting.length===0){n({title:"Ошибка",description:"Выберите хотя бы одну страну для таргетинга",variant:"destructive"});return}const f={...s,...i,url:i.targetUrl,payout:i.payoutAmount,cap:i.dailyLimit};t(f),e()};return l.jsx(zl,{open:!0,onOpenChange:e,children:l.jsxs(Hl,{className:"max-w-7xl max-h-[95vh] overflow-y-auto",children:[l.jsx(ql,{children:l.jsxs(Vl,{className:"flex items-center gap-2",children:[l.jsx(Qi,{className:"h-5 w-5"}),"Редактировать оффер: ",i.name||"Без названия"]})}),l.jsxs(Iu,{defaultValue:"basic",className:"w-full",children:[l.jsxs(Lu,{className:"grid w-full grid-cols-6",children:[l.jsxs(rs,{value:"basic",className:"flex items-center gap-1",children:[l.jsx(eo,{className:"h-4 w-4"}),"Основная информация"]}),l.jsxs(rs,{value:"geo",className:"flex items-center gap-1",children:[l.jsx(Jn,{className:"h-4 w-4"}),"Гео и лендинги"]}),l.jsxs(rs,{value:"payouts",className:"flex items-center gap-1",children:[l.jsx(ao,{className:"h-4 w-4"}),"Выплаты"]}),l.jsxs(rs,{value:"traffic",className:"flex items-center gap-1",children:[l.jsx(Jn,{className:"h-4 w-4"}),"Трафик"]}),l.jsxs(rs,{value:"antifraud",className:"flex items-center gap-1",children:[l.jsx(Qi,{className:"h-4 w-4"}),"Антифрод"]}),l.jsxs(rs,{value:"additional",className:"flex items-center gap-1",children:[l.jsx(Er,{className:"h-4 w-4"}),"Дополнительно"]})]}),l.jsx(as,{value:"basic",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(eo,{className:"h-5 w-5"}),"Основная информация об оффере"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{htmlFor:"name",className:"text-sm font-medium",children:"Название оффера *"}),l.jsx(Ne,{id:"name",value:i.name,onChange:f=>r(b=>({...b,name:f.target.value})),placeholder:"Введите название оффера","data-testid":"input-offer-name"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Статус оффера"}),l.jsxs(Qn,{value:i.status,onValueChange:f=>r(b=>({...b,status:f})),children:[l.jsx(Zn,{"data-testid":"select-status",children:l.jsx(ei,{})}),l.jsxs(ti,{children:[l.jsx(Pe,{value:"draft",children:"Черновик"}),l.jsx(Pe,{value:"active",children:"Активный"}),l.jsx(Pe,{value:"paused",children:"Приостановлен"}),l.jsx(Pe,{value:"on_request",children:"На запрос"})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Описание (RU)"}),l.jsx(Vs,{value:i.description.ru,onChange:f=>r(b=>({...b,description:{...b.description,ru:f.target.value}})),placeholder:"Описание оффера на русском языке...",rows:4,"data-testid":"textarea-description-ru"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Описание (EN)"}),l.jsx(Vs,{value:i.description.en,onChange:f=>r(b=>({...b,description:{...b.description,en:f.target.value}})),placeholder:"Offer description in English...",rows:4,"data-testid":"textarea-description-en"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Категория"}),l.jsxs(no,{open:c,onOpenChange:d,children:[l.jsx(io,{asChild:!0,children:l.jsxs(se,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between","data-testid":"button-select-category",children:[i.category?Tl.find(f=>f===i.category):"Выберите категорию...",l.jsx(oo,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(ro,{className:"w-[400px] p-0",children:l.jsxs($r,{children:[l.jsx(Br,{placeholder:"Поиск категории..."}),l.jsx(zr,{children:"Категория не найдена."}),l.jsx(Hr,{className:"max-h-64 overflow-auto",children:Tl.map(f=>l.jsxs(qr,{value:f,onSelect:()=>{r(b=>({...b,category:f})),d(!1)},"data-testid":`command-item-category-${f}`,children:[l.jsx(to,{className:`mr-2 h-4 w-4 ${i.category===f?"opacity-100":"opacity-0"}`}),f]},f))})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Логотип оффера"}),l.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6",children:[l.jsxs(kl,{maxNumberOfFiles:1,maxFileSize:5242880,onGetUploadParameters:async()=>{const f=localStorage.getItem("auth_token"),b=await fetch("/api/objects/upload",{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(!b.ok)throw new Error(`Не удалось получить URL: ${b.status}`);return{method:"PUT",url:(await b.json()).uploadURL}},onComplete:f=>{if(console.log("Logo upload result:",f),f.successful&&f.successful[0]){const b=f.successful[0].uploadURL;if(console.log("Logo upload URL:",b),b)try{const A=new URL(b).pathname;console.log("Parsed path:",A);const k=A.split("/"),P=k.findIndex(D=>D==="uploads");if(P!==-1&&k[P+1]){const U=`/objects/uploads/${k[P+1]}`;console.log("Final logo URL:",U),r(H=>({...H,logo:U})),n({title:"Успех",description:"Логотип успешно загружен"})}else console.error("Could not find uploads folder in path:",k),n({title:"Ошибка",description:"Не удалось извлечь ID логотипа из URL",variant:"destructive"})}catch(S){console.error("Error parsing logo upload URL:",S),n({title:"Ошибка",description:"Не удалось обработать URL логотипа",variant:"destructive"})}}},buttonClassName:"w-full",children:[l.jsx(zu,{className:"h-4 w-4 mr-2"}),"Загрузить логотип"]}),i.logo&&l.jsxs("div",{className:"mt-4 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[l.jsx(Zi,{className:"h-4 w-4"}),"Предварительный просмотр:"]}),l.jsx("img",{src:i.logo,alt:"Логотип оффера",className:"w-20 h-20 object-cover rounded-lg border border-border"}),l.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:()=>r(f=>({...f,logo:""})),"data-testid":"button-remove-logo",children:[l.jsx(nn,{className:"h-4 w-4 mr-1"}),"Удалить логотип"]})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Основное изображение оффера"}),l.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6",children:[l.jsxs(kl,{maxNumberOfFiles:1,maxFileSize:10485760,onGetUploadParameters:async()=>{const f=localStorage.getItem("auth_token"),b=await fetch("/api/objects/upload",{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(!b.ok)throw new Error(`Не удалось получить URL: ${b.status}`);return{method:"PUT",url:(await b.json()).uploadURL}},onComplete:f=>{if(console.log("Image upload result:",f),f.successful&&f.successful[0]){const b=f.successful[0].uploadURL;if(console.log("Image upload URL:",b),b)try{const A=new URL(b).pathname;console.log("Parsed path:",A);const k=A.split("/"),P=k.findIndex(D=>D==="uploads");if(P!==-1&&k[P+1]){const U=`/objects/uploads/${k[P+1]}`;console.log("Final image URL:",U),r(H=>({...H,image:U})),n({title:"Успех",description:"Изображение успешно загружено"})}else console.error("Could not find uploads folder in path:",k),n({title:"Ошибка",description:"Не удалось извлечь ID изображения из URL",variant:"destructive"})}catch(S){console.error("Error parsing image upload URL:",S),n({title:"Ошибка",description:"Не удалось обработать URL изображения",variant:"destructive"})}}},buttonClassName:"w-full",children:[l.jsx(Zi,{className:"h-4 w-4 mr-2"}),"Загрузить изображение"]}),i.image&&l.jsxs("div",{className:"mt-4 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[l.jsx(Zi,{className:"h-4 w-4"}),"Предварительный просмотр:"]}),l.jsx("img",{src:i.image,alt:"Изображение оффера",className:"w-32 h-20 object-cover rounded-lg border border-border"}),l.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:()=>r(f=>({...f,image:""})),"data-testid":"button-remove-image",children:[l.jsx(nn,{className:"h-4 w-4 mr-1"}),"Удалить изображение"]})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"KPI и цели"}),l.jsx(Vs,{value:i.kpi,onChange:f=>r(b=>({...b,kpi:f.target.value})),placeholder:"Опишите ключевые показатели эффективности и цели оффера...",rows:3,"data-testid":"textarea-kpi"})]})]})]})}),l.jsx(as,{value:"geo",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(Jn,{className:"h-5 w-5"}),"Гео-таргетинг и лендинги"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx(V,{className:"text-sm font-medium",children:"Доступные страны *"}),l.jsxs(no,{open:a,onOpenChange:o,children:[l.jsx(io,{asChild:!0,children:l.jsxs(se,{variant:"outline",role:"combobox","aria-expanded":a,className:"w-full justify-between","data-testid":"button-select-geo",children:[i.geoTargeting.length>0?`Выбрано стран: ${i.geoTargeting.length}`:"Выберите страны...",l.jsx(oo,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(ro,{className:"w-[400px] p-0",children:l.jsxs($r,{children:[l.jsx(Br,{placeholder:"Поиск страны..."}),l.jsx(zr,{children:"Страна не найдена."}),l.jsx(Hr,{className:"max-h-64 overflow-auto",children:Al.map(f=>l.jsxs(qr,{value:f.code,onSelect:()=>C(f.code),"data-testid":`command-item-country-${f.code}`,children:[l.jsx(to,{className:`mr-2 h-4 w-4 ${i.geoTargeting.includes(f.code)?"opacity-100":"opacity-0"}`}),f.name]},f.code))})]})})]}),i.geoTargeting.length>0&&l.jsx("div",{className:"flex flex-wrap gap-2 p-2 border rounded-md bg-muted/50",children:i.geoTargeting.map(f=>{const b=Al.find(S=>S.code===f);return b?l.jsxs(sn,{variant:"secondary",className:"flex items-center gap-1",children:[b.name,l.jsx(gi,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>C(f)})]},f):null})})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(V,{className:"text-sm font-medium",children:"Лендинг страницы"}),l.jsxs(se,{type:"button",variant:"outline",size:"sm",onClick:u,"data-testid":"button-add-landing",children:[l.jsx(Er,{className:"h-4 w-4 mr-1"}),"Добавить лендинг"]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 border rounded-lg bg-muted/50",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Qe,{checked:i.hasGlobalGeoSetting,onCheckedChange:f=>r(b=>({...b,hasGlobalGeoSetting:f})),"data-testid":"switch-global-geo"}),l.jsx(V,{className:"text-sm",children:"Глобальное гео"})]}),i.hasGlobalGeoSetting&&l.jsx(Ne,{value:i.globalGeo,onChange:f=>r(b=>({...b,globalGeo:f.target.value})),placeholder:"Все страны","data-testid":"input-global-geo"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Qe,{checked:i.hasGlobalPayoutSetting,onCheckedChange:f=>r(b=>({...b,hasGlobalPayoutSetting:f})),"data-testid":"switch-global-payout"}),l.jsx(V,{className:"text-sm",children:"Глобальная выплата"})]}),i.hasGlobalPayoutSetting&&l.jsx(Ne,{type:"number",step:"0.01",value:i.globalPayout,onChange:f=>r(b=>({...b,globalPayout:f.target.value})),placeholder:"0.00","data-testid":"input-global-payout"})]})]}),l.jsx("div",{className:"space-y-3",children:i.landingPages.map(f=>l.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ne,{value:f.name,onChange:b=>v(f.id,"name",b.target.value),className:"w-40",placeholder:"Название лендинга","data-testid":`input-landing-name-${f.id}`}),f.isDefault&&l.jsx(sn,{variant:"default",children:"По умолчанию"})]}),!f.isDefault&&l.jsx(se,{type:"button",variant:"ghost",size:"sm",onClick:()=>h(f.id),"data-testid":`button-remove-landing-${f.id}`,children:l.jsx(nn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm",children:"URL лендинга *"}),l.jsx(Ne,{value:f.url,onChange:b=>v(f.id,"url",b.target.value),placeholder:"https://example.com/landing","data-testid":`input-landing-url-${f.id}`})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[(!i.hasGlobalGeoSetting||f.hasCustomGeo)&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Qe,{checked:f.hasCustomGeo,onCheckedChange:b=>v(f.id,"hasCustomGeo",b),"data-testid":`switch-custom-geo-${f.id}`}),l.jsx(V,{className:"text-sm",children:"Кастомное гео"})]}),f.hasCustomGeo&&l.jsx(Ne,{value:f.geo||"",onChange:b=>v(f.id,"geo",b.target.value),placeholder:"US, CA, GB","data-testid":`input-landing-geo-${f.id}`})]}),(!i.hasGlobalPayoutSetting||f.hasCustomPayout)&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Qe,{checked:f.hasCustomPayout,onCheckedChange:b=>v(f.id,"hasCustomPayout",b),"data-testid":`switch-custom-payout-${f.id}`}),l.jsx(V,{className:"text-sm",children:"Кастомная выплата"})]}),f.hasCustomPayout&&l.jsx(Ne,{type:"number",step:"0.01",value:f.payout||"",onChange:b=>v(f.id,"payout",b.target.value),placeholder:"0.00","data-testid":`input-landing-payout-${f.id}`})]})]})]},f.id))})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Целевая ссылка *"}),l.jsx(Ne,{value:i.targetUrl,onChange:f=>r(b=>({...b,targetUrl:f.target.value})),placeholder:"https://example.com/offer","data-testid":"input-target-url"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Основная ссылка куда будет перенаправлен трафик"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Postback URL"}),l.jsx(Ne,{value:i.postbackUrl,onChange:f=>r(b=>({...b,postbackUrl:f.target.value})),placeholder:"https://example.com/postback","data-testid":"input-postback-url"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"URL для получения уведомлений о конверсиях"})]})]})]})]})}),l.jsx(as,{value:"payouts",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"Настройки выплат"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Модель выплат"}),l.jsxs(Qn,{value:i.payoutType,onValueChange:f=>r(b=>({...b,payoutType:f})),children:[l.jsx(Zn,{"data-testid":"select-payout-type",children:l.jsx(ei,{})}),l.jsxs(ti,{children:[l.jsx(Pe,{value:"cpa",children:"CPA - За действие"}),l.jsx(Pe,{value:"cpl",children:"CPL - За лид"}),l.jsx(Pe,{value:"cps",children:"CPS - За продажу"}),l.jsx(Pe,{value:"revshare",children:"RevShare - Доля от дохода"}),l.jsx(Pe,{value:"hybrid",children:"Hybrid - Гибридная"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Размер выплаты"}),l.jsx(Ne,{type:"number",step:"0.01",value:i.payoutAmount,onChange:f=>r(b=>({...b,payoutAmount:parseFloat(f.target.value)||0})),placeholder:"0.00","data-testid":"input-payout-amount"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Валюта"}),l.jsxs(Qn,{value:i.currency,onValueChange:f=>r(b=>({...b,currency:f})),children:[l.jsx(Zn,{"data-testid":"select-currency",children:l.jsx(ei,{})}),l.jsx(ti,{children:Cv.map(f=>l.jsxs(Pe,{value:f.code,children:[f.symbol," ",f.code," - ",f.name]},f.code))})]})]})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium",children:"Лимиты и ограничения"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Дневной лимит конверсий"}),l.jsx(Ne,{type:"number",value:i.dailyLimit,onChange:f=>r(b=>({...b,dailyLimit:parseInt(f.target.value)||0})),placeholder:"0 = без лимита","data-testid":"input-daily-limit"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Максимальное количество конверсий в день"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Месячный лимит конверсий"}),l.jsx(Ne,{type:"number",value:i.monthlyLimit,onChange:f=>r(b=>({...b,monthlyLimit:parseInt(f.target.value)||0})),placeholder:"0 = без лимита","data-testid":"input-monthly-limit"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Максимальное количество конверсий в месяц"})]})]})]}),l.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Информация о моделях выплат:"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-muted-foreground",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"CPA:"})," Фиксированная сумма за каждое целевое действие",l.jsx("br",{}),l.jsx("strong",{children:"CPL:"})," Оплата за каждый квалифицированный лид",l.jsx("br",{}),l.jsx("strong",{children:"CPS:"})," Процент или фиксированная сумма с каждой продажи"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"RevShare:"})," Процент от дохода рекламодателя",l.jsx("br",{}),l.jsx("strong",{children:"Hybrid:"})," Комбинация фиксированной суммы и процента"]})]})]})]})]})}),l.jsx(as,{value:"traffic",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(Jn,{className:"h-5 w-5"}),"Источники трафика и приложения"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx(V,{className:"text-sm font-medium",children:"Разрешенные источники трафика"}),l.jsx("div",{className:"grid grid-cols-4 gap-3 max-h-48 overflow-y-auto border rounded-lg p-3",children:yv.map(f=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-muted/50 p-2 rounded","data-testid":`checkbox-traffic-${f.replace(/\s+/g,"-").toLowerCase()}`,children:[l.jsx(Qe,{checked:i.trafficSources.includes(f),onCheckedChange:()=>y(f)}),l.jsx("span",{className:"text-xs",children:f})]},f))}),i.trafficSources.length>0&&l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Выбрано источников: ",i.trafficSources.length]})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(V,{className:"text-sm font-medium",children:"Разрешенные типы приложений"}),l.jsx("div",{className:"grid grid-cols-4 gap-3 max-h-48 overflow-y-auto border rounded-lg p-3",children:vv.map(f=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-muted/50 p-2 rounded","data-testid":`checkbox-app-${f.replace(/\s+/g,"-").toLowerCase()}`,children:[l.jsx(Qe,{checked:i.allowedApplications.includes(f),onCheckedChange:()=>x(f)}),l.jsx("span",{className:"text-xs",children:f})]},f))}),i.allowedApplications.length>0&&l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Выбрано приложений: ",i.allowedApplications.length]})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(V,{className:"text-sm font-medium text-destructive",children:"Запрещенные источники трафика"}),l.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4",children:[l.jsx("div",{className:"grid grid-cols-3 gap-2 text-sm text-destructive",children:bv.map(f=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(gi,{className:"h-3 w-3"}),f]},f))}),l.jsx("p",{className:"text-xs text-destructive mt-3",children:"Трафик из этих источников будет автоматически отклонен системой антифрод"})]})]}),l.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Поддерживаемые типы устройств:"}),l.jsx("div",{className:"grid grid-cols-5 gap-2 text-xs",children:wv.map(f=>l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-background rounded border",children:[l.jsx(_r,{className:"h-3 w-3 text-muted-foreground"}),f.label]},f.value))})]})]})]})}),l.jsx(as,{value:"antifraud",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-5 w-5"}),"Защита от мошенничества"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx(V,{className:"text-sm font-medium",children:"Активные методы защиты"}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:xv.map(f=>l.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg bg-muted/30",children:[l.jsx(Qe,{checked:i.antifraudMethods.includes(f.value),onCheckedChange:()=>_(f.value),"data-testid":`switch-antifraud-${f.value}`}),l.jsxs("div",{className:"space-y-1",children:[l.jsx(V,{className:"text-sm font-medium",children:f.label}),l.jsx("p",{className:"text-xs text-muted-foreground",children:f.description})]})]},f.value))}),i.antifraudMethods.length>0&&l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Активно методов защиты: ",i.antifraudMethods.length]})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(V,{className:"text-sm font-medium",children:"Тип модерации партнеров"}),l.jsxs(Qn,{value:i.partnerApprovalType,onValueChange:f=>r(b=>({...b,partnerApprovalType:f})),children:[l.jsx(Zn,{"data-testid":"select-partner-approval",children:l.jsx(ei,{})}),l.jsxs(ti,{children:[l.jsx(Pe,{value:"auto",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Pu,{className:"h-4 w-4 text-green-500"}),"Автоматическое подтверждение"]})}),l.jsx(Pe,{value:"manual",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Hu,{className:"h-4 w-4 text-yellow-500"}),"Ручная модерация"]})}),l.jsx(Pe,{value:"none",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Nu,{className:"h-4 w-4 text-red-500"}),"Без модерации"]})})]})]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Определяет как будут проверяться заявки партнеров на доступ к офферу"})]}),l.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-4",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Рекомендации по безопасности:"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-muted-foreground",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-3 w-3 text-green-500"}),l.jsx("strong",{children:"Активная защита"})]}),l.jsxs("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[l.jsx("li",{children:"Включить IP фильтрацию для географических ограничений"}),l.jsx("li",{children:"Использовать анализ поведения для выявления ботов"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(_r,{className:"h-3 w-3 text-blue-500"}),l.jsx("strong",{children:"Мониторинг"})]}),l.jsxs("ul",{className:"list-disc list-inside space-y-1 pl-4",children:[l.jsx("li",{children:"Отслеживать аномальный трафик и подозрительные паттерны"}),l.jsx("li",{children:"Настроить алерты при превышении лимитов конверсий"})]})]})]})]})]})]})}),l.jsx(as,{value:"additional",className:"mt-4",children:l.jsxs(es,{children:[l.jsx(ts,{children:l.jsxs(ss,{className:"flex items-center gap-2",children:[l.jsx(Qi,{className:"h-5 w-5"}),"Дополнительные настройки"]})}),l.jsxs(ns,{className:"space-y-6",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Qe,{checked:i.isPrivate,onCheckedChange:f=>r(b=>({...b,isPrivate:f})),"data-testid":"switch-private"}),l.jsxs("div",{className:"space-y-1",children:[l.jsx(V,{className:"text-sm font-medium",children:"Приватный оффер"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Оффер будет доступен только выбранным партнерам по приглашению"})]})]})}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(V,{className:"text-sm font-medium",children:"Теги для категоризации"}),l.jsx(Vs,{value:i.tags.join(", "),onChange:f=>{const b=f.target.value.split(",").map(S=>S.trim()).filter(S=>S);r(S=>({...S,tags:b}))},placeholder:"premium, exclusive, tier1, high-converting...",rows:2,"data-testid":"textarea-tags"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Добавьте теги для удобного поиска и фильтрации (разделяйте запятыми)"}),i.tags.length>0&&l.jsx("div",{className:"flex flex-wrap gap-1",children:i.tags.map((f,b)=>l.jsxs(sn,{variant:"secondary",className:"text-xs",children:[f,l.jsx(gi,{className:"h-3 w-3 ml-1 cursor-pointer hover:text-destructive",onClick:()=>{const S=i.tags.filter((A,k)=>k!==b);r(A=>({...A,tags:S}))}})]},b))})]}),l.jsx(Ct,{}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(V,{className:"text-sm font-medium",children:"Внутренние заметки"}),l.jsx(Vs,{value:i.notes,onChange:f=>r(b=>({...b,notes:f.target.value})),placeholder:"Дополнительные заметки для внутреннего использования...",rows:3,"data-testid":"textarea-notes"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Эти заметки видны только вам и вашей команде, партнеры их не увидят"})]}),l.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-4",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Дополнительные настройки:"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Qe,{checked:i.requiresApproval,onCheckedChange:f=>r(b=>({...b,requiresApproval:f})),"data-testid":"switch-requires-approval"}),l.jsxs("div",{children:[l.jsx(V,{className:"text-sm",children:"Требует одобрение"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Партнеры должны ждать одобрения"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Qe,{checked:i.trackingEnabled,onCheckedChange:f=>r(b=>({...b,trackingEnabled:f})),"data-testid":"switch-tracking"}),l.jsxs("div",{children:[l.jsx(V,{className:"text-sm",children:"Расширенное отслеживание"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Детальная аналитика конверсий"})]})]})]})]}),l.jsxs("div",{className:"border border-dashed rounded-lg p-4 space-y-3",children:[l.jsx("h4",{className:"font-medium text-sm",children:"Шаблоны:"}),l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Sr,{checked:i.saveAsTemplate,onCheckedChange:f=>r(b=>({...b,saveAsTemplate:f===!0})),"data-testid":"checkbox-save-template"}),l.jsx(V,{className:"text-sm",children:"Сохранить как шаблон для будущих офферов"})]})}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Создание шаблона поможет быстро создавать похожие офферы в будущем"})]})]})]})})]}),l.jsxs("div",{className:"flex justify-end pt-4 gap-2 mt-6 border-t",children:[l.jsx(se,{variant:"outline",onClick:e,"data-testid":"button-cancel",children:"Отмена"}),l.jsx(se,{onClick:N,"data-testid":"button-save",children:s.id?"Сохранить изменения":"Создать оффер"})]})]})})},Sv=({countries:s,geoTargeting:e,payout:t=0,currency:n="USD",payoutByGeo:i})=>{const[r,a]=g.useState(!1),o=ju(s||e||[]),c=o.slice(0,2),d=o[2],u=o.length-3,h=()=>o.map(v=>{const x={AF:"afghanistan",AL:"albania",DZ:"algeria",AD:"andorra",AO:"angola",AM:"armenia",AR:"argentina",AU:"australia",AT:"austria",AZ:"azerbaijan",BH:"bahrain",BD:"bangladesh",BY:"belarus",BE:"belgium",BR:"brazil",BG:"bulgaria",CA:"canada",CN:"china",CO:"colombia",HR:"croatia",CZ:"czech",DK:"denmark",EG:"egypt",EE:"estonia",FI:"finland",FR:"france",DE:"germany",GR:"greece",HU:"hungary",IS:"iceland",IN:"india",ID:"indonesia",IR:"iran",IQ:"iraq",IE:"ireland",IL:"israel",IT:"italy",JP:"japan",JO:"jordan",KZ:"kazakhstan",KE:"kenya",KW:"kuwait",LV:"latvia",LB:"lebanon",LT:"lithuania",LU:"luxembourg",MY:"malaysia",MX:"mexico",MD:"moldova",MC:"monaco",MA:"morocco",NL:"netherlands",NZ:"new_zealand",NO:"norway",PK:"pakistan",PE:"peru",PH:"philippines",PL:"poland",PT:"portugal",QA:"qatar",RO:"romania",RU:"russia",SA:"saudi_arabia",RS:"serbia",SG:"singapore",SK:"slovakia",SI:"slovenia",ZA:"south_africa",KR:"south_korea",ES:"spain",LK:"sri_lanka",SE:"sweden",CH:"switzerland",TH:"thailand",TR:"turkey",UA:"ukraine",AE:"united_arab_emirates",GB:"united_kingdom",US:"united_states",VN:"vietnam"}[v.code]||v.code.toLowerCase(),C=i?.[x]||i?.[v.code.toLowerCase()]||i?.[v.code.toUpperCase()]||i?.[v.name.toLowerCase()]||t;return{...v,payout:C,currency:n}});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-1 flex-wrap max-w-32",children:[c.map((v,y)=>l.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded-md border border-blue-200 dark:border-blue-800",children:[l.jsx("span",{className:"text-sm",title:v.name,children:v.flag}),l.jsx("span",{className:"text-xs font-mono font-semibold text-blue-700 dark:text-blue-300",children:v.code})]},`country-${y}`)),d&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded-md border border-blue-200 dark:border-blue-800",children:[l.jsx("span",{className:"text-sm",title:d.name,children:d.flag}),l.jsx("span",{className:"text-xs font-mono font-semibold text-blue-700 dark:text-blue-300",children:d.code})]}),u>0&&l.jsxs(se,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>a(!0),title:`Показать все ${o.length} стран`,children:["+",u]})]}),o.length===3&&!u&&l.jsx(se,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:()=>a(!0),title:"Показать детали по странам",children:"⚡"})]}),l.jsx(zl,{open:r,onOpenChange:a,children:l.jsxs(Hl,{className:"max-w-md",children:[l.jsxs(ql,{children:[l.jsxs(Vl,{className:"flex items-center justify-between",children:[l.jsxs("span",{children:["Гео-таргетинг (",o.length," стран)"]}),l.jsx(se,{variant:"ghost",size:"sm",onClick:()=>a(!1),className:"h-6 w-6 p-0",children:l.jsx(gi,{className:"h-4 w-4"})})]}),l.jsx(Uu,{children:"Подробная информация по странам и выплатам для данного оффера"})]}),l.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:h().map((v,y)=>l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-lg",children:v.flag}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-sm",children:v.name}),l.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:v.code})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-semibold text-green-600 dark:text-green-400",children:["$",v.payout]}),l.jsx("div",{className:"text-xs text-muted-foreground",children:v.currency})]})]},`modal-country-${y}`))}),l.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex justify-between items-center text-sm font-medium",children:[l.jsx("span",{children:"Общая сумма:"}),l.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["$",Number(h().reduce((v,y)=>v+(Number(y.payout)||0),0)).toFixed(2)," ",n]})]})})]})})]})},Ev=({offer:s})=>{const[e,t]=g.useState(!1),[n,i]=g.useState(!1);return s.image&&!e?l.jsx("img",{src:s.image,alt:s.name,className:"w-10 h-10 rounded-lg object-cover border border-gray-200 dark:border-gray-700",onLoad:()=>console.log("Offer image loaded successfully:",s.image),onError:()=>{console.log("Offer image failed to load, trying logo:",s.image),t(!0)}}):s.logo&&!n?l.jsx("img",{src:s.logo,alt:s.name,className:"w-10 h-10 rounded-lg object-cover border border-gray-200 dark:border-gray-700",onLoad:()=>console.log("Logo loaded successfully:",s.logo),onError:()=>{console.log("Logo failed to load:",s.logo),i(!0)}}):l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white text-xs font-bold",children:s.name?.substring(0,2).toUpperCase()||"OF"})};function Fv({offer:s,index:e,children:t}){const{attributes:n,listeners:i,setNodeRef:r,transform:a,transition:o,isDragging:c}=Bp({id:s.id}),d={transform:hn.Transform.toString(a),transition:o,opacity:c?.5:1};return l.jsxs(Bl,{ref:r,style:d,...n,className:c?"bg-muted/50":"",children:[l.jsx(dt,{...i,className:"cursor-grab active:cursor-grabbing hover:bg-muted/50 p-2",title:"Перетащите для изменения порядка",children:l.jsx(Wl,{className:"w-4 h-4 text-muted-foreground hover:text-foreground"})}),t]})}const nb=()=>{const{toast:s}=$l(),e=ku(),[,t]=Tu(),[n,i]=g.useState(null),[r,a]=g.useState(null),[o,c]=g.useState(!1),[d,u]=g.useState(null),[h,v]=g.useState(""),[y,x]=g.useState("all"),[_,C]=g.useState([]),[N,f]=g.useState([]),{data:b=[],isLoading:S}=Fu({queryKey:["/api/advertiser/offers"],queryFn:()=>is("/api/advertiser/offers")});be.useEffect(()=>{if(b&&b.length>0){const E=[...b].sort((q,W)=>new Date(W.createdAt||0).getTime()-new Date(q.createdAt||0).getTime());f(E)}},[b]);const A=si({mutationFn:E=>(E.status||(E.status="active"),E.id?is(`/api/advertiser/offers/${E.id}`,"PATCH",E):is("/api/advertiser/offers","POST",E)),onSuccess:()=>{s({title:"Успех",description:"Оффер сохранён"}),e.invalidateQueries({queryKey:["/api/advertiser/offers"]})},onError:()=>{s({title:"Ошибка",description:"Ошибка при сохранении",variant:"destructive"})}}),k=si({mutationFn:E=>is(`/api/advertiser/offers/${E}`,"DELETE"),onSuccess:()=>{s({title:"Успех",description:"Оффер удалён"}),e.invalidateQueries({queryKey:["/api/advertiser/offers"]}),a(null),C([])},onError:()=>{s({title:"Ошибка",description:"Ошибка при удалении",variant:"destructive"})}}),P=si({mutationFn:async E=>{const q=E.map(W=>is(`/api/advertiser/offers/${W}`,"DELETE"));return Promise.all(q)},onSuccess:()=>{s({title:"Успех",description:`Удалено ${_.length} офферов`}),e.invalidateQueries({queryKey:["/api/advertiser/offers"]}),C([]),c(!1)},onError:()=>{s({title:"Ошибка",description:"Ошибка при массовом удалении",variant:"destructive"})}}),D=si({mutationFn:({ids:E,status:q})=>is("/api/advertiser/offers/bulk-update","POST",{ids:E,status:q}),onSuccess:()=>{s({title:"Успех",description:"Статус обновлён"}),e.invalidateQueries({queryKey:["/api/advertiser/offers"]}),C([])}}),U=N.filter(E=>E.name.toLowerCase().includes(h.toLowerCase())).filter(E=>y==="archived"?E.status==="archived":y==="all"?!0:E.status===y),H=E=>{const{active:q,over:W}=E;if(!W||q.id===W.id)return;const te=N.findIndex(he=>he.id===q.id),Z=N.findIndex(he=>he.id===W.id);if(te!==-1&&Z!==-1){const he=ka(N,te,Z);f(he),console.log("Reordered offers:",he.map(oe=>({id:oe.id,name:oe.name}))),s({title:"Порядок изменён",description:"Оффер перемещён"})}},I=E=>{D.mutate({ids:_,status:E})},X=(E,q)=>{switch(q){case"activate":A.mutate({...E,status:"active"});break;case"archive":A.mutate({...E,status:"archived"});break;case"duplicate":const W={...E,id:void 0,createdAt:void 0,updatedAt:void 0,name:E.name+" (копия)"};A.mutate(W);break;case"delete":a(E);break;case"preview":E?.landingPages?.[0]?.url?window.open(E.landingPages[0].url,"_blank"):s({title:"Предупреждение",description:"Нет доступной ссылки для предпросмотра",variant:"destructive"});break;case"assign":t(`/advertiser/offers/${E.id}/assign`);break;case"edit-landing":t(`/advertiser/offers/${E.id}/landing-editor`);break}};return S?l.jsx("div",{className:"w-full",children:l.jsxs("div",{className:"animate-pulse space-y-6",children:[l.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),l.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):l.jsxs("div",{className:"w-full space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Мои офферы"}),l.jsx("p",{className:"text-muted-foreground",children:"Управление офферами и отслеживание статистики"})]}),l.jsxs(se,{onClick:()=>t("/advertiser/offers/new"),className:"bg-blue-600 hover:bg-blue-700 text-white",title:"Создать новый оффер",children:[l.jsx(Er,{className:"h-4 w-4 mr-2 text-white"}),"Создать оффер"]})]}),l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsx(Ne,{placeholder:"Поиск по названию...",value:h,onChange:E=>v(E.target.value),className:"w-64"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(se,{onClick:()=>x("all"),variant:y==="all"?"default":"outline",children:"Все"}),l.jsx(se,{onClick:()=>x("active"),variant:y==="active"?"default":"outline",children:"Активные"}),l.jsx(se,{onClick:()=>x("paused"),variant:y==="paused"?"default":"outline",children:"Приостановленные"}),l.jsx(se,{onClick:()=>x("archived"),variant:y==="archived"?"default":"outline",children:"Архив"})]})]}),_.length>0&&l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(se,{onClick:()=>I("active"),size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",title:"Активировать выбранные офферы",children:[l.jsx(qu,{className:"w-4 h-4 mr-1 text-white"})," Активировать"]}),l.jsxs(se,{onClick:()=>I("archived"),size:"sm",className:"bg-gray-600 hover:bg-gray-700 text-white",title:"Архивировать выбранные офферы",children:[l.jsx(Wu,{className:"w-4 h-4 mr-1 text-white"})," Архивировать"]}),l.jsxs(se,{onClick:()=>I("paused"),size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",title:"Приостановить выбранные офферы",children:[l.jsx(Gu,{className:"w-4 h-4 mr-1 text-white"})," Приостановить"]}),l.jsxs(se,{onClick:()=>c(!0),size:"sm",variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-white",title:`Удалить выбранные офферы (${_.length})`,children:[l.jsx(nn,{className:"w-4 h-4 mr-1 text-white"})," Удалить (",_.length,")"]})]}),l.jsx(xp,{onDragEnd:H,children:l.jsxs(Au,{children:[l.jsx(Ru,{children:l.jsxs(Bl,{children:[l.jsx(ct,{className:"w-8",title:"Перетащите для изменения порядка",children:l.jsx(Wl,{className:"w-4 h-4 text-muted-foreground"})}),l.jsx(ct,{children:l.jsx(Sr,{checked:_.length===U.length&&U.length>0,onCheckedChange:E=>{C(E?U.map(q=>q.id):[])}})}),l.jsx(ct,{children:"Название"}),l.jsx(ct,{children:"GEO"}),l.jsx(ct,{children:"Категория"}),l.jsx(ct,{children:"CR"}),l.jsx(ct,{children:"Payout"}),l.jsx(ct,{children:"Статус"}),l.jsx(ct,{children:"Действия"})]})}),l.jsx(Du,{children:l.jsx(jp,{items:U.map(E=>E.id),strategy:Rp,children:U.map((E,q)=>l.jsx(Fv,{offer:E,index:q,children:l.jsxs(l.Fragment,{children:[l.jsx(dt,{children:l.jsx(Sr,{checked:_.includes(E.id),onCheckedChange:W=>{C(W?te=>[...te,E.id]:te=>te.filter(Z=>Z!==E.id))}})}),l.jsx(dt,{className:"font-medium",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ev,{offer:E}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:E.name}),E.description&&l.jsx("div",{className:"text-sm text-gray-500 truncate max-w-48",children:typeof E.description=="object"?E.description?.en||E.description?.ru||"Описание":E.description})]})]})}),l.jsx(dt,{children:l.jsx(Sv,{countries:E.countries,geoTargeting:E.geoTargeting,payout:E.payout,currency:E.currency,offerId:E.id,payoutByGeo:E.payoutByGeo})}),l.jsx(dt,{children:l.jsx(sn,{...Ou(E.category),children:typeof E.category=="object"?E.category?.en||E.category?.ru||"Категория":E.category})}),l.jsxs(dt,{children:[Hp(E.cr),"%"]}),l.jsxs(dt,{children:["$",E.payout," ",E.currency]}),l.jsx(dt,{children:l.jsx(sn,{variant:E.status==="active"?"default":E.status==="paused"?"secondary":E.status==="archived"?"destructive":E.status==="draft"?"outline":"default",className:E.status==="active"?"bg-green-500 hover:bg-green-600 text-white":E.status==="paused"?"bg-yellow-500 hover:bg-yellow-600 text-white":E.status==="archived"?"bg-red-500 hover:bg-red-600 text-white":E.status==="draft"?"bg-gray-500 hover:bg-gray-600 text-white border-gray-600":"bg-blue-500 hover:bg-blue-600 text-white",children:E.status==="active"?"Активный":E.status==="paused"?"Приостановлен":E.status==="archived"?"Архив":E.status==="draft"?"Черновик":E.status})}),l.jsx(dt,{children:l.jsxs("div",{className:"flex gap-1",children:[l.jsx(se,{size:"sm",variant:"ghost",onClick:()=>i(E),title:"Редактировать оффер",className:"hover:bg-blue-100 hover:text-blue-600 dark:hover:bg-blue-900/20 dark:hover:text-blue-400",children:l.jsx(Vu,{className:"w-4 h-4 text-blue-500"})}),l.jsx(se,{size:"sm",variant:"ghost",onClick:()=>X(E,"preview"),title:"Предпросмотр оффера",className:"hover:bg-purple-100 hover:text-purple-600 dark:hover:bg-purple-900/20 dark:hover:text-purple-400",children:l.jsx(_r,{className:"w-4 h-4 text-purple-500"})}),l.jsx(se,{size:"sm",variant:"ghost",onClick:()=>a(E),title:"Удалить оффер",className:"hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-900/20 dark:hover:text-red-400",children:l.jsx(nn,{className:"w-4 h-4 text-red-500"})})]})})]})},E.id))})})]})}),n&&l.jsx(_v,{offer:n,onClose:()=>i(null),onSave:E=>{A.mutate(E),i(null)}}),l.jsx(lo,{open:!!r,onOpenChange:()=>a(null),children:l.jsxs(Fr,{children:[l.jsxs(Pr,{children:[l.jsx(kr,{children:"Подтвердите удаление"}),l.jsxs(Tr,{children:['Вы уверены, что хотите удалить оффер "',r?.name,'"?',l.jsx("br",{}),l.jsx("span",{className:"text-red-600 font-medium",children:"Это действие необратимо."})]})]}),l.jsxs(Nr,{children:[l.jsx(Rr,{children:"Отмена"}),l.jsx(Ar,{onClick:()=>r&&k.mutate(r.id),className:"bg-red-600 hover:bg-red-700",disabled:k.isPending,children:k.isPending?"Удаление...":"Удалить"})]})]})}),l.jsx(lo,{open:o,onOpenChange:()=>c(!1),children:l.jsxs(Fr,{children:[l.jsxs(Pr,{children:[l.jsx(kr,{children:"Подтвердите массовое удаление"}),l.jsxs(Tr,{children:["Вы уверены, что хотите удалить ",_.length," выбранных офферов?",l.jsx("br",{}),l.jsx("span",{className:"text-red-600 font-medium",children:"Это действие необратимо."})]})]}),l.jsxs(Nr,{children:[l.jsx(Rr,{children:"Отмена"}),l.jsx(Ar,{onClick:()=>P.mutate(_),className:"bg-red-600 hover:bg-red-700",disabled:P.isPending,children:P.isPending?"Удаление...":`Удалить ${_.length} офферов`})]})]})})]})};export{nb as default};
